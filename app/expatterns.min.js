!function(){"use strict";var e=function(){};e.prototype=function(){var e={},t={},n={},o={},r={},l={},a={},i={},s={},u={},c={},f={},d={},h={},p={},g={},E={},y={},O={},v={};return e={defaults:{resources:{USE_STORAGED:{type:"boolean",value:!1},WAIT_ASYNCHRONOUS:{type:"boolean",value:!0},MODULES:{type:"array",value:[]},EXTERNAL:{type:"array",value:[]},ASYNCHRONOUS:{type:"array",value:[]}},paths:{CORE:{type:"string",value:function(){function e(e){return e=E.url.parse(e.toLowerCase()),n.files.CORE=e.target,n.files.CORE_URL=e.url,e=e.path}var t=E.resources.js.getCurrentSRC(!0),o=null;if(null!==t)return e(t);if(o=document.querySelector('script[src*="'+n.files.CORE+'"]'),null!==o)return e(o.src);throw new Error("Cannot detect URL and PATH to core script (default name: flex.core.js)")}},ATTACH:{type:"string",value:"/app"}},events:{onFlexLoad:{type:"function",value:null},onPageLoad:{type:"function",value:null}},settings:{CHECK_PATHS_IN_CSS:{type:"boolean",value:!1},ATTACH_PATH_SIGNATURE:{type:"string",value:"ATTACH::"},KERNEL_PATH_SIGNATURE:{type:"string",value:"KERNEL::"}},patterns:{TEST_FUNCTION:"flexPatternTest"},cache:{reset:{ON_NEW_MODULE:{type:"boolean",value:!0},ON_UPDATED_MODULE:{type:"boolean",value:!1},ON_NEW_RESOURCE:{type:"boolean",value:!1},ON_UPDATED_RESOURCE:{type:"boolean",value:!1},ON_CRITICAL_ERROR:{type:"boolean",value:!0}}},logs:{SHOW:{type:"array",value:["CRITICAL","LOGICAL","WARNING"]}}},init:function(t){function o(e,t,n){function r(e){return e instanceof Array?"array":typeof e}var n=n||"",a=null;if("object"==typeof e.content)if(void 0!==e.content.type&&void 0!==e.content.value)a=l.namespace.get(n,t),r(a)===e.content.type?e.parent[e.name]=a:e.parent[e.name]="function"==typeof e.content.value?e.content.value():e.content.value;else for(var i in e.content)o({content:e.content[i],parent:e.content,name:i},t,n+(""===n?"":".")+i)}var r=p.globaly.get(n.storage.GROUP,n.storage.DEFAULT_CONFIG),a=p.globaly.get(n.storage.GROUP,n.storage.DEFAULT_CONFIG_FLAG);null===a?(null===r?p.globaly.set(n.storage.GROUP,n.storage.DEFAULT_CONFIG,l.objects.copy(e.defaults)):e.defaults=l.objects.copy(r),t&&(a=p.globaly.set(n.storage.GROUP,n.storage.DEFAULT_CONFIG_FLAG,!0)),o({content:e.defaults,parent:null,name:null},t||{}),void 0!==t&&(i.modification(),c.init(),f.preload(),h.preload())):v.log("[CORE]:: flex was initialized before. Initialization can be done only once per session.",v.types.WARNING)},get:function(){return e.defaults},set:function(t){for(var n in t)void 0!==e.defaults[n]&&typeof e.defaults[n]==typeof t[n]&&(e.defaults[n]=t[n])}},t={onFlexLoad:function(){var o=p.globaly.get(n.storage.GROUP,n.storage.DEFAULT_CONFIG_FLAG),l=!1;null!==o?f.isReady()&&d.isReady()&&h.isReady()&&f.attach.unexpected.isReady()&&(l=!0):f.isReady()&&f.attach.unexpected.isReady()&&(l=!0),l?void 0===t.onFlexLoad.__inited?(i.execution()||(t.onFlexLoad.__inited=!0,E.handle(e.defaults.events.onFlexLoad,null,"config.defaults.events.onFlexLoad",this),null!==e.defaults.events.onPageLoad&&("complete"!==document.readyState?r.DOM.add(window,"load",e.defaults.events.onPageLoad):E.handle(e.defaults.events.onPageLoad,null,"config.defaults.events.onPageLoad",this))),f.attach.unexpected.launched.accept(),u.update.queue.unlock()):v.log("Double start of [onFlexLoad]",v.types.CRITICAL):f.attach.unexpected.isReady()}},n={storage:{GROUP:"flex.core",RESOURCES_JOURNAL:"flex.modules.resources.journal",UNEXPECTED_JOURNAL:"flex.modules.unexpected.journal",DEFAULT_CONFIG:"flex.defualt.config",DEFAULT_CONFIG_FLAG:"flex.defualt.config.flag",WAITING_REGISTER_TASKS:"flex.register.wait.tasts"},resources:{types:{CSS:".css",JS:".js"}},regs:{urls:{PARAMS:/\?.*/gi,EXTENSION:/(\.[\w\n]*)$/gi,JS_URL:/[\w]*:\/\/[\w\n:\/\.]*\.js/gi,NOT_URL_SYMBOLS:/[\s\t\n\r]/gi,JS_EXP_IN_URL:/\.js$/gi,CSS_EXP_IN_URL:/\.css$/gi}},register:{EXTERNAL_HISTROY:"flex.external.history",MODULES_HISTROY:"flex.modules.history",MODULES_HISTROY_CREATION:"flex.modules.history.created",RESOURCES_HISTORY:"flex.modules.resources.history",ASYNCHRONOUS_HISTORY:"asynchronous.history"},hashes:{LOCAL_STORAGE_NAME:"flex.hash.storage"},cache:{STORAGE:"flex.cache.storage.reset_data",URL_PARAM_VERSION:"flexhash"},files:{CORE:"",CORE_URL:"",ROOT:"",FLEX:"",detect:function(){function e(e){return e=E.url.parse(e.toLowerCase()),n.files.CORE=e.target,n.files.CORE_URL=e.url,n.files.ROOT=e.home+"/"+e.dirs.filter(function(e,t,n){return t!==n.length-1}).join("/"),n.files.FLEX=e.path,0===e.dirs.length&&setTimeout(function(){v.log("Flex core file ["+e.target+"] attached in root ["+e.home+']. Recommendation: attach flex\'s libraries (include core) in some subfolder (for example, "core", "flex", "kernel" or any other).',v.types.NOTIFICATION)},10),e.path}var t=E.resources.js.getCurrentSRC(!0),o=null;if(null!==t)return e(t);if(""!==n.files.CORE&&(o=document.querySelector('script[src*="'+n.files.CORE+'"]'),null!==o))return e(o.src);throw new Error("Cannot detect URL and PATH to core script. Setup name of manually [options.files.CORE]")}},other:{STORAGE_PREFIX:"[FLEX_SYSTEM_RESURCES]"}},o={settings:{DEFAULT_TIMEOUT:15e3,DEFAULT_METHOD:"POST",methods:{POST:"POST",GET:"GET",PUT:"PUT",DELETE:"DELETE",OPTIONS:"OPTIONS"},regs:{URLENCODED:/-urlencoded/gi,JSON:/application\/json/gi},headers:{CONTENT_TYPE:"Content-Type",ACCEPT:"Accept"}},requests:{storage:{},add:function(e){var t=o.requests.storage;return void 0===t[e.settings.id]&&(t[e.settings.id]=e,!0)},remove:function(e){var t=o.requests.storage;return void 0!==t[e.settings.id]&&(t[e.settings.id]=null,delete t[e.settings.id],!0)},isConflict:function(e){return void 0!==o.requests.storage[e]}},create:function(e,t,n,l,a){var i=null;return e="string"==typeof e?e:null,t="string"==typeof t&&[o.settings.methods.POST,o.settings.methods.GET,o.settings.methods.PUT,o.settings.methods.DELETE,o.settings.methods.OPTIONS].indexOf(t.toUpperCase())!==-1?t.toUpperCase():o.settings.DEFAULT_METHOD,a=o.parse.settings(a),n=o.parse.parameters(n,a),l=o.parse.callbacks(l),null!==e?(i=function(e,t,n,o,r){this.settings=r,this.url=e,this.method=t,this.parameters=n,this.callbacks=o,this.timerID=null,this.response=null,this.responseHeaders=null,this.httpRequest=null},i.prototype={send:function(){var e=this;try{o.requests.add(e),e.httpRequest=new XMLHttpRequest;for(var t in e.events)!function(e,t){r.DOM.add(t.httpRequest,e,function(n){return t.events[e](n,t)})}(t,e);if(null!==e.httpRequest){switch(e.callback(e.callbacks.before),e.method){case o.settings.methods.POST:e.httpRequest.open(e.method,e.url,!0),e.setHeaders(e),e.httpRequest.send(e.parameters._parameters);break;case o.settings.methods.GET:e.httpRequest.open(e.method,e.url+(""!==e.parameters._parameters?"?":"")+e.parameters._parameters,!0),e.setHeaders(e),e.httpRequest.send();break;default:e.httpRequest.open(e.method,e.url,!0),e.setHeaders(e),e.httpRequest.send(e.parameters._parameters)}return e.timerID=setTimeout(function(){e.events.timeout(null,e)},e.settings.timeout),!0}throw"Fail create XMLHttpRequest"}catch(t){e.callback(e.callbacks.fail,t),e.destroy(e)}},setHeaders:function(e){if(null!==e.settings.headers)for(var t in e.settings.headers)e.httpRequest.setRequestHeader(t,e.settings.headers[t])},events:{readystatechange:function(e,t){if(o.requests.isConflict(t.settings.id)!==!1&&e.target&&e.target.readyState)switch(t.callback(t.callbacks.reaction,e),e.target.readyState){case 2:t.responseHeaders=t.parseHeaders(e.target.getAllResponseHeaders()),t.callback(t.callbacks.headers,e);break;case 4:return 200===e.target.status?(t.response=t.parse(e.target.responseText),t.destroy(t),t.callback(t.callbacks.success,e),!0):(t.destroy(t),t.callback(t.callbacks.fail,e),!1)}},timeout:function(e,t){o.requests.isConflict(t.settings.id)!==!1&&(t.callback(t.callbacks.timeout,e),t.destroy(t))}},parse:function(e){var t={original:e,parsed:null};try{t.parsed=JSON.parse(e)}catch(e){}finally{return t}},parseHeaders:function(e){var t={_headers:e,headers:{}},n=null;return"string"==typeof e&&(n=e.split("\r\n"),n instanceof Array&&n.forEach(function(e){var n=e.split(":");n instanceof Array&&""!==n[0]&&(t.headers[n[0]]=e.replace(n[0]+":",""))})),t},callback:function(e,t){null!==e&&E.handle(e,[this.response,{id:this.id,event:void 0!==t?t:null,headers:this.responseHeaders,response:this.response,parameters:this.parameters,url:this.url,abort:this.abort.bind(this)}],"ajax.callback:: request ID:: "+this.id+" URL:: "+this.url,this)},abort:function(){null!==this.httpRequest&&"function"==typeof this.httpRequest.abort&&this.httpRequest.abort()},destroy:function(e){clearTimeout(e.timerID),o.requests.remove(e)}},new i(e,t,n,l,a)):null},parse:{settings:function(e){var e="object"==typeof e&&null!==e?e:{};return e.id="string"==typeof e.id?e.id:"number"==typeof e.id?e.id:y.id(),e.id=o.requests.isConflict(e.id)===!1?e.id:y.id(),e.timeout="number"==typeof e.timeout?e.timeout:o.settings.DEFAULT_TIMEOUT,e.doNotChangeHeaders="boolean"==typeof e.doNotChangeHeaders&&e.doNotChangeHeaders,e.doNotChangeParameters="boolean"==typeof e.doNotChangeParameters&&e.doNotChangeParameters,e.doNotEncodeParametersAsURL="boolean"==typeof e.doNotEncodeParametersAsURL&&e.doNotEncodeParametersAsURL,e.headers=o.parse.headers(e),e},parameters:function(e,t){var n=e,r={},l="",a=[],i=null;if(t.doNotChangeParameters)l=e;else{if(n instanceof Array)Array.prototype.forEach.call(n,function(e,t){var o=null;n[t]=param.replace(/^\s*\?/gi,""),o=n[t].split("="),o instanceof Array&&2===o.length?r[o[0]]=o[1]:a.push(n[t])});else if("object"==typeof n&&null!==n)for(var s in n){switch(typeof n[s]){case"string":r[s]=n[s];break;case"boolean":r[s]=n[s].toString();break;case"number":r[s]=n[s].toString();break;case"object":r[s]=JSON.stringify(n[s]);break;default:try{r[s]=JSON.stringify(n[s])}catch(e){}}r[s]=r[s]}if("string"!=typeof e)if(o.settings.regs.JSON.lastIndex=0,o.settings.regs.URLENCODED.lastIndex=0,o.settings.regs.JSON.test(t.headers[o.settings.headers.CONTENT_TYPE]))l=JSON.stringify(r);else{i=o.settings.regs.URLENCODED.test(t.headers[o.settings.headers.CONTENT_TYPE]),i=!t.doNotEncodeParametersAsURL&&i;for(var s in r)l+="&"+s+"="+i?encodeURIComponent(r[s]):r[s];l=l.replace(/^\s*\&/gi,"")}else l=e}return{original:e,parameters:r,_parameters:l,excluded:a}},callbacks:function(e){var t={before:null,success:null,fail:null,reaction:null,timeout:null};return"object"==typeof e&&null!==e&&(t.before="function"==typeof e.before?e.before:null,t.success="function"==typeof e.success?e.success:null,t.fail="function"==typeof e.fail?e.fail:null,t.reaction="function"==typeof e.reaction?e.reaction:null,t.timeout="function"==typeof e.timeout?e.timeout:null,t.headers="function"==typeof e.headers?e.headers:null),t},headers:function(e){var t={};return e.doNotChangeHeaders?t="object"==typeof e.headers&&null!==e.headers?e.headers:{}:("object"==typeof e.headers&&null!==e.headers&&l.objects.forEach(e.headers,function(e,n){var o=e.split("-");o.forEach(function(e,t){o[t]=e.charAt(0).toUpperCase()+e.slice(1)}),t[o.join("-")]=n}),void 0===t[o.settings.headers.CONTENT_TYPE]&&(t[o.settings.headers.CONTENT_TYPE]="application/x-www-form-urlencoded"),void 0===t[o.settings.headers.ACCEPT]&&(t[o.settings.headers.ACCEPT]="*/*")),e.headers=t,e.headers}}},l={namespace:{create:function(e,t){var t=t||window,n=null,o=t,r=null;if("string"==typeof e)try{return Array.prototype.forEach.call(e.split("."),function(e){n=o,e in o||(o[e]={}),o=o[e],r=e}),{target:o,parent:n,root:t,name:r}}catch(e){return null}return null},get:function(e,t){var t=t||window,n=t;if("string"==typeof e)try{return Array.prototype.forEach.call(e.split("."),function(e){if(!(e in n))throw"Property ["+n+"] was not found";n=n[e]}),n}catch(e){return null}return null}},classes:{of:function(e){return null===e?null:void 0===e?null:Object.prototype.toString.call(e).slice(8,-1)},create:function(e){var t="function"==typeof e.constr?e.constr:null,n="function"==typeof e.parent?e.parent:null,o=void 0!==e.privates?e.privates:{},r=void 0!==e.prototype?e.prototype:{},a=null,i=null;if(this instanceof l.classes.create)throw Error("Method [flex.oop.classes.create] cannot be used with derective NEW");if(null!==n){a=n,a.prototype=n.prototype,i="function"==typeof r?r.call(new t,o):r,t.prototype=new a;for(var s in i)t.prototype[s]=i[s]}else t.prototype="function"==typeof r?r.call(new t,o):r;return o.__instance=new t,o.__instance}},objects:{forEach:function(e,t){if("object"==typeof e){for(var n in e)!function(e,t,n){n(e,t[e])}(n,e,t);"toString"in{toString:null}||Array.prototype.forEach.call(["toString","valueOf","constructor","hasOwnPropery","isPrototypeOf","propertyIsEnumerable","toLocaleString"],function(o){e.hasOwnProperty(prototype)&&t(o,e[n])})}},extend:function(e,t,n){var n="Array"===l.classes.of(n)?n:[],t=null!==t&&void 0!==t&&"object"==typeof t?t:{},e="object"==typeof e?[e]:"Array"===l.classes.of(e)?e:null;return null!==e&&Array.prototype.forEach.call(e,function(e){if("object"==typeof e)for(var o in e)n.indexOf(o)===-1&&(t[o]=e[o])}),t},copy:function(e,t){function n(e){var t=null;return e instanceof Array?(t=[],Array.prototype.forEach.call(e,function(e){e instanceof Array||"object"==typeof e||"function"==typeof e?t.push(n(e)):t.push(e)})):t="object"==typeof e&&null!==e&&"function"!=typeof e?o(e):e,t}var t=t||{},e="object"==typeof e?e:null,o=l.objects.copy;if(null!==e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=n(e[r]));return t}return null},validate:function(e,t){var e="object"==typeof e?e:null,t=t||null,n=null,o=null;if(null!==e&&null!==t){t=t instanceof Array?t:[t];try{t.forEach(function(t){if(t.name&&t.type)if(e[t.name]||"boolean"==typeof e[t.name]||"number"==typeof e[t.name]){if(t.type="string"==typeof t.type?[t.type]:t.type,t.type instanceof Array){n=!1;try{t.type.forEach(function(o){if("node"===o?e[t.name]&&(n=!!e[t.name].nodeName||n):n="array"===o?e[t.name]instanceof Array==!0||n:void 0!==window[o]&&["string","number","bool"].indexOf(o)===-1?e[t.name]instanceof window[o]||n:typeof e[t.name]===o||n,n!==!1)throw"found"})}catch(e){"found"!==e&&(n=!1)}finally{if(n===!1){if(void 0===t.value)throw"deny";e[t.name]=t.value}else{if(void 0!==t.values&&t.values instanceof Array){try{o=!1,t.values.forEach(function(n){if(e[t.name]===n)throw o=!0,"found"})}catch(e){}if(o===!1)throw"deny"}if("function"==typeof t.handle)try{e[t.name]=t.handle(e[t.name])}catch(n){if(!t.value)throw"deny";e[t.name]=t.value}}}}}else{if(void 0===t.value)throw"deny";e[t.name]=t.value}})}catch(e){return!1}return!0}return null},isValueIn:function(e,t,n){var n="boolean"==typeof n&&n;if(e instanceof Array){try{e.forEach(function(e){if(e===t)throw"found"}),n!==!1&&e.forEach(function(e){if(("object"==typeof e||e instanceof Array)&&l.objects.isValueIn(e,t,n)===!0)throw"found"})}catch(e){return!0}return!1}if("object"==typeof e){try{l.objects.forEach(e,function(e,n){if(n===t)throw"found"}),n!==!1&&l.objects.forEach(e,function(e,o){if(("object"==typeof o||o instanceof Array)&&l.objects.isValueIn(o,t,n)===!0)throw"found"})}catch(e){return!0}return!1}return null},getByPath:function(e,t){var e="object"==typeof e?e:null,t="string"==typeof t?t:t instanceof Array?t:null,n=null,o={NO_BY_PATH:"NO_BY_PATH"},r=e,l=!1;if(null!==e&&null!==t){n=t instanceof Array?t:t.split(".");try{n.forEach(function(e){if(void 0===r[e])throw o.NO_BY_PATH;r=r[e]}),l=!0}catch(e){if(e!==o.NO_BY_PATH)throw e}}return l?r:void 0},findBy:function(e,t,n,o){var e="object"==typeof e?e:null,t="string"==typeof t?t:null,o="boolean"==typeof o&&o,r=o?[]:null,a={FOUND:"1"};if(null!==e&&null!==t){t=t.split(".");try{l.objects.forEach(e,function(e,i){var s=l.objects.getByPath(i,t);if(void 0!==s&&s===n){if(!o)throw r=i,a.FOUND;r.push(i)}})}catch(e){if(e!==a.FOUND)throw e}}return r}},wrappers:{objects:function(){O.prototypes.add.object("forEach",function(e){return l.objects.forEach(this.target,e)}),O.prototypes.add.object("extend",function(e,t){return l.objects.extend(this.target,e,t)}),O.prototypes.add.object("copy",function(e){return l.objects.copy(this.target,e)}),O.prototypes.add.object("validate",function(e){return l.objects.validate(this.target,e)}),O.prototypes.add.object("isValueIn",function(e,t){return l.objects.isValueIn(this.target,e,t)}),O.prototypes.add.object("getByPath",function(e){return l.objects.getByPath(this.target,e)}),O.prototypes.add.object("findBy",function(e,t,n){return l.objects.findBy(this.target,e,t,n)}),O.prototypes.add.object("createInstanceClass",function(){return l.classes.create(this.target)})}}},a={findBy:function(e,t,n,o){var e=e instanceof Array?e:null,t="string"==typeof t?t:null,o="boolean"==typeof o&&o,r=o?[]:null,a={FOUND:"1"};if(null!==e&&null!==t){t=t.split(".");try{e.forEach(function(e){var i=l.objects.getByPath(e,t);if(void 0!==i&&i===n){if(!o)throw r=e,a.FOUND;r.push(e)}})}catch(e){if(e!==a.FOUND)throw e}}return r},wrappers:{array:function(){O.prototypes.add.array("findBy",function(e,t,n){return a.findBy(this.target,e,t,n)})}}},c={init:function(){E.localStorage.isAvailable()!==!1&&(c.storage.load(),c.actions.hash(),e.defaults.resources.USE_STORAGED===!0&&c.attach())},attach:function(){["ON_NEW_MODULE","ON_UPDATED_MODULE","ON_NEW_RESOURCE","ON_UPDATED_RESOURCE"].forEach(function(t){r.core.listen(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache[t],function(n){c.events.on(e.defaults.cache.reset[t],n)})}),r.core.listen(flex.registry.events.system.logs.GROUP,flex.registry.events.system.logs.CRITICAL,function(t){c.events.on(e.defaults.cache.reset.ON_CRITICAL_ERROR,t)})},events:{on:function(e,t){e===!0&&c.actions.reset(t)},fire:{ON_NEW_MODULE:function(e){r.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_NEW_MODULE,e)},ON_UPDATED_MODULE:function(e){r.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_UPDATED_MODULE,e)},ON_NEW_RESOURCE:function(e){r.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_NEW_RESOURCE,e)},ON_UPDATED_RESOURCE:function(e){r.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_UPDATED_RESOURCE,e)}}},actions:{reset:function(){var e=!1;return function(t,o){var o="boolean"==typeof o&&o;e===!1&&(e=!0,c.storage.data.reseted===!1||o===!0?(E.localStorage.reset(n.other.STORAGE_PREFIX),v.log('[CACHE]: cache was reseted. The reason is "'+t+'"',v.types.WARNING),c.storage.data.reseted=!0,c.storage.save()):(c.storage.data.reseted=!1,c.storage.save()))}}(),hash:function(){var e=null,t=document.querySelector('script[src*="'+n.files.CORE+'"]');return null!==t&&(e=E.url.parse(t.src.toLowerCase()),null!==e.params&&e.params[n.cache.URL_PARAM_VERSION]&&(e=e.params[n.cache.URL_PARAM_VERSION],c.storage.data.hash!==e&&(c.storage.data.hash=e,c.storage.save(),c.actions.reset(e,!0)))),e}},storage:{data:{reseted:!0,hash:null},load:function(){function e(e){for(var t in c.storage.data)if(void 0===e[t])return!1;return!0}var t=E.localStorage.getJSON(n.cache.STORAGE);return null!==t&&(e(t)===!0?c.storage.data=t:c.storage.save()),!1},save:function(){E.localStorage.setJSON(n.cache.STORAGE,c.storage.data)}}},u={storage:{data:{},get:function(){return u.storage.data=E.localStorage.getJSON(n.hashes.LOCAL_STORAGE_NAME,n.other.STORAGE_PREFIX),"object"==typeof u.storage.data&&null!==u.storage.data||u.storage.create(),u.storage.data},create:function(){u.storage.data={},u.storage.update()},update:function(){E.localStorage.setJSON(n.hashes.LOCAL_STORAGE_NAME,u.storage.data,n.other.STORAGE_PREFIX)}},get:function(e){var t=u.storage.get();return"object"==typeof t[e]?t[e].hash:null},set:function(e,t){var n=u.storage.get();return"string"==typeof t&&(n[e]={url:e,hash:t},u.storage.update(),!0)},update:{add:function(e){u.update.queue.add(e)},queue:{queue:{},journal:{},isLock:!0,unlock:function(){u.update.queue.isLock=!1,u.update.proceed()},add:function(e){"string"==typeof e&&void 0===u.update.queue.journal[e]&&(u.update.queue.journal[e]=!0,u.update.queue.queue[e]={url:e,working:!1}),u.update.queue.isLock||u.update.proceed()},del:function(e){"string"==typeof e&&(u.update.queue.queue[e]=null,delete u.update.queue.queue[e])},work:function(e){"object"==typeof u.update.queue.queue[e]&&(u.update.queue.queue[e].working=!0)},isWorking:function(e){if("object"==typeof u.update.queue.queue[e])return u.update.queue.queue[e].working}},proceed:function(){l.objects.forEach(u.update.queue.queue,function(e,t){var n=null;u.update.queue.isWorking(e)===!1&&(u.update.queue.work(e),n=o.create(t.url,o.settings.methods.GET,null,{headers:function(n,o){u.update.processing(e,t.url,o)},fail:function(n,o){u.update.fail(e,t.url,o)}}),n.send())})},processing:function(e,t,n){var o="",r=u.get(t);null!==n.headers&&""!==n.headers._headers&&(u.update.queue.del(e),l.objects.forEach(n.headers.headers,function(e,t){"date"!==e.toLowerCase()&&(o+=t)}),u.get(t)!==o&&(null===r?v.log("[HASHES]:: hash for resource ["+t+"] was generated. Next updating of page, resource will be loaded again.",v.types.KERNEL_LOGS):(v.log("[HASHES]:: resource ["+t+"] have to be updated.",v.types.KERNEL_LOGS),u.resources.update(t)),u.set(t,o)),n.abort())},fail:function(e,t,n){null===n.headers&&(v.log("[HASHES]:: fail to load hash for resource ["+t+"].",v.types.KERNEL_LOGS),u.update.queue.del(e))}},resources:{update:function(e){return u.resources.css.update(e)===!0||void v.log("[HASHES]:: resource ["+e+"] cannot be updated in current session. It will be done after page be reloaded.",v.types.KERNEL_LOGS)},css:{update:function(e){var t=document.querySelector("style["+E.resources.css.settings.attr.SRC+'$="'+e+'"]');return null!==t&&(E.resources.css.connect(e,function(){t.parentNode.removeChild(t),v.log("[HASHES]:: resource ["+e+"] have been updated in current session.",v.types.KERNEL_LOGS)}),!0)}}}},f={isReady:function(){return p.register.isReady(n.register.MODULES_HISTROY)},preload:function(){var t=e.defaults.resources.MODULES;t instanceof Array&&(t.length>0?(p.register.open(n.register.MODULES_HISTROY,t.map(function(e){return f.tools.clearName(e)}),d.preload),Array.prototype.forEach.call(t,function(e){var t=f.reference.getSource(e);null===f.registry.getSettings(e.replace(/^flex\./gi,""))&&f.registry.add({name:e,hash:u.get(t),autoHash:!0,source:t}),f.reference.history.add(e),f.repository.call(e)})):d.preload())},reference:{history:{data:[],add:function(e){f.reference.history.data.push(e.replace("flex.libraries.","").replace(/^flex\./gi,""))},isIn:function(e){return f.reference.history.data.indexOf(e.replace("flex.libraries.","").replace(/^flex\./gi,""))!==-1}},caller:{name:null,ready:null},getSource:function(e){var t=e.split("."),o="";return o=t.length>0?"flex"===t[0]?n.files.FLEX+e:n.files.ROOT+t[0]+"/"+e.replace(t[0]+".",""):n.files.ROOT+e,o+".js"},call:function(e){var t=f.reference.caller,n=f.reference.history;null!==t.name&&(null===f.storage.get(e)?(t.ready=!1,n.isIn(e)===!1&&(n.add(e),f.repository.call(e))):t.ready=t.ready!==!1)},check:function(e,t){var o=f.reference.caller,r=f.storage.get(e),t="function"==typeof t&&t,a=[];if(null!==r)try{o.name=e,o.ready=!0,r.reference instanceof Array&&r.reference.forEach(function(e){var n=f.reference.getSource(e),o=f.tools.fullName(e.replace(/^flex\./gi,"")),r=null;null===f.registry.getSettings(e.replace(/^flex\./gi,""))&&f.registry.add({name:e,hash:u.get(n),autoHash:!0,source:n}),t&&(r=l.namespace.get(o),null!==r&&void 0!==r.create||a.push(o)),f.reference.call(e)})}catch(t){v.log("[MODULES]:: module ["+e+"] generated error during request for references:\n\r"+v.parseError(t),v.types.CRITICAL),o.ready=!1}finally{r.ready=o.ready,o.name=null,o.ready=null,t&&(a.length>0?(a=a.filter(function(e){var t=l.namespace.get(e);return null===t||void 0===t.create}),a.length>0?(p.register.open(n.register.MODULES_HISTROY_CREATION+":"+e,a,t),f.reference.waited.add(e)):t()):t())}else t&&t()},pending:function(){var e=f.storage.pending(),t=f.reference.check;e.length>0&&Array.prototype.forEach.call(e,function(e){t(e)})},waited:{tasks:[],add:function(e){f.reference.waited.tasks.push(e)},done:function(e){f.reference.waited.tasks.forEach(function(t){p.register.done(n.register.MODULES_HISTROY_CREATION+":"+t,e)})}}},registry:{makeCaller:function(e){var t=l.namespace.create(e.name.replace(/^flex\./gi,""),flex.libraries),n=null;null!==t&&(n=f.tools.fullName(e.name.replace(/^flex\./gi,"")),Object.defineProperty(t.parent,t.name,{enumerable:!1,configurable:!1,value:function(){f.reference.call(n)}}))},getSettings:function(e){var e=0===e.indexOf("flex.libraries.")?e.replace("flex.libraries.",""):e;return l.namespace.get(e,flex.libraries_data)},add:function(e){var t=null,n=e.name.replace(/^flex\./gi,"");return null===f.registry.getSettings(n)&&(t=l.namespace.create(n,flex.libraries_data),null!==t)&&(t.target.name=e.name,t.target.source=e.source,t.target.hash=e.hash,t.target.autoHash=e.autoHash,f.registry.makeCaller(e),!0)},validateSRC:function(t){return E.url.sterilize(t.replace(e.defaults.settings.KERNEL_PATH_SIGNATURE,e.defaults.paths.CORE+"/"))}},storage:{data:{},add:function(e){var t=f.storage.data;return void 0===t[e.name]&&(t[e.name]={name:e.name,protofunction:e.protofunction,onBeforeAttach:e.onBeforeAttach,onAfterAttach:e.onAfterAttach,extend:e.extend,reference:e.reference,ready:!1},!0)},get:function(e){return void 0===f.storage.data[e]?null:f.storage.data[e]},pending:function(){var e=[];for(var t in f.storage.data)f.storage.data[t].ready===!1&&e.push(t);return e}},attach:{queue:{data:[],add:function(e){f.attach.queue.data.push(e)},reset:function(){f.attach.queue.data=[]},proceed:function(){var e=f.attach.queue;Array.prototype.forEach.call(e.data,function(t,n){"boolean"!=typeof t.going&&(e.data[n].going=!0,f.attach.embody.procceed(t))}),e.reset()}},safely:function(e){var t=f.attach.queue;return t.add(e),t.proceed(),!1},embody:{createConstructor:function(e,t){var n=f.storage.get(e),t="function"==typeof t?t:null;return null!==t||null!==n?(t=null!==t?t:n.protofunction,"function"==typeof t.prototype?function(){return"function"==typeof t.prototype&&(t.prototype=t.prototype()),new t}:(v.log("[MODULES]:: cannot create caller for module ["+e+"]. Prototype of module should be a function.",v.types.CRITICAL),null)):(v.log("[MODULES]:: cannot create caller for module ["+e+"]. Incorrect prototype function.",v.types.CRITICAL),null)},procceed:function(e){var t=null;if(l.objects.validate(e,[{name:"name",type:"string"},{name:"protofunction",type:"function"},{name:"reference",type:"array",value:null},{name:"resources",type:"array",value:[]},{name:"onBeforeAttach",type:"function",value:null},{name:"onAfterAttach",type:"function",value:null},{name:"extend",type:["array","object"],value:[]}])!==!1)if(f.reference.history.isIn(e.name)){if(e.name=f.tools.fullName(e.name),t=l.namespace.get(e.name),null!==t&&t!==!1&&void 0===t.create&&(f.storage.add(e),t.create=f.attach.embody.createConstructor(e.name,e.protofunction),null!==t.create))return f.repository.add(e),f.reference.check(e.name,function(){E.handle(e.onBeforeAttach),f.resources.check(e.name,e.resources,function(){f.reference.pending(),p.register.done(n.register.MODULES_HISTROY,e.name),E.handle(e.onAfterAttach),f.reference.waited.done(e.name),v.log("[MODULES]:: ["+e.name+"] was initialized.",v.types.KERNEL_LOGS)})}),!0}else null===f.registry.getSettings(e.name.replace(/^flex\./gi,""))&&f.registry.add({name:e.name,hash:null,autoHash:!1,source:null}),e.name=f.tools.fullName(e.name),f.storage.add(e),f.repository.add(e);return!1}},unexpected:{isReady:function(){return f.attach.unexpected.journal.isReady(!0)},journal:{consts:{MODULES:"(modules)",RESOURCES:"(resources)"},modules:{add:function(e){return f.attach.unexpected.journal.add(e,!0)},done:function(e){f.attach.unexpected.journal.done(e,!0),f.attach.unexpected.journal.isReady(!0)&&t.onFlexLoad()},isIn:function(e){return f.attach.unexpected.journal.isIn(e,!0)},isReady:function(){return f.attach.unexpected.journal.isReady(!0)}},resource:{add:function(e){return f.attach.unexpected.journal.add(e,!1)},done:function(e){return f.attach.unexpected.journal.done(e,!1)},isIn:function(e){return f.attach.unexpected.journal.isIn(e,!1)}},add:function(e,t){var o=f.attach.unexpected.journal.consts,r=p.globaly.get(n.storage.GROUP,(t?o.MODULES:o.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{});r[e]||(r[e]=!1)},done:function(e,t){var o=f.attach.unexpected.journal.consts,r=p.globaly.get(n.storage.GROUP,(t?o.MODULES:o.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{});void 0!==r[e]&&(r[e]=!0)},isIn:function(e,t){var o=f.attach.unexpected.journal.consts,r=p.globaly.get(n.storage.GROUP,(t?o.MODULES:o.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{});return void 0!==r[e]},isReady:function(e){var t=f.attach.unexpected.journal.consts,o=p.globaly.get(n.storage.GROUP,(e?t.MODULES:t.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{}),r=!0;return l.objects.forEach(o,function(e,t){r=r!==!1&&t}),r}},launched:{storage:[],add:function(e){f.attach.unexpected.launched.storage.push(e)},reset:function(e){f.attach.unexpected.launched.storage=null},accept:function(){f.attach.unexpected.launched.storage.forEach(function(e){e.call(window)}),f.attach.unexpected.launched.reset()}},safely:function(t,n){function o(t){return"string"==typeof t?E.url.sterilize(t.replace(e.defaults.settings.ATTACH_PATH_SIGNATURE,e.defaults.paths.ATTACH+"/")):null}function r(){f.attach.unexpected.journal.modules.add(t.src),t.require=t.require.map(function(e){return"string"==typeof e.url?(e.url=o(e.url),null!==e&&(e=f.attach.unexpected.journal.resource.isIn(e.url)===!1?e:null),e):(v.log("["+t.name+"]:: some resource was defined incorrectly. Field [url] was not found.",v.types.CRITICAL),null)}),t.require=t.require.filter(function(e){return null!==e}),u.update.add(t.src),t.require.length>0?(a=y.id(t.src),p.register.open(a,t.require.map(function(e){return e.url}),function(){f.attach.unexpected.embody(t)}),t.require.forEach(function(e){f.attach.unexpected.journal.resource.add(e.url)}),t.require.forEach(function(e){u.update.add(e.url),d.repository.call(e.url,u.get(e.url),function(){p.register.done(a,e.url),f.attach.unexpected.journal.resource.done(e.url)})})):f.attach.unexpected.embody(t)}var a=null,n="boolean"==typeof n&&n;l.objects.validate(t,[{name:"name",type:"string"},{name:"launch",type:"function",value:null},{name:"constructor",type:"function",value:null},{name:"module",type:"function",value:null},{name:"require",type:"array",value:[]},{name:"onBeforeAttach",type:"function",value:null},{name:"onAfterAttach",type:"function",value:null},{name:"extend",type:["array","object"],value:null}])!==!1?(n||(t.src=E.resources.js.getCurrentSRC()),t.src=null===t.src?d.inbuilt.get.js():t.src,null!==t.src?f.attach.unexpected.journal.modules.isIn(t.src)===!1&&(null!==t.launch?r():null!==t.module&&(f.registry.add({name:t.name,source:t.src,hash:u.get(t.src),autoHash:!0})!==!1?r():v.log("["+t.name+"]:: attempt to attach module twice",v.types.WARNING))):v.log("["+t.name+"]:: unexpected error with module. Cannot detect URL",v.types.CRITICAL)):"string"==typeof t.name?"function"!=typeof t.module&&v.log("["+t.name+"]:: to attach new module, should be defined parameter [module] as function",v.types.CRITICAL):v.log("Fail to attach new module.",v.types.CRITICAL)},embody:function(e){var t=null;if(l.objects.validate(e,[{name:"name",type:"string"},{name:"src",type:"string"},{name:"launch",type:"function",value:null},{name:"constructor",type:"function",value:null},{name:"module",type:"function",value:null},{name:"onBeforeAttach",type:"function",value:null},{name:"onAfterAttach",type:"function",value:null},{name:"extend",type:["array","object"],value:[]}])!==!1){if(null!==e.launch)return f.attach.unexpected.launched.add(e.launch),f.attach.unexpected.journal.modules.done(e.src),!0;if(null!==e.module&&(e.name=f.tools.fullName(e.name),t=l.namespace.get(e.name),null!==t&&t!==!1&&void 0===t.create))return e.protofunction=null===e.constructor?function(){}:e.constructor,e.protofunction.prototype=e.module,t.create=f.attach.embody.createConstructor(e.name,e.protofunction),f.attach.unexpected.journal.modules.done(e.src),!0}return!1}}},resources:{
loader:{load:function(e,t,n){var r=o.create(e,o.settings.methods.GET,null,{success:function(n,o){f.resources.loader.success(e,n,t)},fail:function(n,o){f.resources.loader.fail(o,e,n,t)}});r.send()},success:function(e,t,o){E.localStorage.setJSON(e,{value:t.original,url:e,hash:o},n.other.STORAGE_PREFIX)},fail:function(e,t,n,o){v.log("[MODULES]:: cannot load resource: ["+t+"]. Resource will be attached.",v.types.WARNING)}},check:function(e,t,o){var r=f.registry.getSettings(e);null!==r&&null!==t&&(t instanceof Array||(t=[t]),t.length>0?(t=t.map(function(e){if("string"==typeof e.url)return{url:f.registry.validateSRC(e.url),hash:r.autoHash===!0?u.get(e.url):r.hash,autoHash:r.autoHash}}),p.register.open(n.register.RESOURCES_HISTORY+":"+e,t.map(function(e){return e.url}),o),f.resources.get(t,e)):o())},get:function(e,t){var o=p.globaly.get(n.storage.GROUP,n.storage.RESOURCES_JOURNAL,{});Array.prototype.forEach.call(e,function(e){o[e.url]||(f.resources.load(t,e),o[e.url]=t)})},load:function(t,o){function r(e,t){var o=null,r=E.url.getTypeOfResource(t.url);if(r===n.resources.types.CSS)E.resources.css.adoption(t.value,null,E.url.restoreFullURL(t.url));else if(r===n.resources.types.JS){o=new Function(t.value);try{o.call(window),v.log("[MODULES]:: resource: ["+t.url+"] was adopted.",v.types.KERNEL_LOGS)}catch(e){v.log("[MODULES]:: during initialization of resource: ["+t.url+"] happened error:/n/r"+v.parseError(e),v.types.WARNING)}}p.register.done(n.register.RESOURCES_HISTORY+":"+e,t.url)}function l(e,t){var o=E.url.getTypeOfResource(t.url);o===n.resources.types.CSS?E.resources.css.connect(t.url,function(){p.register.done(n.register.RESOURCES_HISTORY+":"+e,t.url),v.log("[MODULES]:: resource of module ["+e+"] (file: ["+t.url+"]) is reloaded.",v.types.KERNEL_LOGS)},null):o===n.resources.types.JS&&E.resources.js.connect(t.url,function(){p.register.done(n.register.RESOURCES_HISTORY+":"+e,t.url),v.log("[MODULES]:: resource of module ["+e+"] (file: ["+t.url+"]) is reloaded.",v.types.KERNEL_LOGS)},null),f.resources.loader.load(t.url,t.hash,t.autoHash)}var a=E.localStorage,i=a.getJSON(o.url,n.other.STORAGE_PREFIX);null!==i&&e.defaults.resources.USE_STORAGED!==!1?o.hash===i.hash?r(t,i):(l(t,o),v.log("[MODULES]:: resource of module ["+t+"] (file: ["+o.url+"]) will be reloaded.",v.types.KERNEL_LOGS)):l(t,o),o.autoHash===!0&&u.update.add(o.url)}},repository:{add:function(e){var t=f.registry.getSettings(e.name),o={name:e.name||null,constr:e.protofunction||null,protofunction:e.protofunction.prototype||null,reference:e.reference||null,resources:e.resources||null,onBeforeAttach:e.onBeforeAttach||null,onAfterAttach:e.onAfterAttach||null,extend:e.extend||null,unexpected:e.unexpected||null};f.repository.getHash(e.name);return o.constr="function"==typeof o.constr?g.js.stringify(o.constr):null,o.protofunction="function"==typeof o.protofunction?g.js.stringify(o.protofunction):null,o.reference=o.reference instanceof Array?o.reference:null,o.onBeforeAttach="function"==typeof o.onBeforeAttach?g.js.stringify(o.onBeforeAttach):null,o.onAfterAttach="function"==typeof o.onAfterAttach?g.js.stringify(o.onAfterAttach):null,null!==o.constr&&null!==o.protofunction?(v.log("[MODULES]:: module ["+e.name+"] was updated.",v.types.KERNEL_LOGS),t.autoHash===!0&&(t.hash=u.get(t.source),u.set(t.source,t.hash),u.update.add(t.source)),E.localStorage.set(e.name,JSON.stringify({data:o,hash:t.hash}),!0,n.other.STORAGE_PREFIX)):null},get:function(t,o){var r=E.localStorage,l=r.get(t,!0,n.other.STORAGE_PREFIX),a=f.registry.getSettings(t);if(null===a.source&&null!==l||null!==l&&e.defaults.resources.USE_STORAGED!==!1)try{return l=JSON.parse(l),l.hash===o||null===a.source?(l.data.protofunction=g.js.parse({constr:{params:l.data.constr.params,body:l.data.constr.body},proto:{params:l.data.protofunction.params,body:l.data.protofunction.body}}),null!==l.data.onBeforeAttach&&(l.data.onBeforeAttach=g.js.parseFunction(l.data.onBeforeAttach.params,l.data.onBeforeAttach.body)),null!==l.data.onAfterAttach&&(l.data.onAfterAttach=g.js.parseFunction(l.data.onAfterAttach.params,l.data.onAfterAttach.body)),l.data.constr=null,delete l.data.constr,l.data):(v.log("[MODULES]:: module ["+t+"] will be updated.",v.types.KERNEL_LOGS),c.events.fire.ON_UPDATED_MODULE(t),r.del(t,n.other.STORAGE_PREFIX),null)}catch(e){return v.log("[MODULES]:: new module ["+t+"] is detected.",v.types.WARNING),c.events.fire.ON_NEW_MODULE(t),r.del(t,n.other.STORAGE_PREFIX),null}else v.log("[MODULES]:: new module ["+t+"] new module is detected.",v.types.WARNING),c.events.fire.ON_NEW_MODULE(t);return null},getHash:function(e){var t=E.localStorage,o=t.get(e,!0,n.other.STORAGE_PREFIX);if(null!==o)try{return o=JSON.parse(o),o.hash}catch(e){return null}return null},call:function(e){var e=f.tools.clearName(e),t=f.registry.getSettings(e),o=null;if(null!==t&&void 0!==t.hash){if(p.register.add(n.register.MODULES_HISTROY,f.tools.clearName(e)),o=f.storage.get(f.tools.fullName(e)),o=null!==o?o:f.repository.get(f.tools.fullName(e),t.hash),null!==o)return f.attach.safely(o),!0;if(E.url.is.js(t.source))return E.resources.js.connect(t.source,null,null),!0;if(E.url.is.css(t.source))return E.resources.css.connect(t.source,null,null),!0}return v.log("[MODULES]:: module ["+e+"] cannot be called. Check definitions in registry [flex.registry.modules.js].",v.types.CRITICAL),!1}},tools:{fullName:function(e){return e=e.toLowerCase(),(0!==e.indexOf("flex.libraries.")?"flex.libraries."+e:e).replace(/\.\./gi,".")},clearName:function(e){return e=e.toLowerCase().replace("flex.",""),e.indexOf("libraries.")===-1?"flex.libraries."+e:"flex."+e}}},d={isReady:function(){return void 0!==d.preload.__started&&p.register.isReady(n.register.EXTERNAL_HISTROY)},queue:{create:function(e){p.register.open(n.register.EXTERNAL_HISTROY,e.map(function(e){return e.url}),t.onFlexLoad)},add:function(e){return"string"==typeof e&&p.register.add(n.register.EXTERNAL_HISTROY,e)},done:function(e){return"string"==typeof e&&p.register.done(n.register.EXTERNAL_HISTROY,e)}},preload:function(){var n=e.defaults.resources.EXTERNAL;d.preload.__started=!0,n instanceof Array&&n.length>0?(d.queue.create(n),Array.prototype.forEach.call(n,function(e){l.objects.validate(e,[{name:"url",type:"string"},{name:"hash",type:"string",value:!1}])!==!1&&(e.autoHash=e.hash===!1,e.hash=e.hash===!1?u.get(e.url):e.hash,d.repository.call(e.url,e.hash),e.autoHash===!0&&u.update.add(e.url))})):t.onFlexLoad()},embody:function(t){function o(n,o,r,l){var a=null;if(e.defaults.resources.USE_STORAGED===!1||null===t.body)E.resources.js.connect(o,r,l);else{a=new Function(n);try{return d.inbuilt.set.js(o),a.call(window),d.inbuilt.set.js(null),E.handle(r,null,"external.embody",this),!0}catch(e){return v.log("During initialization of resource: ["+o+"] happened error:/n/r"+v.parseError(e),v.types.WARNING),E.handle(l,null,"external.embody",this),!1}}}function r(n,o,r,l){return e.defaults.resources.USE_STORAGED===!1||null===t.body?E.resources.css.connect(o,r,l):(d.inbuilt.set.css(o),E.resources.css.adoption(n,null,E.url.restoreFullURL(o)),d.inbuilt.set.css(null),E.handle(r,null,"external.embody",this)),!0}var l=null,a=E.url.getTypeOfResource(t.url);a===n.resources.types.JS?l=o:a===n.resources.types.CSS&&(l=r),null!==l&&l(t.body,t.url,function(){null!==t.callback?E.handle(t.callback,t.url,"[flex]external.embody"):d.queue.done(t.url)},function(){v.log("Resource ["+t.url+"] was not load. But FLEX continues loading.",v.types.CRITICAL),null===t.callback&&d.queue.done(t.url)})},inbuilt:{storage:{js:null,css:null},set:{js:function(e){d.inbuilt.storage.js=e},css:function(e){d.inbuilt.storage.css=e}},get:{js:function(){return d.inbuilt.storage.js},css:function(){return d.inbuilt.storage.css}}},repository:{add:function(t){var o=d.repository.getHash(t.url);return o!==t.hash&&e.defaults.resources.USE_STORAGED!==!1&&null!==t.body?E.localStorage.set(t.url,JSON.stringify({body:t.body,hash:t.hash}),!0,n.other.STORAGE_PREFIX):null},get:function(t,o){var r=E.localStorage,l=r.get(t,!0,n.other.STORAGE_PREFIX);if(null!==l&&e.defaults.resources.USE_STORAGED!==!1)try{return l=JSON.parse(l),l.hash===o?l:(r.del(t,n.other.STORAGE_PREFIX),c.events.fire.ON_UPDATED_RESOURCE(t),null)}catch(e){return c.events.fire.ON_NEW_RESOURCE(t),r.del(t,n.other.STORAGE_PREFIX),null}else c.events.fire.ON_NEW_RESOURCE(t);return null},getHash:function(e){var t=E.localStorage,o=t.get(e,!0,n.other.STORAGE_PREFIX);if(null!==o)try{return o=JSON.parse(o),o.hash}catch(e){return null}return null},call:function(e,t,n){var o=d.repository.get(e,t),n="function"==typeof n?n:null;null!==o&&o.hash===t?d.embody({url:e,hash:t,body:o.body,callback:n}):d.loader.load(e,t,!0,n)}},loader:{load:function(e,t,n,r){var l=o.create(e,o.settings.methods.GET,null,{success:function(o,l){d.loader.success(e,o,t,n,r)},fail:function(o,l){d.loader.fail(l,e,t,n,r)}});l.send(),v.log("[EXTERNAL]:: resource: ["+e+"] will be reloaded.",v.types.KERNEL_LOGS)},success:function(e,t,n,o,r){d.repository.add({url:e,hash:n,body:null!==t?t.original:null}),o===!0&&d.embody({url:e,hash:n,body:null!==t?t.original:null,callback:r}),v.log("[EXTERNAL]:: resource: ["+e+"] is reloaded.",v.types.KERNEL_LOGS)},fail:function(e,t,n,o,r){v.log("[EXTERNAL]:: cannot load resource: ["+t+"] cannot be loaded by XMLHttpRequest.",v.types.WARNING),d.embody({url:t,hash:n,body:null,callback:r})}}},h={isReady:function(){return void 0!==h.preload.__started&&(!e.defaults.resources.WAIT_ASYNCHRONOUS||p.register.isReady(n.register.ASYNCHRONOUS_HISTORY))},preload:function(){var o=e.defaults.resources.ASYNCHRONOUS;h.preload.__started=!0,o instanceof Array&&o.length>0?(p.register.open(n.register.ASYNCHRONOUS_HISTORY,Array.prototype.map.call(o,function(e,t){return t}),function(){t.onFlexLoad()}),Array.prototype.forEach.call(o,function(e,t){var o=y.id();l.objects.validate(e,[{name:"resources",type:"array"},{name:"storage",type:"boolean",value:!0},{name:"finish",type:"function",value:null}])!==!1&&(e.resources=e.resources.filter(function(e){return"string"==typeof e.url}),p.register.open(o,e.resources.map(function(e){return e.url}),function(){E.handle(e.finish),p.register.done(n.register.ASYNCHRONOUS_HISTORY,t)}),e.resources.forEach(function(t){l.objects.validate(t,[{name:"url",type:"string"},{name:"hash",type:"string",value:!1},{name:"after",type:"array",value:!1}])!==!1&&(t.hash===!1&&(t.hash=u.get(t.url),u.update.add(t.url)),h.repository.call(t,o,e.storage))}))})):t.onFlexLoad()},embody:function(t){function o(n,o,r,l){var a=null;if(e.defaults.resources.USE_STORAGED===!1||l===!1||null===t.body)return E.resources.js.connect(r,function(){p.register.done(n,r),h.wait.check()},function(){v.log("[ASYNCHRONOUS]:: cannot load resource: ["+r+"].",v.types.CRITICAL)}),!1;a=new Function(o);try{return a.call(window),!0}catch(e){return v.log("[ASYNCHRONOUS]:: during initialization of resource: ["+r+"] happened error:/n/r"+v.parseError(e),v.types.WARNING),!1}}function r(n,o,r,l){return e.defaults.resources.USE_STORAGED===!1||l===!1||null===t.body?E.resources.css.connect(r,null,function(){v.log("[ASYNCHRONOUS]:: cannot load resource: ["+r+"].",v.types.CRITICAL)}):E.resources.css.adoption(o,null,E.url.restoreFullURL(r)),!0}var l=E.url.getTypeOfResource(t.url),a=null;l===n.resources.types.JS?a=o:l===n.resources.types.CSS&&(a=r),null!==a&&a(t.id,t.body,t.url,t.storage)!==!1&&(p.register.done(t.id,t.url),h.wait.check())},repository:{add:function(t){return e.defaults.resources.USE_STORAGED!==!1&&null!==t.body?E.localStorage.set(t.url,JSON.stringify({body:t.body,hash:t.hash}),!0,n.other.STORAGE_PREFIX):null},get:function(t,o){var r=E.localStorage,l=r.get(t,!0,n.other.STORAGE_PREFIX);if(null!==l&&e.defaults.resources.USE_STORAGED!==!1)try{return l=JSON.parse(l),l.hash!==o?(v.log("[ASYNCHRONOUS]:: resource ["+t+"] will be updated.",v.types.KERNEL_LOGS),r.del(t,n.other.STORAGE_PREFIX),c.events.fire.ON_UPDATED_RESOURCE(t),null):l}catch(e){return r.del(t,n.other.STORAGE_PREFIX),c.events.fire.ON_NEW_RESOURCE(t),null}else c.events.fire.ON_NEW_RESOURCE(t);return null},call:function(e,t,n){function o(e,t,n){var o=h.repository.get(e.url,e.hash);null!==o||n===!1?h.embody({url:e.url,id:t,body:null!==o?o.body:null,storage:n}):h.loader.load(e.url,t,!0,n,e.hash)}var r=!0;e.after===!1?o(e,t,n):(e.after.forEach(function(e){r=r!==!1&&p.register.isDone(t,e)}),r!==!1?(o(e,t,n),h.wait.remove(e.url)):h.wait.add(e,t,n))}},loader:{load:function(e,t,n,r,l){var a=o.create(e,o.settings.methods.GET,null,{success:function(o,a){h.loader.success(e,o,t,n,r,l)},fail:function(o,a){h.loader.fail(a,e,o,t,n,r,l)}});a.send()},success:function(e,t,n,o,r,l){r!==!1&&null!==t&&void 0!==t.original&&h.repository.add({url:e,body:t.original,hash:l}),o!==!1&&h.embody({url:e,id:n,body:null!==t?t.original:null,storage:r})},fail:function(e,t,n,o,r,l,a){v.log("[ASYNCHRONOUS]:: cannot load resource: ["+t+"] cannot be loaded by XMLHttpRequest.",v.types.WARNING),h.embody({url:t,id:o,body:null,storage:!1})}},wait:{storage:{},add:function(e,t,n){var o=h.wait.storage;o[e.url]||(o[e.url]=e,o[e.url].id=t,o[e.url].storage=n)},remove:function(e){var t=h.wait.storage;t[e]&&(t[e]=null,delete t[e])},check:function(){var e=h.wait.storage;for(var t in e)h.repository.call(e[t],e[t].id,e[t].storage)}}},g={js:{stringify:function(e){var t=g.js.tools,n=null,o=null;if("function"==typeof e)return n=e.toString(),o={params:t.getParams(n),body:t.getBody(n)},null!==o.params&&null!==o.body?o:null},parse:function(e){var t=g.js.parseFunction(e.constr.params,e.constr.body);return"function"==typeof t&&(t.prototype=g.js.parseFunction(e.proto.params,e.proto.body),"function"==typeof t.prototype)?t:null},parseFunction:function(e,t){return"string"==typeof e&&"string"==typeof t?""===e?new Function(t):new Function(e,t):null},tools:{regs:{FUNCTION:/^\(?function\s.*?\(.*?\)\s*?\{/gi,ARGUMENTS:/\(.*?\)/gi,ARGUMENTS_BORDERS:/[\(\)]/gi,BODY_END:/\}$/gi,STRICT:/(use strict)/gi},getBody:function(e){return e=e.replace(g.js.tools.regs.FUNCTION,""),e=e.replace(g.js.tools.regs.BODY_END,""),e.search(g.js.tools.regs.STRICT)===-1&&(e='"use strict";'+e),e},getParams:function(e){var t=e.match(g.js.tools.regs.FUNCTION);return null!==t&&1===t.length&&(t=t[0].match(g.js.tools.regs.ARGUMENTS),1===t.length)?t=t[0].replace(g.js.tools.regs.ARGUMENTS_BORDERS,""):null}}},css:{stringify:function(e){function t(e){function t(e){var t="";return e.cssRules&&(t="@keyframes "+e.name+" {\n\r",Array.prototype.forEach.call(e.cssRules,function(e){t+=e.keyText+" { "+e.style.cssText+" }\n\r"}),t+="}"),t}var n="";document;return e.cssRules||e.rules?Array.prototype.forEach.call(e.cssRules||e.rules,function(e){n+="string"==typeof e.cssText?e.cssText+"\n\r":t(e)+"\n\r"}):"string"==typeof e.cssText&&(n=e.cssText),n}var n=(document.styleSheets,null);try{Array.prototype.forEach.call(document.styleSheets,function(o){if(o.href&&o.href.indexOf(e)!==-1)throw n=t(o),"found"})}catch(e){}finally{return n}}}},p={globaly:{storage:{},get:function(e,t,n){var o=p.globaly.storage;return e in o&&t in o[e]?o[e][t]:n?p.globaly.set(e,t,n):null},set:function(e,t,n){var o=p.globaly.storage;return o[e]=e in o?o[e]:{},o[e][t]=n,o[e][t]},remove:function(e,t){var n=p.globaly.storage;return e in n&&t in n[e]&&(n[e][t]=null,delete n[e][t],0===Object.keys(n[e]).length&&(n[e]=null,delete n[e]),!0)}},objecty:{settings:{COMMON_STORAGE_NAME:"FlexObjectStorage"},set:function(e,t,n,o){var o="boolean"!=typeof o||o,r=p.objecty.settings;return"object"==typeof e&&"string"==typeof t&&void 0!==n?("object"!=typeof e[r.COMMON_STORAGE_NAME]&&(e[r.COMMON_STORAGE_NAME]={}),o===!1?void 0===e[r.COMMON_STORAGE_NAME][t]&&(e[r.COMMON_STORAGE_NAME][t]=n):e[r.COMMON_STORAGE_NAME][t]=n,n):null},get:function(e,t,n,o){var n="boolean"==typeof n&&n,o=void 0!==o?o:null,r=null,l=p.objecty.settings,a=p.objecty.tools;if("object"==typeof e&&"string"==typeof t)if("object"==typeof e[l.COMMON_STORAGE_NAME]){if(void 0!==e[l.COMMON_STORAGE_NAME][t])return r=e[l.COMMON_STORAGE_NAME][t],n===!0&&(e[l.COMMON_STORAGE_NAME][t]=null,a.deleteAttribute(e,t),a.clear(e)),r;if(null!==o)return e[l.COMMON_STORAGE_NAME][t]=o,e[l.COMMON_STORAGE_NAME][t]}else if(null!==o)return e[l.COMMON_STORAGE_NAME]={},e[l.COMMON_STORAGE_NAME][t]=o,e[l.COMMON_STORAGE_NAME][t];return null},remove:function(e,t){var n=p.objecty.settings,o=p.objecty.tools;return"object"==typeof e&&"string"==typeof t?"object"==typeof e[n.COMMON_STORAGE_NAME]&&void 0!==e[n.COMMON_STORAGE_NAME][t]&&(e[n.COMMON_STORAGE_NAME][t]=null,o.deleteAttribute(e,t),o.clear(e),!0):null},tools:{deleteAttribute:function(e,t){try{delete e[t]}catch(n){e.removeAttribute(t)}},clear:function(e){var t=p.objecty.settings,n=p.objecty.tools;0===Object.keys(e[t.COMMON_STORAGE_NAME]).length&&(e[t.COMMON_STORAGE_NAME]=null,n.deleteAttribute(e,t.COMMON_STORAGE_NAME))}}},register:{settings:{COMMON_STORAGE_NAME:"FlexRegisterStorage"},build:function(e,t){var n=function(e,t){this.name=e,this.onReady=t,this.items={}};return n.prototype={add:function(e){return!this.items[e]&&(this.items[e]={isDone:!1,key:e},!0)},done:function(e,t){var t="boolean"==typeof t&&t;return this.items[e]&&(this.items[e].isDone=!0),t===!1&&this.isReady()!==!1&&(null!==this.onReady&&void 0===this.handled&&(this.handled=!0,E.handle(this.onReady,null,"Register: "+this.name,this)),!0)},isReady:function(){for(var e in this.items)if(this.items[e].isDone===!1)return!1;return!0},isIn:function(e){return!!this.items[e]},isDone:function(e){return this.items[e]?this.items[e].isDone:null}},new n(e,t)},open:function(e,t,o){var e="string"==typeof e?e:null,t=t instanceof Array?t:void 0!==t?[t]:null,o="function"==typeof o?o:null,r=null,l=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return null!==e&&!l[e]&&(r=p.register.build(e,o),t.forEach(function(e){r.add(e)}),l[e]=r,!0)},add:function(e,t){var o=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!!o[e]&&o[e].add(t)},done:function(e,t,o){var r=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{}),o="boolean"==typeof o&&o;return r[e]&&r[e].done(t,o)!==!1&&(r[e]=null,delete r[e]),!1},isIn:function(e,t){var o=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!!o[e]&&o[e].isIn(t)},isDone:function(e,t){var o=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!!o[e]&&o[e].isDone(t)},isReady:function(e){var t=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!t[e]||t[e].isReady()}}},r={DOM:{add:function(){return"function"==typeof window.addEventListener?function(e,t,n){var o=t instanceof Array?t:[t];Array.prototype.forEach.call(o,function(t){e.addEventListener(t,n,!1)})}:"function"==typeof document.attachEvent?function(e,t,n){var o=t instanceof Array?t:[t];Array.prototype.forEach.call(o,function(t){e.attachEvent("on"+t,n)})}:function(e,t,n){var o=t instanceof Array?t:[t];Array.prototype.forEach.call(o,function(t){e["on"+t]=n})}}(),remove:function(){return"function"==typeof window.removeEventListener?function(e,t,n){e.removeEventListener(t,n,!1)}:"function"==typeof document.detachEvent?function(e,t,n){e.detachEvent("on"+t,n)}:function(e,t,n){e["on"+t]=null}}()},core:{storage:{},listen:function(e,t,n,o,l){var e=e||null,t=t||null,n=n||null,o=o||y.id(),l="boolean"==typeof l&&l,a=null,i=r.core;return null!==e&&null!==t&&null!==n&&((l===!1||null!==i.get(e,t))&&(a=i.register(e,t),a[o]=n,o))},remove:function(e,t,n){var e=e||null,t=t||null,n=n||null,o=null,l=r.core.storage,a=r.core;return null!==e&&null!==t&&null!==n&&(o=a.register(e,t),n in o)&&(o[n]=null,delete o[n],0===Object.keys(o).length&&(l[e][t]=null,delete l[e][t],0===Object.keys(l[e]).length&&(l[e]=null,delete l[e])),!0)},register:function(e,t){var n=r.core.storage;return e in n||(n[e]={}),t in n[e]||(n[e][t]={}),n[e][t]},get:function(e,t){var n=r.core.storage;return e in n&&t in n[e]?n[e][t]:null},fire:function(e,t,n){var o=r.core.get(e,t);if(null!==o)for(var l in o)try{o[l](n)}catch(e){}}}},E={handle:function(e,t,n,o,r){function l(){return null===t?e.call(o):"number"==typeof t.length&&"object"==typeof t?e.apply(o,t):e.call(o,t)}var e=e||null,t=t||null,n=n||null,o=o||null,r=r||!1;if(null!==e){if(!r)return l();try{return l()}catch(e){return v.log("Initializer runFunction method catch error: \r\n"+v.parseError(e)+"\r\n Call point: "+n,v.types.WARNING),null}}return null},localStorage:{get:function(e,t,n){var o=null,t="boolean"==typeof t&&t,n="string"==typeof n?n:"";try{return o=window.localStorage.getItem(n+e),"string"!=typeof o&&(o=null),t!==!1&&(o=E.convertor.BASE64.decode(o),o=E.convertor.UTF8.decode(o)),o}catch(e){return null}},set:function(e,t,n,o){var r=t,n="boolean"==typeof n&&n,o="string"==typeof o?o:"";try{return window.localStorage.removeItem(o+e),n!==!1&&(r="string"!=typeof t?JSON.stringify(t):r,r=E.convertor.UTF8.encode(r),r=E.convertor.BASE64.encode(r)),window.localStorage.setItem(o+e,r),!0}catch(t){return v.log("Error during saving data into localStorage. [key]:["+e+"]",v.types.WARNING),!1}},del:function(e,t){var t="string"==typeof t?t:"";try{return window.localStorage.removeItem(t+e),!0}catch(t){return v.log("Error during deleting data from localStorage. [key]:["+e+"]",v.types.WARNING),null}},getJSON:function(e,t){var n=E.localStorage.get(e,!0,t);if(null!==n)try{return n=JSON.parse(n)}catch(e){return null}return null},setJSON:function(e,t,n){return E.localStorage.set(e,JSON.stringify(t),!0,n)},reset:function(e){var e="string"==typeof e?e:"",t=[];try{if(null!==e){for(var n in window.localStorage)0===n.indexOf(e)&&t.push(n);t.forEach(function(e){window.localStorage.removeItem(e)})}else window.localStorage.clear();return!0}catch(e){return!1}},isAvailable:function(){var e=y.id(),t=!1;return E.localStorage.set(e,e),t=E.localStorage.get(e)===e,E.localStorage.del(e),t}},resources:{settings:{RESOURCES_MARK_ATTR:{name:"data-flex-connect-mark",value:"dynamically"},CSS_TIMER_PROPERTY:"flex_css_load_event_timer",CSS_TIMER_DURATION:5e3},css:{settings:{URLS:[{reg:/url\('([^\)'].*?)'\)/gi,left:/url\('/gi,right:/'\)/gi,_left:'url("',_right:'")'},{reg:/url\("([^\)"].*?)"\)/gi,left:/url\("/gi,right:/"\)/gi,_left:'url("',_right:'")'}],attr:{SRC:"data-flex-src"}},connect:function(e,t,n){function o(e){var t=E.resources.settings,n=document.createElement("LINK");return n.type="text/css",n.href=e,n.rel="stylesheet",n.setAttribute(t.RESOURCES_MARK_ATTR.name,t.RESOURCES_MARK_ATTR.value),{link:n,append:function(){document.head.appendChild(n)}}}function l(e,t,n){function o(e,t){clearTimeout(e[l.CSS_TIMER_PROPERTY]),e[l.CSS_TIMER_PROPERTY]=null,delete e[l.CSS_TIMER_PROPERTY]}var l=E.resources.settings;e[l.CSS_TIMER_PROPERTY]=setTimeout(function(){if(void 0!==e[l.CSS_TIMER_PROPERTY]){var a=document.createElement("IMG");o(e,l),r.DOM.add(a,["load","error"],function(e){E.handle(n,t,"system.resources.css.connect",this)}),a.src=t}},l.CSS_TIMER_DURATION),r.DOM.add(e,"load",function(r){void 0!==e[l.CSS_TIMER_PROPERTY]&&(o(e,l),E.handle(n,t,"system.resources.css.connect",this))})}function a(e){document.styleSheets;try{Array.prototype.forEach.call(document.styleSheets,function(t){if(t.href.indexOf(e)!==-1)throw"found"})}catch(e){if("found"===e)return!0}return!1}var i=null,t=t||null,n=n||null,e=e||null;return null!==e&&a(e)===!1&&(i=o(e),r.DOM.add(i.link,"error",function(t){v.log("During loading CSS resource ["+e+"] was error",v.types.WARNING)}),null!==n&&r.DOM.add(i.link,"error",n),null!==t?l(i.link,e,t):E.handle(t,null,"system.resources.css.connect",this),i.append(),!0)},adoption:function(e,t,n){var t=null!==t&&"object"==typeof t&&void 0!==t.body?t:document,o=t.createElement("style"),n="string"==typeof n?n:null;if("string"==typeof e)try{return null!==n&&(e=E.resources.css.correctPaths(e,n),o.setAttribute(E.resources.css.settings.attr.SRC,n)),o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),t.head.appendChild(o),o}catch(t){return v.log("Error during adoption of CSS resource: url = ["+n+"], cssText starts from ["+e.substr(0,50)+" (...)]",v.types.CRITICAL),null}return null},correctPaths:function(t,n){function o(e,t){var n=null;return 0!==e.trim().toLowerCase().indexOf("data:")?(n=E.url.parse(e,t),null!==n?n.url:e):e}return e.defaults.settings.CHECK_PATHS_IN_CSS!==!1&&"string"==typeof n&&""!==n&&E.resources.css.settings.URLS.forEach(function(e){var r=t.match(e.reg);r instanceof Array&&r.forEach(function(r){var l=r;l=l.replace(e.left,""),l=l.replace(e.right,""),l=o(l,n),null!==l&&(t=t.replace(r,e._left+l+e._right))})}),t}},js:{connect:function(e,t,n){function o(e){var t=E.resources.settings,n=document.createElement("SCRIPT");return n.type="application/javascript",n.src=e,n.setAttribute(t.RESOURCES_MARK_ATTR.name,t.RESOURCES_MARK_ATTR.value),{script:n,append:function(){document.head.appendChild(n)}}}var l=null,t=t||null,n=n||null,e=e||null;return null!==e&&(l=o(e),null!==t&&r.DOM.add(l.script,"load",t),null!==n&&r.DOM.add(l.script,"error",n),l.append(),l.script)},adoption:function(e,t){var n=document.createElement("SCRIPT"),t=t||null,e=e||null;null!==e&&(n.type="application/javascript",n.appendChild(document.createTextNode(e)),document.body.insertBefore(n,document.body.childNodes[0]),null!==t&&E.handle(t,null,"system.resources.js.adoption",this))},getCurrentSRC:function(e){var t=null,e="boolean"==typeof e&&e;try{throw new Error("Script URL detection")}catch(o){return"string"==typeof o.stack&&(t=o.stack.match(n.regs.urls.JS_URL),t instanceof Array&&t.length>0)?e?t[t.length-1]:t[t.length-1].indexOf(n.files.CORE_URL)===-1?t[t.length-1]:null:null}}}},convertor:{UTF8:{encode:function(e){return unescape(encodeURIComponent(e))},decode:function(e){return decodeURIComponent(escape(e))}},BASE64:{decode:function(e){var t,n,o,r,l,a,i={},s=[],u="",c=String.fromCharCode,f=[[65,91],[97,123],[48,58],[43,44],[47,48]],d=0,h=0,p=0;for(n in f)for(t=f[n][0];t<f[n][1];t++)s.push(c(t));for(t=0;t<64;t++)i[s[t]]=t;if(e.length<100);for(t=0;t<e.length;t+=72)for(p=e.substring(t,t+72),r=0;r<p.length;r++)for(o=i[p.charAt(r)],d=(d<<6)+o,h+=6;h>=8;)l=c((d>>>(h-=8))%256),a=l.charCodeAt(0),u=0!==a?u+l:u;return u},encode:function(e){var t,n,o,r,l,a,i,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,d=0,h="",p=[];if(!e)return e;do t=e.charCodeAt(f++),n=e.charCodeAt(f++),o=e.charCodeAt(f++),u=t<<16|n<<8|o,r=u>>18&63,l=u>>12&63,a=u>>6&63,i=63&u,p[d++]=c.charAt(r)+c.charAt(l)+c.charAt(a)+c.charAt(i);while(f<e.length);return h=p.join(""),s=e.length%3,(s?h.slice(0,s-3):h)+"===".slice(s||3)}}},url:{settings:{parser:{LAST:/([^\/]*)$/gi,CORRECTION:/[\/\\]$/gi,BAD_SLASH:/\\/gi,PROTOCOL:/:\/\//gi,DOUBLE:/\/{2,}/gi}},getURLInfo:function(e){var t=document.createElement("a"),n=null;return"string"==typeof e&&(t.setAttribute("href",e),n={hostname:t.hostname,host:t.host,port:t.port,protocol:t.protocol,isFull:!1},""!==n.hostname?n.isFull=0===e.indexOf(n.protocol+"//"+n.hostname):n.isFull=!1),n},getCurrentDomain:function(){var e=null;return e=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host},getParams:function(e){var t=null,n=null;return e=e.split("?"),t=2===e.length?e[1]:null,e=e[0],null!==t&&(n=t.split("&"),t={},n.forEach(function(e){var n=e.split("=");2===n.length&&(t[n[0]]=n[1])})),{url:e,params:t}},restoreFullURL:function(e){var t=e;return"string"==typeof e?(t=E.url.getURLInfo(t),t.isFull===!1?""===t.hostname?E.url.getCurrentDomain()+(0!==e.indexOf("/")?"/":"")+e:t.protocol+"//"+t.host+(0!==e.indexOf("/")?"/":"")+e:e):null},parse:function(e,t){function n(e){var t=0,n=!0,o=-1,r="";return e.split("/").forEach(function(e,l){".."===e?(t+=1,o!==-1&&o!==l-1&&(n=!1),o=l):r+="/"+e}),n===!0&&{count:t,url:r}}function o(e){return e=e.replace(E.url.settings.parser.CORRECTION,""),e=e.replace(E.url.settings.parser.BAD_SLASH,"/")}var r=null,l=null,t="string"==typeof t?t:null,a=0,i=null,s=null;if("string"==typeof e&&(e=o(e),s=E.url.getParams(e),e=s.url,s=s.params,l=E.url.getURLInfo(e),null!==l&&(a=n(e),a!==!1)))if(a.count>0){if(null!==t&&(i=E.url.parse(t),null!==i&&a.count<i.parts.length-1))return i.parts.splice(i.parts.length-a.count,a.count),i.parts=i.parts.map(function(e){return"//"===e?"":e}),e=i.parts.join("/")+a.url,E.url.parse(e)}else{if(l.isFull!==!1)return r={target:e.match(E.url.settings.parser.LAST),_path:"",_url:e,_hostname:l.hostname,hostname:""!==l.hostname?l.hostname:window.location.hostname,_host:l.host,host:""!==l.host?l.host:window.location.host,_port:l.port,port:""!==l.port?l.port:window.location.port,_protocol:l.protocol,protocol:":"!==l.protocol?l.protocol:window.location.protocol,home:""===l.hostname?window.location.protocol+"//"+window.location.host:l.protocol+"//"+l.host,_home:""!==l.hostname?l.protocol+"//"+l.host:"",params:s,dirs:null,parts:null},r.target instanceof Array&&r.target.length>0?(r.target=r.target[0],r.target.indexOf(".")===-1&&(r.target=""),r._path=e.replace(r.target,"")):r.target="",""===r._home?(r.path=r.home+(0===r._path.indexOf("/")?"":"/")+r._path,r.url=r.home+(0===r._url.indexOf("/")?"":"/")+r._url):(r.path=r._path,r.url=r._url),r.parts=r.url.split("/").map(function(e){return""===e?"//":e}),r.parts.indexOf(r.target)!==-1&&r.parts.splice(r.parts.indexOf(r.target),1),r.dirs=r.path.replace(r.home,"").split("/"),r.dirs=r.dirs.filter(function(e){return""!==e}),r;if(t=null===t?E.url.getCurrentDomain():t,i=E.url.parse(t),null!==i)return 0===e.indexOf("~/")?e=e.replace("~",i.home):(i.parts=i.parts.map(function(e){return"//"===e?"":e}),e=i.parts.join("/")+(0!==e.indexOf("/")?"/":"")+e),E.url.parse(e)}return null},sterilize:function(e){var t=y.id();return e.replace(E.url.settings.parser.PROTOCOL,t).replace(E.url.settings.parser.BAD_SLASH,"/").replace(E.url.settings.parser.DOUBLE,"/").replace(t,"://")},getTypeOfResource:function(e){var t=e.replace(n.regs.urls.PARAMS,"");return t=t.match(n.regs.urls.EXTENSION),t instanceof Array&&1===t.length?t[0].toLowerCase():null},is:{clear:function(e){return"string"==typeof e?(e=e.split("?"),e=e[0],e=e.replace(n.regs.urls.NOT_URL_SYMBOLS,"")):null},js:function(e){return e=E.url.is.clear(e),null!==e&&(n.regs.urls.JS_EXP_IN_URL.lastIndex=0,n.regs.urls.JS_EXP_IN_URL.test(e))},css:function(e){return e=E.url.is.clear(e),null!==e&&(n.regs.urls.CSS_EXP_IN_URL.lastIndex=0,n.regs.urls.CSS_EXP_IN_URL.test(e))}}}},y={id:function(){var e=0;return function(t){return e+=1,(t||"")+(new Date).valueOf()+"_"+e}}()},v={types:{CRITICAL:"CRITICAL",LOGICAL:"LOGICAL",WARNING:"WARNING",NOTIFICATION:"NOTIFICATION",LOGS:"LOG",KERNEL_LOGS:"KERNEL_LOGS"},rendering:{CRITICAL:"color: #FF0000;font-weight:bold;",LOGICAL:"color: #00FFF7;font-weight:bold;",WARNING:"color: #A69600;font-weight:bold;",NOTIFICATION:"color: #988DFF;font-weight:bold;",LOGS:"color: #6C6C6C;",KERNEL_LOGS:"color: #008B0E;font-weight:bold;"},parseError:function(e){var t=e.name+": "+e.message+"\r\n--------------------------------------------";for(var n in e)"name"!==n&&"message"!==n&&(t=t+"\r\n  "+n+"="+e[n]);return t},log:function(t,n){var n=n||"LOGS";console&&v.types[n]&&void 0!==console.log&&e.defaults.logs.SHOW.indexOf(n)!==-1&&(console.log("%c ["+n+"]%c"+t,v.rendering[n],v.rendering.LOGS),v.callEvent(t,n))},callEvent:function(e,t){null!==l.namespace.get("flex.registry.events.system.logs")&&void 0!==flex.registry.events.system.logs[t]&&r.core.fire(flex.registry.events.system.logs.GROUP,flex.registry.events.system.logs[t],e)}},O={callers:{node:function(){var e={};return function(t,n,o){var r=null,n="boolean"==typeof n&&n;return"string"==typeof t?(n&&e[t]&&null!==e[t]&&(r=e[t]),r=null!==r?r:(o||document).querySelector(t),n&&!e[t]&&null!==r&&(e[t]=r),new O.constructors.node(r)):void 0===t||"string"!=typeof t.nodeName&&t!=window?null:new O.constructors.node(t)}}(),nodes:function(){var e={};return function(t,n,o){var r=null,n="boolean"==typeof n&&n;if("string"==typeof t)return n&&e[t]&&null!==e[t]&&e[t].length>0&&(r=e[t]),r=null!==r?r:(o||document).querySelectorAll(t),n&&!e[t]&&null!==r&&r.length>0&&(e[t]=r),new O.constructors.nodes(r);if(void 0!==t&&"number"==typeof t.length&&t.length>0){
if("string"==typeof t[0])return r=[],Array.prototype.forEach.call(t,function(e,t){var n=(o||document).querySelector(e);null!==n&&r.push(n)}),new O.constructors.nodes(r);if("string"==typeof t[0].nodeName)return new O.constructors.nodes(t)}return null}}(),array:function(e){return e instanceof Array?new O.constructors.array(e):null},string:function(e){return"string"==typeof e?new O.constructors.string(e):null},boolean:function(e){return"boolean"==typeof e?new O.constructors.boolean(e):null},object:function(e){return"object"==typeof e?new O.constructors.object(e):null}},prototypes:{node:{},nodes:{},array:{},string:{},boolean:{},object:{},update:{update:function(e){function t(e){var n=null;for(var o in e)if(e.hasOwnProperty(o))if("object"==typeof e[o]&&"target"!==o){n=function(){return n.target=this.target,n};for(var r in e[o])n[r]=e[o][r];e[o]=n}else"function"==typeof e[o]&&t(e[o])}O.prototypes[e]&&t(O.prototypes[e])},node:function(){O.prototypes.update.update("node")},nodes:function(){O.prototypes.update.update("nodes")},array:function(){O.prototypes.update.update("array")},string:function(){O.prototypes.update.update("string")},boolean:function(){O.prototypes.update.update("boolean")},object:function(){O.prototypes.update.update("object")}},add:{add:function(e,t,n){var o=null,r=null;"string"==typeof e&&"string"==typeof t&&void 0!==n&&O.prototypes[e]&&(o=t.split("."),r=O.prototypes[e],o.forEach(function(e,t){void 0===r[e]?t===o.length-1?r[e]=n:(r[e]={},r=r[e]):"object"==typeof r[e]||"function"==typeof r[e]?r=r[e]:(r[e]={},r=r[e])}),O.prototypes.update[e]())},node:function(e,t){O.prototypes.add.add("node",e,t)},nodes:function(e,t){O.prototypes.add.add("nodes",e,t)},array:function(e,t){O.prototypes.add.add("array",e,t)},string:function(e,t){O.prototypes.add.add("string",e,t)},boolean:function(e,t){O.prototypes.add.add("boolean",e,t)},object:function(e,t){O.prototypes.add.add("object",e,t)}}},constructors:{node:function(e){this.target=e},nodes:function(e){this.target=e},array:function(e){this.target=e},string:function(e){this.target=e},boolean:function(e){this.target=e},object:function(e){this.target=e}},build:function(){for(var e in O.constructors)O.constructors[e].prototype=O.prototypes[e];return!0}},i={execution:function(){return"function"==typeof window[e.defaults.patterns.TEST_FUNCTION]&&(E.handle(window[e.defaults.patterns.TEST_FUNCTION],null,e.defaults.patterns.TEST_FUNCTION,this),!0)},modification:function(){function t(t,n){t[n]instanceof Array&&e.defaults.resources.MODULES instanceof Array&&t[n].forEach(function(t){if("string"==typeof t)switch(n){case"include":e.defaults.resources.MODULES.indexOf(t)===-1&&e.defaults.resources.MODULES.push(t);break;case"exclude":e.defaults.resources.MODULES.indexOf(t)!==-1&&e.defaults.resources.MODULES.splice(e.defaults.resources.MODULES.indexOf(t),1)}})}var n=window[e.defaults.patterns.TEST_FUNCTION];"function"==typeof n&&(t(n,"include"),t(n,"exclude"))}},s={init:e.init,oop:{objects:{copy:l.objects.copy,extend:l.objects.extend,forEach:l.objects.forEach,validate:l.objects.validate,isValueIn:l.objects.isValueIn},classes:{of:l.classes.of,create:l.classes.create},namespace:{create:l.namespace.create,get:l.namespace.get}},modules:{attach:f.attach.safely,append:f.attach.unexpected.safely},unique:y.id,events:{DOM:{add:r.DOM.add,remove:r.DOM.remove},core:{fire:r.core.fire,listen:r.core.listen,register:r.core.register,remove:r.core.remove}},overhead:{globaly:{set:p.globaly.set,get:p.globaly.get,del:p.globaly.remove},objecty:{set:p.objecty.set,get:p.objecty.get,del:p.objecty.remove},register:{open:p.register.open,add:p.register.add,done:p.register.done}},ajax:{send:o.create,methods:{POST:o.settings.methods.POST,GET:o.settings.methods.GET,PUT:o.settings.methods.PUT,DELETE:o.settings.methods.DELETE,OPTIONS:o.settings.methods.OPTIONS}},logs:{parseError:v.parseError,log:v.log,types:v.types},callers:{node:O.callers.node,nodes:O.callers.nodes,array:O.callers.array,object:O.callers.object,string:O.callers.string,boolean:O.callers.boolean,define:{node:O.prototypes.add.node,nodes:O.prototypes.add.nodes,array:O.prototypes.add.array,object:O.prototypes.add.object,string:O.prototypes.add.string,boolean:O.prototypes.add.boolean}},resources:{parse:{css:{stringify:g.css.stringify}},attach:{css:{connect:E.resources.css.connect,adoption:E.resources.css.adoption},js:{connect:E.resources.js.connect,adoption:E.resources.js.adoption,getCurrentSRC:E.resources.js.getCurrentSRC}}},system:{handle:E.handle,convertor:{UTF8:{encode:E.convertor.UTF8.encode,decode:E.convertor.UTF8.decode},BASE64:{encode:E.convertor.BASE64.encode,decode:E.convertor.BASE64.decode}},url:{parse:E.url.parse,restore:E.url.restoreFullURL}},localStorage:{add:E.localStorage.set,get:E.localStorage.get,del:E.localStorage.del,addJSON:E.localStorage.setJSON,getJSON:E.localStorage.getJSON,reset:E.localStorage.reset},hashes:{get:u.get,update:u.update.add},config:{get:e.get,set:e.set}},n.files.detect(),e.init(),r.core.listen("modules.registry","ready",f.attach.queue.proceed),O.build(),l.wrappers.objects(),a.wrappers.array(),{init:s.init,oop:{objects:{copy:s.oop.objects.copy,extend:s.oop.objects.extend,forEach:s.oop.objects.forEach,validate:s.oop.objects.validate,isValueIn:s.oop.objects.isValueIn},classes:{of:s.oop.classes.of,create:s.oop.classes.create},namespace:{create:s.oop.namespace.create,get:s.oop.namespace.get}},modules:{attach:s.modules.attach,append:s.modules.append},unique:s.unique,events:{DOM:{add:s.events.DOM.add,remove:s.events.DOM.remove},core:{fire:s.events.core.fire,listen:s.events.core.listen,register:s.events.core.register,remove:s.events.core.remove}},overhead:{globaly:{set:s.overhead.globaly.set,get:s.overhead.globaly.get,del:s.overhead.globaly.del},objecty:{set:s.overhead.objecty.set,get:s.overhead.objecty.get,del:s.overhead.objecty.del},register:{open:s.overhead.register.open,add:s.overhead.register.add,done:s.overhead.register.done}},ajax:{send:s.ajax.send,methods:s.ajax.methods},resources:{parse:{css:{stringify:s.resources.parse.css.stringify}},attach:{css:{connect:s.resources.attach.css.connect,adoption:s.resources.attach.css.adoption},js:{connect:s.resources.attach.js.connect,adoption:s.resources.attach.js.adoption,getCurrentSRC:s.resources.attach.js.getCurrentSRC}}},localStorage:{add:s.localStorage.add,get:s.localStorage.get,del:s.localStorage.del,addJSON:s.localStorage.addJSON,getJSON:s.localStorage.getJSON,reset:s.localStorage.reset},system:{handle:s.system.handle,convertor:{UTF8:{encode:s.system.convertor.UTF8.encode,decode:s.system.convertor.UTF8.decode},BASE64:{encode:s.system.convertor.BASE64.encode,decode:s.system.convertor.BASE64.decode}},url:{parse:s.system.url.parse,restore:s.system.url.restore}},logs:{parseError:s.logs.parseError,log:s.logs.log,types:s.logs.types},hashes:{get:s.hashes.get,update:s.hashes.update},callers:{node:s.callers.node,nodes:s.callers.nodes,array:s.callers.array,object:s.callers.object,string:s.callers.string,boolean:s.callers.boolean,define:{node:s.callers.define.node,nodes:s.callers.define.nodes,array:s.callers.define.array,object:s.callers.define.object,string:s.callers.define.string,boolean:s.callers.define.boolean}},config:{get:s.config.get,set:s.config.set},libraries:{},libraries_data:{},registry:{}}}(),window.flex=new e,flex.registry.events={system:{logs:{GROUP:"flex.system.logs.messages",CRITICAL:"critical",LOGICAL:"logical",WARNING:"warning",NOTIFICATION:"notification",LOGS:"log",KERNEL_LOGS:"kernel_logs"},cache:{GROUP:"flex.system.cache.events",ON_NEW_MODULE:"ON_NEW_MODULE",ON_UPDATED_MODULE:"ON_UPDATED_MODULE",ON_NEW_RESOURCE:"ON_NEW_RESOURCE",ON_UPDATED_RESOURCE:"ON_UPDATED_RESOURCE"}}},window._node=flex.callers.node,window._nodes=flex.callers.nodes,window._array=flex.callers.array,window._object=flex.callers.object,window._string=flex.callers.string,window._boolean=flex.callers.boolean,window._append=flex.modules.append}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,o=null,r=null,l=null,a=null,i=null,s=null;return a={objects:{STORAGE_PROPERTY:"flex.object.bind.storage",HANDLE_ID_PROPERTY:"flex.object.bind.handle.id"},attrs:{STORAGE_PROPERTY:"flex.attrs.bind.storage",NODE_ID_PROPERTY:"flex.attrs.bind.node.id",HANDLE_ID_PROPERTY:"flex.attrs.bind.handle.id"},props:{STORAGE_PROPERTY:"flex.props.bind.storage",NODE_ID_PROPERTY:"flex.props.bind.node.id",HANDLE_ID_PROPERTY:"flex.props.bind.handle.id"}},i={objects:{INCORRECT_ARGUMENTS:"defined incorrect arguments or not defined at all",PROPERTY_IS_CONST:"cannot kill bind with property, because property now is constant"},support:{DEFINE_PROPERTY:"flex.binds: Current browser does not support Object.defineProperty",MUTATION_SCANNING:"flex.attrs: Current browser does not support any avaliable way to scanning mutation of attributes"}},e={storage:{create:function(e){var t=function(e){this.parent=e,this.binds={}};return t.prototype={make:function(e,t){var n=this;return!this.binds[e]&&(this.binds[e]={current:t,previous:t,setter:function(t){n.binds[e].previous=n.binds[e].current,n.binds[e].current=t;for(var o in n.binds[e].handles)n.binds[e].handles[o].call(n.parent,n.binds[e].current,n.binds[e].previous,o)},getter:function(){return n.binds[e].current},handles:{}},!0)},add:function(e,t){var n=flex.unique();return t[a.objects.HANDLE_ID_PROPERTY]=n,this.binds[e].handles[n]=t,n},remove:function(e,t){return this.binds[e]&&this.binds[e].handles[t]&&(delete this.binds[e].handles[t],0===Object.keys(this.binds[e].handles).length)?delete this.binds[e]:null},kill:function(e){return this.binds[e]?delete this.binds[e]:null},isPropertyReady:function(e){return void 0!==this.binds[e]},destroy:function(){return 0===Object.keys(this.binds).length&&delete this.parent[a.objects.STORAGE_PROPERTY]},setter:function(e){return this.binds[e].setter},getter:function(e){return this.binds[e].getter}},new t(e)}},bind:function(t,n,o){var r=a.objects.STORAGE_PROPERTY,l=null;if(Object.defineProperty){if("object"==typeof t&&"string"==typeof n&&"function"==typeof o){if(l=t[n],t[r]||(t[r]=e.storage.create(t)),r=t[r],!r.isPropertyReady(n)){if(!delete t[n])return r.destroy(),!1;r.make(n,l),Object.defineProperty(t,n,{get:r.getter(n),set:r.setter(n),configurable:!0})}return r.add(n,o)}throw"object.bind::"+i.objects.INCORRECT_ARGUMENTS}},unbind:function(e,t,n){var o=a.objects.STORAGE_PROPERTY,r=null;if("object"==typeof e&&"string"==typeof t&&"string"==typeof n){if(e[o]&&(o=e[o],o.isPropertyReady(t)&&(r=e[t],o.remove(t,n),!o.isPropertyReady(t))))try{return delete e[t],e[t]=r,!0}catch(e){throw"object.unbind::"+i.objects.PROPERTY_IS_CONST}return null}throw"object.unbind::"+i.objects.INCORRECT_ARGUMENTS},kill:function(e,t){var n=a.objects.STORAGE_PROPERTY,o=null;if("object"==typeof e&&"string"==typeof t){if(e[n]){o=e[t],n=e[n];try{return!!n.kill(t)&&(delete e[t],e[t]=o,!0)}catch(e){throw"object.kill::"+i.objects.PROPERTY_IS_CONST}}return null}throw"object.kill::"+i.objects.INCORRECT_ARGUMENTS}},t={storage:{create:function(e){var t=function(e){this.node=e,this.binds={},this._destroy=null};return t.prototype={init:function(){this._destroy=o.attach(this.node,this.handle,this,{attributes:!0,childList:!1,subtree:!0,characterData:!0,attributeOldValue:!1,characterDataOldValue:!1})},handle:function(e,t){var n=this,o=null,r=t.target,l=void 0!==r[a.attrs.NODE_ID_PROPERTY]?r[a.attrs.NODE_ID_PROPERTY]:null;null!==l&&void 0!==this.binds[l]&&void 0!==this.binds[l][e]&&(o=r.getAttribute(e),o!==this.binds[l][e].current&&(this.binds[l][e].previous=this.binds[l][e].current,this.binds[l][e].current=o,_object(this.binds[l][e].handles).forEach(function(o,a){a.call(r,e,n.binds[l][e].current,n.binds[l][e].previous,t,o)})))},make:function(e,t){var n=this.setID(e);this.binds[n]=void 0===this.binds[n]?{}:this.binds[n],this.binds[n][t]=void 0===this.binds[n][t]?{handles:{},previous:null,current:e.getAttribute(t)}:this.binds[n][t]},add:function(e,t,n){var o=e[a.attrs.NODE_ID_PROPERTY],r=flex.unique();return n[a.attrs.HANDLE_ID_PROPERTY]=r,this.binds[o][t].handles[r]=n,r},remove:function(e,t,n){var o=null,r=e[a.attrs.NODE_ID_PROPERTY];return void 0!==this.binds[r]&&void 0!==this.binds[r][t]&&void 0!==this.binds[r][t].handles[n]&&(delete this.binds[r][t].handles[n],0===Object.keys(this.binds[r][t].handles).length)?(o=delete this.binds[r][t],0===Object.keys(this.binds[r]).length&&(o=delete this.binds[r],this.destroy()),o):o},kill:function(e,t){var n=null,o=e[a.attrs.NODE_ID_PROPERTY];return void 0!==this.binds[o]&&void 0!==this.binds[o][t]?(n=delete this.binds[o][t],0===Object.keys(this.binds[o]).length&&(n=delete this.binds[o],this.destroy()),n):n},setID:function(e){return void 0===e[a.attrs.NODE_ID_PROPERTY]&&(e[a.attrs.NODE_ID_PROPERTY]=flex.unique()),e[a.attrs.NODE_ID_PROPERTY]},destroy:function(){return 0===Object.keys(this.binds).length&&(this._destroy(),delete this.node[a.attrs.STORAGE_PROPERTY])}},new t(e)}},bind:function(e,n,r,l){var s=a.attrs.STORAGE_PROPERTY,l=void 0!==l?l:e;if(null!==o.attach){if(void 0!==e&&"string"==typeof n&&"function"==typeof r&&e.nodeName)return l[s]||(l[s]=t.storage.create(l),l[s].init()),s=l[s],s.make(e,n),s.add(e,n,r);throw"attrs.bind::"+i.objects.INCORRECT_ARGUMENTS}},unbind:function(e,t,n,o){var r=a.attrs.STORAGE_PROPERTY,o=void 0!==o?o:e;if("object"==typeof e&&"string"==typeof t&&"string"==typeof n)return o[r]?(r=o[r],r.remove(e,t,n)):null;throw"attrs.unbind::"+i.objects.INCORRECT_ARGUMENTS},kill:function(e,t,n){var o=a.attrs.STORAGE_PROPERTY,n=void 0!==n?n:e;if("object"==typeof e&&"string"==typeof t)return n[o]?(o=n[o],o.kill(e,t)):null;throw"attrs.unbind::"+i.objects.INCORRECT_ARGUMENTS}},n={storage:{create:function(e){var t=function(e){this.node=e,this.binds={},this._destroy=null};return t.prototype={init:function(){this._destroy=o.attach(this.node,this.handle,this,{attributes:!0,childList:!0,subtree:!0,characterData:!0,attributeOldValue:!1,characterDataOldValue:!1})},prop:function(e,t){var n=null;return t.split(".").forEach(function(t,o,r){void 0!==e[t]&&o<r.length-1?e=e[t]:void 0!==e[t]&&o===r.length-1&&(n={parent:e,name:t})}),n},handle:function(e,t){var n=t.target,o=void 0!==n[a.props.NODE_ID_PROPERTY]?n[a.props.NODE_ID_PROPERTY]:null;null!==o&&void 0!==this.binds[o]&&_object(this.binds[o]).forEach(function(e,n){var o=n.parent[e];o!==n.current&&(n.previous=n.current,n.current=o,_object(n.handles).forEach(function(o,r){r.call(n.parent,e,n.current,n.previous,t,o)}))})},make:function(e,t){var n=this.setID(e),t=this.prop(e,t);this.binds[n]=void 0===this.binds[n]?{}:this.binds[n],this.binds[n][t.name]=void 0===this.binds[n][t.name]?{handles:{},previous:null,current:t.parent[t.name],parent:t.parent}:this.binds[n][t.name]},add:function(e,t,n){var o=flex.unique(),r=void 0!==e[a.props.NODE_ID_PROPERTY]?e[a.props.NODE_ID_PROPERTY]:null,t=this.prop(e,t);return n[a.props.HANDLE_ID_PROPERTY]=o,this.binds[r][t.name].handles[o]=n,o},remove:function(e,t,n){var o=null,r=void 0!==e[a.props.NODE_ID_PROPERTY]?e[a.props.NODE_ID_PROPERTY]:null,t=this.prop(e,t);return null!==r&&void 0!==this.binds[r]&&void 0!==this.binds[r][t.name]&&this.binds[r][t.name].handles[n]&&(delete this.binds[r][t.name].handles[n],0===Object.keys(this.binds[r][t.name].handles).length&&(o=delete this.binds[r][t.name],0===Object.keys(this.binds[r]).length&&(o=delete this.binds[r],this.destroy()))),o},kill:function(e,t){var n=null,o=void 0!==e[a.props.NODE_ID_PROPERTY]?e[a.props.NODE_ID_PROPERTY]:null,t=this.prop(e,t);return null!==o&&void 0!==this.binds[o]&&void 0!==this.binds[o][t.name]&&(n=delete this.binds[o][t.name],0===Object.keys(this.binds[o]).length&&(n=delete this.binds[o],this.destroy())),n},setID:function(e){return void 0===e[a.props.NODE_ID_PROPERTY]&&(e[a.props.NODE_ID_PROPERTY]=flex.unique()),e[a.props.NODE_ID_PROPERTY]},destroy:function(){return 0===Object.keys(this.binds).length&&(this._destroy(),delete this.node[a.props.STORAGE_PROPERTY])}},new t(e)}},bind:function(e,t,r,l){function s(e,t){var n=!1;return t.split(".").forEach(function(t,o,r){void 0!==e[t]&&o<r.length-1?e=e[t]:void 0!==e[t]&&o===r.length-1&&(n=!0)}),n}var u=a.props.STORAGE_PROPERTY,l=void 0!==l?l:e;if(null!==o.attach){if(void 0!==e&&"string"==typeof t&&"function"==typeof r&&void 0!==e.nodeName&&s(e,t))return void 0===l[u]&&(l[u]=n.storage.create(l),l[u].init()),u=l[u],u.make(e,t),u.add(e,t,r);throw"props.bind::"+i.objects.INCORRECT_ARGUMENTS}},unbind:function(e,t,n,o){var r=a.props.STORAGE_PROPERTY,o=void 0!==o?o:e;if("object"==typeof e&&"string"==typeof t&&"string"==typeof n)return o[r]?(r=o[r],r.remove(e,t,n)):null;throw"props.unbind::"+i.objects.INCORRECT_ARGUMENTS},kill:function(e,t,n){var o=a.props.STORAGE_PROPERTY,n=void 0!==n?n:e;if("object"==typeof e&&"string"==typeof t)return n[o]?(o=n[o],o.kill(e,t)):null;throw"props.unbind::"+i.objects.INCORRECT_ARGUMENTS}},o={init:function(){o.attach=o.attach()},mutationObserver:function(e,t,n,o){var r=window.MutationObserver||window.WebKitMutationObserver,l=null;return l=new r(function(e){e.forEach(function(e){t.call(n,e.attributeName,e)})}),l.observe(e,o),function(){l.disconnect()}},DOMAttrModified:function(e,t,n){return flex.events.DOM.add(e,"DOMAttrModified",function(e){t.call(n,event.attrName,e)}),function(){}},onPropertyChange:function(e,t,n){return flex.events.DOM.add(e,"propertychange",function(e){t.call(n,event.attributeName,e)}),function(){}},attach:function(){function e(){var e=document.createElement("DIV"),t=!1;return flex.events.DOM.add(e,"DOMAttrModified",function(){t=!0}),e.setAttribute("id","test"),t}return window.MutationObserver||window.WebKitMutationObserver?o.mutationObserver:e()?o.DOMAttrModified:"onpropertychange"in document.body?o.onPropertyChange:null}},l={init:function(){flex.callers.define.object("binding.bind",function(t,n){return e.bind(this.target,t,n)}),flex.callers.define.object("binding.unbind",function(t,n){return e.unbind(this.target,t,n)}),flex.callers.define.object("binding.kill",function(t){return e.kill(this.target,t)}),flex.callers.define.node("bindingAttrs.bind",function(e,n,o){return t.bind(this.target,e,n,o)}),flex.callers.define.node("bindingAttrs.unbind",function(e,n,o){return t.unbind(this.target,e,n,o)}),flex.callers.define.node("bindingAttrs.kill",function(e,n){return t.kill(this.target,e,n)}),flex.callers.define.nodes("bindingAttrs.bind",function(e,n,o){var r=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){r.push(t.bind(l,e,n,o))}),r}),flex.callers.define.nodes("bindingAttrs.unbind",function(e,n,o){var r=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){r.push(t.unbind(l,e,n,o))}),r}),flex.callers.define.nodes("bindingAttrs.kill",function(e,n){var o=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(r){o.push(t.kill(r,e,n))}),o}),flex.callers.define.node("bindingProps.bind",function(e,t,o){return n.bind(this.target,e,t,o)}),flex.callers.define.node("bindingProps.unbind",function(e,t,o){return n.unbind(this.target,e,t,o)}),flex.callers.define.node("bindingProps.kill",function(e,t){return n.kill(this.target,e,t)}),flex.callers.define.nodes("bindingProps.bind",function(e,t,o){var r=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){r.push(n.bind(l,e,t,o))}),r}),flex.callers.define.nodes("bindingProps.unbind",function(e,t,o){var r=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){r.push(n.unbind(l,e,t,o))}),r}),flex.callers.define.nodes("bindingProps.kill",function(e,t){var o=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(r){o.push(n.kill(r,e,t))}),o})}},s={check:function(){if(!Object.defineProperty)throw i.support.DEFINE_PROPERTY;if(null===o.attach)throw i.support.MUTATION_SCANNING}},o.init(),l.init(),s.check(),r={},{}},flex.modules.attach({name:"binds",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,o=null;return t=function(){return null===e&&(e=function(){},e.prototype=function(){function e(e){function t(e){return e.element=void 0!==e.element?e.element:null,e.name="string"==typeof e.name?e.name:null,e.handle="function"==typeof e.handle?e.handle:null,e.id="string"==typeof e.id?e.id:flex.unique(),e.once="boolean"==typeof e.once&&e.once,e.touch="boolean"!=typeof e.touch||e.touch,e.safely="boolean"==typeof e.safely&&e.safely,a.has(e.name)===!1&&(e.touch=!1),e}var e=t(e),n=null;return null!==e.element&&null!==e.handle&&null!==e.name&&(n=i.get(e.element,!1),null!==n&&(n=l.buildCommonHandle(e.element,e.name,n,e.touch,e.safely),n instanceof Array))?(n.push(new u(e.id,e.handle,e.once,e.touch)),e.id):null}function t(e,t,n,o,r){var t=void 0!==t?t:l.fixEvent(),a=i.get(this,!0),s=null,u=flex.unique(),c=null,f=this,d=!1,h=t.type!==o?o:t.type,p=null;if(t&&e&&n&&null!==a&&(t=l.unificationEvent(t),a[h]&&(a=a[h],a.element_id===n))){s=a.handles;try{Array.prototype.forEach.call(s,function(e){if(e.interaction!==u){if(e.interaction=u,c=e.launch(f,t),d=d===!0||e.isRemoving()!==!1,c===!1)throw t.flex.stop(),flex.logs.log("Break event in DOM.fire; \n\r >event: "+t.type+"\n\r >handle_id"+e.id+"\n\r >element_id"+n,flex.logs.types.WARNING),"prevent"}else flex.logs.log("Unexpected behavior of handle event in DOM.fire. Attempt to call handle twice. \n\r >event: "+t.type+"\n\r >handle_id"+e.id+"\n\r >element_id"+n,flex.logs.types.LOGICAL)})}catch(e){"prevent"!==e&&(r?flex.logs.log("Unexpected error in DOM.fire; \n\r >event: "+t.type+"\n\r >element_id"+n,flex.logs.types.CRITICAL):p=e)}finally{d!==!1&&(a.handles=s.filter(function(e){return e.isWorking()!==!1||e.isRemoving()===!1}),0===a.handles.length&&(l.destroyCommonHandle(e,h),i.clear(e)))}if(null!==p)throw p;return!0}return!1}function n(e){function t(e){return void 0!==e[s.HANDLE_EVENT_ID_PROPERTY]?e[s.HANDLE_EVENT_ID_PROPERTY]:null}function n(e){return e.element=void 0!==e.element?e.element:null,e.name="string"==typeof e.name?e.name:null,e.handle="function"==typeof e.handle?e.handle:null,e.id="string"==typeof e.id?e.id:t(e.handle),e}var e=n(e),o=null,r=null;if(null!==e.element&&null!==e.name&&(null===e.id&&null!==e.handle&&void 0!==e.handle[s.HANDLE_EVENT_ID_PROPERTY]&&(e.id=e.handle[s.HANDLE_EVENT_ID_PROPERTY]),null!==e.id&&(o=i.get(e.element,!0),"object"==typeof o[e.name]))){o=o[e.name],r=o.handles;try{Array.prototype.forEach.call(r,function(t){if(t.id===e.id)throw t.toRemove(),"handle found"})}catch(t){"handle found"!==t&&flex.logs.log("Unexpected error in DOM.remove; \n\r >event: "+e.name+"\n\r >event_id"+e.id,flex.logs.types.CRITICAL)}finally{r=r.filter(function(e){return e.isWorking()!==!1||e.isRemoving()===!1}),0===r.length&&(l.destroyCommonHandle(e.element,e.name),i.clear(e.element))}}}function o(e,t,n){var o=null,n="boolean"==typeof n&&n;if(e&&t){if(o=i.get(e,!0),null!==o&&"object"==typeof o[t]){if(o=o[t],n!==!1)try{Array.prototype.forEach.call(o.handles,function(n){if(flex.logs.log("Event fired in DOM.clear.fire; \n\r>event: "+t+"\n\r>handle_id: "+n.id,flex.logs.types.NOTIFICATION),n.launch(e,null)===!1)throw"prevent"})}catch(e){"prevent"===e?flex.logs.log("Break event in DOM.clear.fire; \n\r >event: "+t,flex.logs.types.WARNING):flex.logs.log("Fatal error event in DOM.clear.fire; \n\r >event: "+t,flex.logs.types.WARNING)}return o.handles=[],l.destroyCommonHandle(e,t),i.clear(e),!0}return!1}return null}function r(e,t){function n(e,t){for(var n in t)e[n]=t[n];return e}var o=null,r=null,l=null,a={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},i={type:t,canBubble:!0,cancelable:!0,view:e.ownerDocument.defaultView,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,pointerX:0,pointerY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null},s=n(i,arguments[2]||{});for(var t in a)if(a[t].test(t)){r=t;break}if(!r)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");return document.createEvent?(o=document.createEvent(r),"HTMLEvents"==r?o.initEvent(t,s.bubbles,s.cancelable):o.initMouseEvent(s.type,s.canBubble,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget),e.dispatchEvent(o)):(s.clientX=s.pointerX,s.clientY=s.pointerY,l=document.createEventObject(),o=n(l,s),e.fireEvent("on"+t,o)),e}var l=null,a=null,i=null,s={STORAGE_NAME:"FlexEventsStorage",HANDLE_EVENT_ID_PROPERTY:"FlexEventIDProrerty"},u=null,c=null;return u=function(e,t,n,o,r){this.id=e,this.handle=t,this.once=n,this.touch=o,this.safely=r,this.remove=!1,this.interaction=null,this.working=!1,this.device=null},u.prototype={launch:function(e,t){var n=null;if(this.remove===!1&&this.isDouble(t)===!1){try{return this.working=!0,this.remove=this.once,this.handle.call(e,t)}catch(e){if(this.safely)return this.error(t,e),null;n=e}finally{this.working=!1,this.once===!0&&this.remove===!1&&flex.logs.log("Unexpected behavior DOM.fire. Flag [once] is true, but [remove] is false; \n\r >event id"+this.id,flex.logs.types.WARNING)}if(null!==n)throw n}return null},isWorking:function(){return this.working},isRemoving:function(){return this.remove},toRemove:function(){this.remove=!0},error:function(e,t){flex.logs.log("event: "+e.type+"; ID: "+this.id+"; generated error: \r\n"+flex.logs.parseError(t),flex.logs.types.WARNING)},isDouble:function(e){var t="";return t=e.flex.singleTouch?"touch":"mouse",this.device=null===this.device?t:this.device,this.device!==t}},i={get:function(e,t){var t="boolean"!=typeof t||t,n=null;return e?(n=flex.overhead.objecty.get(e,s.STORAGE_NAME),null===n&&t===!1&&(n=flex.overhead.objecty.set(e,s.STORAGE_NAME,{})),n):null},clear:function(e){var t=i.get(e,!0);return null!==t&&(0===Object.keys(t).length&&(flex.overhead.objecty.del(e,s.STORAGE_NAME),!0))}},l={buildCommonHandle:function(e,n,o,r,l){var i=flex.unique();if("object"!=typeof o[n]){if(o[n]={globalHandle:function(o){return t.call(e,e,o,i,n,l)},element_id:i,handles:[]},flex.events.DOM.add(e,n,o[n].globalHandle)===!1)return null;r!==!1&&a.has(n)!==!1&&flex.events.DOM.add(e,a.getType(n),o[n].globalHandle)}return o[n].handles},destroyCommonHandle:function(e,t){var n=null;return e&&t&&(n=i.get(e,!0),"object"==typeof n[t])?(flex.events.DOM.remove(e,t,n[t].globalHandle),a.has(t)!==!1&&flex.events.DOM.remove(e,a.getType(t),n[t].globalHandle),n[t]=null,delete n[t],!0):null},fixEvent:function(){return!event&&window.event?window.event:null},unificationEvent:function(e){function t(e){return e.flex={},e}function n(e,t){if(void 0!==t.clientX)if(void 0===t.pageX&&(e.flex.pageX=null,e.flex.pageY=null),null===t.pageX&&null!==t.clientX){var n=document.documentElement,o=document.body;e.flex.pageX=t.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n.clientLeft||0),e.flex.pageY=t.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n.clientTop||0)}else e.flex.pageX=t.pageX,e.flex.pageY=t.pageY;else e.flex.pageX=null,e.flex.pageY=null;return e.flex.clientX=void 0!==t.clientX?t.clientX:null,e.flex.clientY=void 0!==t.clientY?t.clientY:null,e.flex.offsetX=void 0!==t.offsetX?t.offsetX:void 0!==t.layerX?t.layerX:null,e.flex.offsetY=void 0!==t.offsetY?t.offsetY:void 0!==t.layerY?t.layerY:null,e}function o(e){return void 0===e.preventDefault&&(e.preventDefault=function(){try{this.returnValue=!1}catch(e){}}),void 0===e.stopPropagation&&(e.stopPropagation=function(){try{this.cancelBubble=!0}catch(e){}}),e.flex.stop=function(){return e.preventDefault(),e.stopPropagation(),!1},e}function r(e){return void 0===e.target&&(void 0!==e.srcElement?e.target=e.srcElement:e.target=null),null!==e.target&&void 0===e.relatedTarget&&(void 0!==e.fromElement?e.fromElement===e.target?e.relatedTarget=e.toElement:e.relatedTarget=e.fromElement:(e.relatedTarget=null,e.fromElement=null)),e.flex.target=e.target,e}function l(e){return n(e,e)}function a(e){return void 0===e.which&&void 0!==e.button&&(e.flex.which=1&e.button?1:2&e.button?3:4&e.button?2:0,e.flex.button=e.button),e}function i(e){return"object"==typeof e.touches&&(1===e.touches.length&&(e=n(e,e.touches[0]),e.flex.target=e.touches[0].target,e.flex.singleTouch=!0),e.flex.touches=e.touches),e}return void 0===e.flex&&(e=t(e),e=o(e),e=r(e),e=l(e),e=a(e),e=i(e)),e}},a={events:{click:{touch:"touchstart"},dblclick:{touch:"touchstart"},mousedown:{touch:"touchstart"},mouseenter:{touch:"touchenter"},mouseleave:{touch:"touchleave"},mousemove:{touch:"touchmove"},mouseover:{touch:""},mouseout:{touch:""},mouseup:{touch:"touchend"}},has:function(e){for(var t in a.events)if(t===e||"on"+t===e)return!0;return!1},getType:function(e){for(var t in a.events)if(t===e||"on"+t===e)return a.events[t].touch;return null},getOriginalType:function(e){e=e.toLowerCase();for(var t in a.events)if(a.events[t].touch===e)return t;return null}},c={_add:e,_remove:n,add:function(t,n,o,r,l,a){return e({element:t,name:n,handle:o,id:r,touch:l,safely:a})},remove:function(e,t,o,r){return n({element:e,name:t,handle:o,id:r})},call:r,clear:o,unify:l.unificationEvent},{add:c.add,remove:c.remove,clear:c.clear,call:c.call,unify:c.unify,extendedAdd:c._add,extendedRemove:c._remove}}(),e=new e),e},n={init:function(){flex.callers.define.node("events.add",function(e,n,o,r){return t().add(this.target,e,n,o,r)}),flex.callers.define.node("events.remove",function(e,n,o){return t().remove(this.target,e,n,o)}),flex.callers.define.node("events.call",function(e){return t().call(this.target,e)}),flex.callers.define.nodes("events.add",function(e,n,o,r){Array.prototype.forEach.call(this.target,function(l){t().add(l,e,n,o,r)})}),flex.callers.define.nodes("events.remove",function(e,n,o){Array.prototype.forEach.call(this.target,function(r){t().remove(r,e,n,o)})}),flex.callers.define.nodes("events.call",function(e){Array.prototype.forEach.call(this.target,function(n){t().call(n,e)})})}},n.init(),o={DOMEvents:t},{DOMEvents:o.DOMEvents}},flex.modules.attach({name:"events",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,o=null,r=null,l=null,a=null,i=null,s=null,u=null,c=null,f=null;return f={storage:{GROUP:"flex.html",SCROLL:"scroll",CUSTOM_STYLES:"custom.styles"},classes:{scroll:{MINIMAL_WIDTH:15,MINIMAL_HEIGHT:15}}},e={bySelector:function(){var e=function(){};return e.prototype=function(){function e(e,t){return"string"==typeof e?(t||document).querySelector(e):null}function t(e,t){return"string"==typeof e?(t||document).querySelectorAll(e):null}function n(e,t){var n=null;return"string"==typeof e?(n=r.get(e),null===n&&(n=r.add((t||document).querySelector(e))),n):null}function o(e,t){var n=null;return"string"==typeof e?(n=r.get(e),null===n&&(n=r.add((t||document).querySelectorAll(e))),n):null}var r=null,l=null;return r={data:{},get:function(e){var t=r.data;return void 0!==t[e]?t[e]:null},add:function(e,t){var n=r.data;return n[e]=t,t},remove:function(e){var t=r.data;t[e]=null,delete t[e]},reset:function(){r.data={}}},l={first:e,all:t,cachedFirst:n,cachedAll:o,cacheReset:r.reset,cacheRemove:r.remove},{first:l.first,all:l.all,cachedFirst:l.cachedFirst,cachedAll:l.cachedAll,cacheReset:l.cacheReset,cacheRemove:l.cacheRemove}}(),new e},fromParent:function(){var t=function(){this.selector=e.bySelector()};return t.prototype={selector:null,select:function(e,t,n){var o=flex.unique(),r=null,l="data-"+o;return"string"==typeof e.nodeName&&(e.setAttribute(l,o),r=this.selector[n===!1?"all":"first"](e.nodeName+"["+l+'="'+o+'"] '+t),e.removeAttribute(l)),r},first:function(e,t){return this.select(e,t,!0)},all:function(e,t){return this.select(e,t,!1)}},Object.freeze(new t)}},t=function(){var e=function(){};return e.prototype={childByAttr:function(e,t,n){var o=null,t=t.toLowerCase(),r=this;return void 0!==e.childNodes&&"number"==typeof e.childNodes.length&&Array.prototype.forEach.call(e.childNodes,function(e){if("string"==typeof e.nodeName&&(e.nodeName.toLowerCase()===t||"*"===t)&&"function"==typeof e.getAttribute)if(null!==n.value){if(e.getAttribute(n.name)===n.value)return e;
}else if(e.hasAttribute(n.name)===!0)return e;if(o=r.childByAttr(e,t,n),null!==o)return o}),null},childByType:function(e,t){var n=null,t=t.toLowerCase(),o=this;return void 0!==e.childNodes&&"number"==typeof e.childNodes.length&&(Array.prototype.forEach.call(e.childNodes,function(e){if("string"==typeof e.nodeName&&e.nodeName.toLowerCase()===t)return e}),Array.prototype.forEach.call(e.childNodes,function(e){if(n=o.childByType(e,t),null!==n)return n})),null},parentByAttr:function(e,t){return void 0!==e&&void 0!==t&&void 0!==e.parentNode&&null!==e.parentNode&&"function"==typeof e.parentNode.getAttribute?null!==t.value?e.parentNode.getAttribute(t.name)===t.value?e.parentNode:this.parentByAttr(e.parentNode,t):null!==e.parentNode.getAttribute(t.name)?e.parentNode:this.parentByAttr(e.parentNode,t):null}},new e},o=function(){var t=function(){};return t.prototype={nodeByClientRectSize:function(e){var t=0,n=0,o=null;return void 0!==e.getBoundingClientRect&&(o=e.getBoundingClientRect(),t=o.bottom-o.top,n=o.right-o.left),{height:t,width:n}},nodeByOffset:function(e){var t=0,n=0;return void 0!==e.offsetHeight&&(t=e.offsetHeight,n=e.offsetWidth),{height:t,width:n}},nodeWithMargin:function(t){var n,o,r,l,a,i,s,u,c=null,f=this.node(t);return"string"==typeof t&&(c=e.bySelector(),t=c.first(t),c=null),null!==t&&(n=parseInt(document.defaultView.getComputedStyle(t).marginTop,10),o=parseInt(document.defaultView.getComputedStyle(t).marginBottom,10),r=parseInt(document.defaultView.getComputedStyle(t).marginRight,10),l=parseInt(document.defaultView.getComputedStyle(t).marginLeft,10),a=parseInt(document.defaultView.getComputedStyle(t).borderTopWidth,10),i=parseInt(document.defaultView.getComputedStyle(t).borderBottomWidth,10),s=parseInt(document.defaultView.getComputedStyle(t).borderRightWidth,10),u=parseInt(document.defaultView.getComputedStyle(t).borderLeftWidth,10),null!==n&&NaN!==n||(n=0),null!==o&&NaN!==o||(o=0),null!==r&&NaN!==r||(r=0),null!==l&&NaN!==l||(l=0),null!==a&&NaN!==a||(a=0),null!==i&&NaN!==i||(i=0),null!==s&&NaN!==s||(s=0),null!==u&&NaN!==u||(u=0)),{height:f.height+n+o+a+i,width:f.width+r+l+s+u}},node:function(t){var n=null,o={height:0,width:0};return"string"==typeof t&&(n=e.bySelector(),t=n.first(t),n=null),null!==t&&(o=this.nodeByClientRectSize(t),0===o.height&&0===o.width&&(o=this.nodeByOffset(t))),o},window:function(){return self.innerHeight?{height:self.innerHeight,width:self.innerWidth}:document.documentElement&&document.documentElement.clientHeight?{height:document.documentElement.clientHeight,width:document.documentElement.clientWidth}:document.body?{height:document.body.clientHeight,width:document.body.clientWidth}:null},image:function(e){function t(e){var t=new Image,n=null;return t.src=e.src,n={width:t.width,height:t.height},t=null,n}return void 0!==e?"number"==typeof e.naturalWidth?{width:e.naturalWidth,height:e.naturalHeight}:t(e):null}},new t},r=function(){var e=function(){};return e.prototype={window:function(){var e=document.body,t=document.documentElement;return{top:function(){return Math.max(e.scrollTop||0,t.scrollTop||0,e.pageYOffset||0,t.pageYOffset||0,window.pageYOffset||0)},left:function(){return Math.max(e.scrollLeft||0,t.scrollLeft||0,e.pageXOffset||0,t.pageXOffset||0,window.pageXOffset||0)},height:function(){return Math.max(e.scrollHeight||0,e.offsetHeight||0,t.clientHeight||0,t.scrollHeight||0,t.offsetHeight||0)},width:function(){return Math.max(e.scrollWidth||0,e.offsetWidth||0,t.clientWidth||0,t.scrollWidth||0,t.offsetWidth||0)}}},get:function(e){return e!==document.body&&e!==document.documentElement?{top:function(){return Math.max(e.scrollTop||0,e.pageYOffset||0)},left:function(){return Math.max(e.scrollLeft||0,e.pageXOffset||0)},height:function(){return Math.max(e.scrollHeight||0,e.clientHeight||0,e.offsetHeight||0)},width:function(){return Math.max(e.scrollWidth||0,e.clientWidth||0,e.offsetWidth||0)}}:this.window()},scrollBarSize:function(){function e(){var e=document.createElement("DIV"),t=a(),n=null;return t.apply(e,{position:"absolute",top:"-1000px",left:"-1000px",width:"300px",height:"300px",overflow:"scroll",opacity:"0.01"}),document.body.appendChild(e),n={width:e.offsetWidth-e.clientWidth,height:e.offsetHeight-e.clientHeight},n.probablyMobile=0===n.width,n.width=0===n.width?f.classes.scroll.MINIMAL_WIDTH:n.width,n.height=0===n.height?f.classes.scroll.MINIMAL_HEIGHT:n.height,document.body.removeChild(e),n}var t=flex.overhead.globaly.get(f.storage.GROUP,f.storage.SCROLL,{});return t.value||(t.value=e()),t.value}},new e},l=function(){var e=function(){};return e.prototype={build:function(e){function t(e,t){var n=t[e.settingup.parent]||null;"object"==typeof e.settingup&&null!==t&&null!==n&&Array.prototype.forEach.call(e.settingup.childs,function(o){t[o]&&("object"==typeof e[o].settingup?n.appendChild(t[o][e[o].settingup.parent]):n.appendChild(t[o]))})}function n(e){var t=document.createElement(e.node);return null!==e.html&&(t.innerHTML=e.html),Array.prototype.forEach.call(e.attrs,function(e){flex.oop.objects.validate(e,[{name:"name",type:"string"},{name:"value",type:"string"}])===!0&&t.setAttribute(e.name,e.value)}),t}function o(e){return flex.oop.objects.validate(e,[{name:"node",type:"string"},{name:"attrs",type:"array",value:[]},{name:"html",type:"string",value:null}])}var r={};try{if(o(e)===!0)return n(e);for(var l in e)if(o(e[l])===!0)r[l]=n(e[l]);else if("object"==typeof e[l]&&"settingup"!==l&&(r[l]=this.build(e[l]),null===r[l]))return null;t(e,r)}catch(e){return null}return r}},new e},a=function(){var e=function(){};return e.prototype={apply:function(e,t){if(e&&"object"==typeof t&&e.style){for(var n in t)e.style[n]=t[n];return!0}return!1},redraw:function(e){return!(!e||void 0===e.style)&&(e.style.display="none",e.style.display="",!0)},getRuleFromSheet:function(e,t){var n=(document.styleSheets,[]);try{t=t.replace(/['"]/gi,"|"),Array.prototype.forEach.call(e.cssRules||e.rules,function(e,o){e.selectorText?e.selectorText.replace(/['"]/gi,"|")===t&&n.push({rule:e,style:e.style||null,index:o,cssText:e.cssText||""}):"string"==typeof e.cssText&&0===e.cssText.indexOf(t.toLowerCase())&&n.push({rule:e,style:e.style||null,index:o,cssText:e.cssText||""})})}catch(e){}finally{return n.length>0?n:null}},getRule:function(e){var t=(document.styleSheets,[]),n=this;try{e=e.replace(/['"]/gi,"|"),Array.prototype.forEach.call(document.styleSheets,function(o){var r=n.getRuleFromSheet(o,e);null!==r&&(t=t.concat(r))})}catch(e){}finally{return t.length>0?t:null}},setRule:function(e,t){var n=flex.overhead.globaly.get(f.storage.GROUP,f.storage.CUSTOM_STYLES);if("string"==typeof t){if(null===n&&(n=document.createElement("style"),n.type="text/css",document.head.appendChild(n),n=n.styleSheet||n.sheet,flex.overhead.globaly.set(f.storage.GROUP,f.storage.CUSTOM_STYLES,n)),n.insertRule)return n.insertRule(e+" {"+t+"}",n.cssRules.length),{rule:n.cssRules[n.cssRules.length-1],index:n.cssRules.length-1,sheet:n};if(n.addRule)return n.addRule(e+" {"+t+"}",-1),{rule:n.cssRules[n.cssRules.length-1],index:n.cssRules.length-1,sheet:n}}return null},updateRule:function(e,t,n){var o=t.selectorText;return this.deleteRule(e,t),this.setRule(o,n)},deleteRule:function(e,t,n){function o(e,t,n,o){var r=null;if(void 0!==t)if("string"==typeof t){if(r=o===!1&&null!==n?e.getRuleFromSheet(n,t):e.getRule(t),null!==r&&1===r.length)return r[0].index}else{if("number"==typeof t)return t;if("object"==typeof t&&null!==n)return e.getRuleIndex(n,t)}return-1}var e=e||flex.overhead.globaly.get(f.storage.GROUP,f.storage.CUSTOM_STYLES),n="boolean"!=typeof n||n,r=o(this,t,e,n);if(r!==-1&&null!==e){if(e.deleteRule)return e.deleteRule(r),!0;if(e.removeRule)return e.removeRule(r),!0}return null},getRuleIndex:function(e,t){var n=-1;try{Array.prototype.forEach.call(e.cssRules,function(e,o){if(e===t)throw n=o,"found"})}catch(e){if("found"===e)return n}return-1},addClass:function(e,t){void 0!==e.className&&e.className.search(t)===-1&&(e.className+=t)},removeClass:function(e,t){void 0!==e.className&&e.className.search(t)!==-1&&(e.className=e.className.replace(t,""))}},new e},i=function(){var e=function(){};return e.prototype=function(){var e=null,t=null,n=null;return i={old:function(e){for(var t=0,n=0;e;)void 0!==e.offsetTop&&void 0!==e.offsetLeft&&(t+=parseFloat(e.offsetTop),n+=parseFloat(e.offsetLeft)),e=e.offsetParent;return{top:t,left:n}},modern:function(e){var t=null,n=null,o=null,r=null,l=null,a=null,i=null;return t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,r=window.pageYOffset||o.scrollTop||n.scrollTop,l=window.pageXOffset||o.scrollLeft||n.scrollLeft,a=o.clientTop||n.clientTop||0,i=o.clientLeft||n.clientLeft||0,{top:t.top+r-a,left:t.left+l-i}}},e=function(e){var t=null,n=null,o=null,r=null,l=null,a=null;try{o=e.getBoundingClientRect(),t=o.top,n=o.left}catch(o){r=i.old(e),l=window.pageYOffset||objDocumentElement.scrollTop||objBody.scrollTop,a=window.pageXOffset||objDocumentElement.scrollLeft||objBody.scrollLeft,t=r.top-l,n=r.left-a}finally{return{top:t,left:n}}},t=function(e){var t=null;try{t=i.modern(e)}catch(n){t=i.old(e)}finally{return t}},n={byPage:e,byWindow:t},{byPage:n.byPage,byWindow:n.byWindow}}(),new e},s=function(){var e=function(){};return e.prototype={em:function(e){return e=e||document.documentElement,e=e.parentNode?e:document.documentElement,parseFloat(getComputedStyle(e).fontSize)},rem:function(){this.em(document.documentElement)}},new e},u={validateNode:function(t){var n=null;return t&&("string"==typeof t&&(n=e.bySelector(),t=n.first(t)),null!==t&&void 0!==t.parentNode)?t:null},appendChilds:function(e,t){for(var n=t.length-1;n>=0;n-=1)e.appendChild(t[0])}},c={init:function(){function n(){null===d&&(d=o())}function l(){null===h&&(h=i())}function s(){null===p&&(p=a())}function u(){null===g&&(g=r())}function c(){null===E&&(E=t())}function f(){null===y&&(y=e.fromParent())}var d=null,h=null,p=null,g=null,E=null,y=null;flex.callers.define.node("html.size.get",function(){return n(),d.node(this.target)}),flex.callers.define.node("html.size.getWithMargin",function(){return n(),d.nodeWithMargin(this.target)}),flex.callers.define.node("html.size.getByClientRectSize",function(){return n(),d.nodeByClientRectSize(this.target)}),flex.callers.define.node("html.size.getByOffset",function(){return n(),d.nodeByOffset(this.target)}),flex.callers.define.node("html.position.byPage",function(){return l(),h.byPage(this.target)}),flex.callers.define.node("html.position.byWindow",function(){return l(),h.byWindow(this.target)}),flex.callers.define.node("html.styles.apply",function(e){return s(),p.apply(this.target,e)}),flex.callers.define.node("html.styles.redraw",function(){return s(),p.redraw(this.target)}),flex.callers.define.node("html.styles.addClass",function(e){return s(),p.addClass(this.target,e)}),flex.callers.define.node("html.styles.removeClass",function(e){return s(),p.removeClass(this.target,e)}),flex.callers.define.node("html.scroll.position",function(){return u(),g.get(this.target)}),flex.callers.define.node("html.find.childByAttr",function(e,t){return c(),E.childByAttr(this.target,e,t)}),flex.callers.define.node("html.find.childByType",function(e){return c(),E.childByType(this.target,e)}),flex.callers.define.node("html.find.parentByAttr",function(e){return c(),E.parentByAttr(this.target,e)}),flex.callers.define.node("html.find.node",function(e){return f(),y.first(this.target,e)}),flex.callers.define.node("html.find.nodes",function(e){return f(),y.all(this.target,e)}),flex.callers.define.nodes("html.size.get",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.node(t))}),e}),flex.callers.define.nodes("html.size.getWithMargin",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.nodeWithMargin(t))}),e}),flex.callers.define.nodes("html.size.getByClientRectSize",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.nodeByClientRectSize(t))}),e}),flex.callers.define.nodes("html.size.getByOffset",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.nodeByOffset(t))}),e}),flex.callers.define.nodes("html.position.byPage",function(){var e=[];return l(),Array.prototype.forEach.call(this.target,function(t){e.push(h.byPage(t))}),e}),flex.callers.define.nodes("html.position.byWindow",function(){var e=[];return l(),Array.prototype.forEach.call(this.target,function(t){e.push(h.byWindow(t))}),e}),flex.callers.define.nodes("html.styles.apply",function(e){var t=[];return s(),Array.prototype.forEach.call(this.target,function(n){t.push(p.apply(n,e))}),t}),flex.callers.define.nodes("html.styles.redraw",function(){var e=[];return s(),Array.prototype.forEach.call(this.target,function(t){e.push(p.redraw(t))}),e}),flex.callers.define.nodes("html.styles.addClass",function(e){var t=[];return s(),Array.prototype.forEach.call(this.target,function(n){t.push(p.addClass(n,e))}),t}),flex.callers.define.nodes("html.styles.removeClass",function(e){var t=[];return s(),Array.prototype.forEach.call(this.target,function(n){t.push(p.removeClass(n,e))}),t}),flex.callers.define.nodes("html.scroll.position",function(){var e=[];return u(),Array.prototype.forEach.call(this.target,function(t){e.push(g.get(t))}),e}),flex.callers.define.nodes("html.find.childByAttr",function(e,t){var n=[];return c(),Array.prototype.forEach.call(this.target,function(o){n.push(E.childByAttr(o,e,t))}),n}),flex.callers.define.nodes("html.find.childByType",function(e){var t=[];return c(),Array.prototype.forEach.call(this.target,function(n){t.push(E.childByType(n,e))}),t}),flex.callers.define.nodes("html.find.parentByAttr",function(e){var t=[];return c(),Array.prototype.forEach.call(this.target,function(n){t.push(E.parentByAttr(n,e))}),t}),flex.callers.define.nodes("html.find.node",function(e){var t=[];return f(),Array.prototype.forEach.call(this.target,function(n){t.push(e.first(n,e))}),t}),flex.callers.define.nodes("html.find.nodes",function(e){var t=[];return f(),Array.prototype.forEach.call(this.target,function(n){t.push(e.all(n,e))}),t})}},c.init(),n={select:{bySelector:e.bySelector,fromParent:e.fromParent},find:t,size:o,scroll:r,builder:l,styles:a,position:i,units:s,helpers:u},{select:{bySelector:n.select.bySelector,fromParent:n.select.fromParent},find:n.find,size:n.size,scroll:n.scroll,builder:n.builder,styles:a,position:n.position,units:s,helpers:n.helpers}},flex.modules.attach({name:"html",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null;return t=function(e){function n(e){var t=void 0!==s[e]?e:null;if(null===t)for(var n in u)if(u[n].indexOf(e)!==-1){t=n;break}return t}function o(e){_object(s[e.type]).forEach(function(t,n){n.call(a,e)})}function r(e){void 0===a[e]&&Object.defineProperty(a,e,{configurable:!0,enumerable:!0,get:function(){return i[e]},set:function(t){i[e]=t,o({type:"set",index:e,item:t})}})}function l(e){void 0===a[e]&&delete a[e]}var a=this,i=[],s={set:{},add:{},remove:{}},u={set:["update"],add:["add","new","push","unshift"],remove:["remove","del","delete","shift","pop"]},c={WRONG_EVENT_NAME:"0000: WRONG_EVENT_NAME",HANDLE_ISNOT_FUNCTION:"0001: HANDLE_ISNOT_FUNCTION",SAME_ID_OF_HANDLE:"0002: SAME_ID_OF_HANDLE",HANDLE_OR_ID_SHOULD_BE:"0003: HANDLE_OR_ID_SHOULD_BE",INVALID_LENGTH:"0004: INVALID_LENGTH"};Object.defineProperty(a,"getOriginal",{configurable:!1,enumerable:!1,writable:!1,value:function(){return i}}),Object.defineProperty(a,"bind",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t,o){if(e=n(e),null===e)throw new Error(c.WRONG_EVENT_NAME);if("function"!=typeof t)throw new Error(c.HANDLE_ISNOT_FUNCTION);if(o="string"==typeof o?o:flex.unique(),void 0!==s[e][o])throw new Error(c.SAME_ID_OF_HANDLE);s[e][o]=t}}),Object.defineProperty(a,"unbind",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){if(e=n(e),null!==e){if("function"==typeof t){for(var o in s[e])if(s[e][o]===t)return delete s[e][o],!0;return!1}if("string"==typeof t)return void 0!==s[e][t]&&(delete s[e][t],!0);throw new Error(c.HANDLE_OR_ID_SHOULD_BE)}throw new Error(c.WRONG_EVENT_NAME)}}),Object.defineProperty(a,"pop",{configurable:!1,enumerable:!1,writable:!1,value:function(){if(i.length>-1){var e=i.pop();return l(i.length),o({type:"remove",index:i.length,item:e,count:1}),e}}}),Object.defineProperty(a,"push",{configurable:!1,enumerable:!1,writable:!1,value:function(){var e=Array.prototype.filter.call(arguments,function(){return!0}),t=i.length;return e.length>0&&(e.forEach(function(e){i.push(e),r(i.length-1)}),o({type:"add",index:t,item:e,count:e.length})),i.length}}),Object.defineProperty(a,"unshift",{configurable:!1,enumerable:!1,writable:!1,value:function(){var e=Array.prototype.filter.call(arguments,function(){return!0});return e.length>0&&(e.forEach(function(e,t){i.splice(t,0,e),r(t)}),o({type:"add",index:0,item:e,count:e.length})),i.length}}),Object.defineProperty(a,"shift",{configurable:!1,enumerable:!1,writable:!1,value:function(){var e=null;if(i.length>0)return e=i.shift(),l(i.length),o({type:"remove",index:0,item:e,count:1}),e}}),Object.defineProperty(a,"splice",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){var n=[],a=[];if(e=void 0!==e?e>i.length-1?i.length:e:0,e=e<0?i.length+e:e,t=void 0!==t?t:i.length-e,a=i.splice(e,t),a.length>0){o({type:"remove",index:e,item:a,count:a.length});for(var s=a.length-1;s>=0;s-=1)l(i.length+s)}return n=Array.prototype.slice.call(arguments,2,arguments.length),n.length>0&&(n.forEach(function(t,n){i.splice(e+n,0,t),r(i.length-1)}),o({type:"add",index:e,item:n,count:n.length})),a}}),Object.defineProperty(a,"fill",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t,n){for(var r=Object(i),t=void 0===t?0:t,n=void 0===n?i.length:n,l=r.length>>>0,a=t>>0,s=a<0?Math.max(l+a,0):Math.min(a,l),u=void 0===n?l:n>>0,c=u<0?Math.max(l+u,0):Math.min(u,l);s<c;)r[s]=e,o({type:"set",index:s,item:e}),s++;return r}}),Object.defineProperty(a,"length",{configurable:!1,enumerable:!1,get:function(){return i.length},set:function(e){var t=Number(e);if(!(t%1===0&&t>=0))throw new RangeError(c.INVALID_LENGTH);return t<i.length?a.splice(t):t>i.length&&a.push.apply(a,new Array(t-i.length)),e}}),Object.defineProperty(a,"concat",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e=[].concat(i),n=0,o=arguments.length;n<o;n++)arguments[n]instanceof Array?e=e.concat(arguments[n]):arguments[n]instanceof t?e=e.concat(arguments[n].getOriginal()):e.push(arguments[n]);return new t(e)}}),Object.getOwnPropertyNames(Array.prototype).forEach(function(e){void 0===a[e]&&Object.defineProperty(a,e,{configurable:!1,enumerable:!1,writable:!1,value:Array.prototype[e]})}),e instanceof Array&&a.push.apply(a,e)},e={ExArray:t},{ExArray:e.ExArray}},flex.modules.attach({name:"types.array",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){function e(e){var e=e||null,t=_nodes("*["+l.CONTAINER+(null!==e?'="'+e+'"':"")+"]:not(["+l.INITED+"])").target;null!==t&&Array.prototype.forEach.call(t,function(e){var t=e.getAttribute(l.CONTAINER),r=null;""!==t&&null!==t&&(r=_nodes("*["+l.HOOK+'="'+t+'"]').target,null!==r&&(n.attach(e,r,t),o.attach(e,t))),e.setAttribute(l.INITED,!0)})}var t=null,n=null,o=null,r=null,l=null;return l={CONTAINER:"data-flex-ui-window-move-container",HOOK:"data-flex-ui-window-move-hook",INITED:"data-flex-window-move-inited",GLOBAL_GROUP:"flex-window-move",GLOBAL_EVENT_FLAG:"flex-window-move-global-event",GLOBAL_CURRENT:"flex-window-move-global-current",GLOBAL_EVENT_ID:"flex-window-move-global-event-id",STATE_STORAGE:"flex-window-move-instance-state"},n={attach:function(e,t,o){Array.prototype.forEach.call(t,function(t){_node(t).events().add("mousedown",function(r){n.start(r,e,t,o)},o)})},start:function(e,t,n,o){function r(e){return e.currentStyle&&e.currentStyle.position?e.currentStyle.position:window.getComputedStyle?window.getComputedStyle(e).position:null}var a=null,i=null,s=null;return flex.overhead.objecty.get(t,l.STATE_STORAGE,!1,!1)!==!1||(a=_node(t).html().position().byPage(),i=_node(t.parentNode).html().scroll().position(),s="fixed"===r(t),flex.overhead.globaly.set(l.GLOBAL_GROUP,l.GLOBAL_CURRENT,{clientX:e.flex.clientX,clientY:e.flex.clientY,offsetX:e.flex.offsetX,offsetY:e.flex.offsetY,pageX:e.flex.pageX,pageY:e.flex.pageY,hook:n,container:t,id:o,oldX:e.flex.pageX,oldY:e.flex.pageY,posX:a.left+(s===!1?i.left():0),posY:a.top+(s===!1?i.top():0)}),e.flex.stop())},move:function(e){var t=flex.overhead.globaly.get(l.GLOBAL_GROUP,l.GLOBAL_CURRENT),n=null;return null!==t&&(n=t.container,t.posX=t.posX-(t.oldX-e.flex.pageX),t.posY=t.posY-(t.oldY-e.flex.pageY),n.style.left=t.posX+"px",n.style.top=t.posY+"px",t.oldX=e.flex.pageX,t.oldY=e.flex.pageY),e.flex.stop()},stop:function(e){flex.overhead.globaly.del(l.GLOBAL_GROUP,l.GLOBAL_CURRENT)},global:{attach:function(){var e=flex.overhead.globaly.get(l.GLOBAL_GROUP,l.GLOBAL_EVENT_FLAG);e!==!0&&(flex.overhead.globaly.set(l.GLOBAL_GROUP,l.GLOBAL_EVENT_FLAG,!0),_node(window).events().add("mousemove",function(e){n.move(e)},l.GLOBAL_EVENT_ID),_node(window).events().add("mouseup",function(e){n.stop(e)},l.GLOBAL_EVENT_ID))}}},o={attach:function(e,t){flex.events.core.listen(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.MAXIMIZED,function(t){return o.onRefreshByParent(t.container,e,flex.registry.events.ui.window.maximize.MAXIMIZED)},l.STATE_STORAGE+t,!1),flex.events.core.listen(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.RESTORED,function(t){return o.onRefreshByParent(t.container,e,flex.registry.events.ui.window.maximize.RESTORED)},l.STATE_STORAGE+t,!1)},onRefreshByParent:function(e,t,n){if(e===t)switch(n){case flex.registry.events.ui.window.maximize.MAXIMIZED:flex.overhead.objecty.set(t,l.STATE_STORAGE,!0,!0);break;case flex.registry.events.ui.window.maximize.RESTORED:flex.overhead.objecty.set(t,l.STATE_STORAGE,!1,!0)}return!1}},r={attach:function(){null!==flex.oop.namespace.get("flex.registry.events.ui.patterns.GROUP")&&flex.events.core.listen(flex.registry.events.ui.patterns.GROUP,flex.registry.events.ui.patterns.MOUNTED,function(t){var n=void 0!==t.length&&t.length>0?t:null;null!==n&&n.forEach(function(t){null!==_node("*["+l.CONTAINER+"]:not(["+l.INITED+"])",!1,t).target&&e()})})}},t={init:e},n.global.attach(),r.attach(),void 0!==flex.libraries&&void 0!==flex.libraries.events&&void 0!==flex.libraries.html&&(flex.libraries.events.create(),flex.libraries.html.create()),{init:t.init}},flex.modules.attach({name:"ui.window.move",protofunction:e,reference:["flex.events","flex.html"]})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){function e(e){var e=e||null,t=_nodes("*["+l.CONTAINER+(null!==e?'="'+e+'"':"")+"]:not(["+l.INITED+"])").target;null!==t&&Array.prototype.forEach.call(t,function(e){var t=e.getAttribute(l.CONTAINER);null!==t&&""!==t&&Array.prototype.forEach.call(l.HOOKS,function(o){var l=n.hooks.get(t,e,o);n.attach(e,l,o,t),r.attach(e,t)}),e.setAttribute(l.INITED,!0)})}var t=null,n=null,o=null,r=null,l=null;return l={CONTAINER:"data-flex-ui-window-resize-container",INITED:"data-flex-window-resize-inited",HOOK:"data-flex-window-resize-hook",HOOKS:["top","left","right","bottom","corner"],HOOKS_STYLE:{top:{node:"div",style:{position:"absolute",zIndex:1,height:"6px",width:"100%",top:"0px",left:"0px",cursor:"n-resize"}},bottom:{node:"div",style:{position:"absolute",zIndex:1,height:"6px",width:"100%",bottom:"0px",left:"0px",cursor:"n-resize"}},left:{node:"div",style:{position:"absolute",zIndex:1,height:"100%",width:"6px",top:"0px",left:"0px",cursor:"e-resize"}},right:{node:"div",style:{position:"absolute",zIndex:1,height:"100%",width:"6px",top:"0px",right:"0px",cursor:"e-resize"}},corner:{node:"div",style:{position:"absolute",zIndex:1,height:"10px",width:"10px",bottom:"0px",right:"0px",cursor:"nw-resize"}}},POSITION_PARENT:"data-flex-ui-window-resize-position-parent",GLOBAL_GROUP:"flex-window-resize",GLOBAL_EVENT_FLAG:"flex-window-resize-global-event",GLOBAL_CURRENT:"flex-window-resize-global-current",GLOBAL_EVENT_ID:"flex-window-resize-global-event-id",STATE_STORAGE:"flex-window-resize-instance-state"},n={position:{getParent:function(e){var t=_node("*["+l.POSITION_PARENT+'="'+e+'"]');return null!==t?t.target:null}},hooks:{make:function(e,t){var n=document.createElement(l.HOOKS_STYLE[t].node);for(var o in l.HOOKS_STYLE[t].style)n.style[o]=l.HOOKS_STYLE[t].style[o];return e.appendChild(n),n},get:function(e,t,o){var r=_nodes("*["+l.CONTAINER+'="'+e+'"]['+l.HOOK+'="'+o+'"]:not(['+l.INITED+"])").target;return 0===r.length&&(r=[],r.push(n.hooks.make(t,o))),r}},attach:function(e,t,o,r){var l=n.position.getParent(r);Array.prototype.forEach.call(t,function(t){_node(t).events().add("mousedown",function(a){n.start(a,e,t,o,l,r)},r)})},start:function(e,t,n,o,r,a){function i(e){return e.currentStyle&&e.currentStyle.position?e.currentStyle.position:window.getComputedStyle?window.getComputedStyle(e).position:null}var s=null,u=null,c=null,f=null;return flex.overhead.objecty.get(t,l.STATE_STORAGE,!1,!1)!==!1||(s=_node(t).html().size().get(),u=_node(null!==r?r:t).html().position().byPage(),c=_node(t.parentNode).html().scroll().position(),f="fixed"===i(t),flex.overhead.globaly.set(l.GLOBAL_GROUP,l.GLOBAL_CURRENT,{clientX:e.flex.clientX,clientY:e.flex.clientY,offsetX:e.flex.offsetX,offsetY:e.flex.offsetY,pageX:e.flex.pageX,pageY:e.flex.pageY,hook:n,direction:o,container:t,position_parent:r,id:a,oldX:e.flex.pageX,oldY:e.flex.pageY,posX:u.left+(f===!1?c.left():0),posY:u.top+(f===!1?c.top():0),width:s.width,height:s.height}),e.flex.stop())},move:function(e){var t=flex.overhead.globaly.get(l.GLOBAL_GROUP,l.GLOBAL_CURRENT),n=null,o=null;if(null!==t){switch(n=t.container,o=null!==t.position_parent?t.position_parent:n,t.direction){case"top":t.posY=t.posY-(t.oldY-e.flex.pageY),t.height=t.height+(t.oldY-e.flex.pageY),n.style.height=t.height+"px",o.style.top=t.posY+"px";break;case"left":t.posX=t.posX-(t.oldX-e.flex.pageX),t.width=t.width+(t.oldX-e.flex.pageX),n.style.width=t.width+"px",o.style.left=t.posX+"px";break;case"bottom":t.height=t.height-(t.oldY-e.flex.pageY),n.style.height=t.height+"px";break;case"right":t.width=t.width-(t.oldX-e.flex.pageX),n.style.width=t.width+"px";break;case"corner":t.height=t.height-(t.oldY-e.flex.pageY),n.style.height=t.height+"px",t.width=t.width-(t.oldX-e.flex.pageX),n.style.width=t.width+"px"}t.oldX=e.flex.pageX,t.oldY=e.flex.pageY,setTimeout(function(){flex.events.core.fire(flex.registry.events.ui.window.resize.GROUP,flex.registry.events.ui.window.resize.REFRESH,{container:t.container,id:t.id})},10)}return e.flex.stop()},stop:function(e){var t=flex.overhead.globaly.get(l.GLOBAL_GROUP,l.GLOBAL_CURRENT);null!==t&&flex.events.core.fire(flex.registry.events.ui.window.resize.GROUP,flex.registry.events.ui.window.resize.FINISH,{container:t.container,id:t.id}),flex.overhead.globaly.del(l.GLOBAL_GROUP,l.GLOBAL_CURRENT)},global:{attach:function(){var e=flex.overhead.globaly.get(l.GLOBAL_GROUP,l.GLOBAL_EVENT_FLAG);e!==!0&&(flex.overhead.globaly.set(l.GLOBAL_GROUP,l.GLOBAL_EVENT_FLAG,!0),_node(window).events().add("mousemove",function(e){n.move(e)},l.GLOBAL_EVENT_ID),_node(window).events().add("mouseup",function(e){n.stop(e)},l.GLOBAL_EVENT_ID))}}},r={attach:function(e,t){flex.events.core.listen(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.MAXIMIZED,function(t){return r.onRefreshByParent(t.container,e,flex.registry.events.ui.window.maximize.MAXIMIZED)},l.STATE_STORAGE+t,!1),flex.events.core.listen(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.RESTORED,function(t){return r.onRefreshByParent(t.container,e,flex.registry.events.ui.window.maximize.RESTORED)},l.STATE_STORAGE+t,!1)},onRefreshByParent:function(e,t,n){if(e===t)switch(n){case flex.registry.events.ui.window.maximize.MAXIMIZED:flex.overhead.objecty.set(t,l.STATE_STORAGE,!0,!0);break;case flex.registry.events.ui.window.maximize.RESTORED:flex.overhead.objecty.set(t,l.STATE_STORAGE,!1,!0)}return!1}},o={attach:function(){null!==flex.oop.namespace.get("flex.registry.events.ui.patterns.GROUP")&&flex.events.core.listen(flex.registry.events.ui.patterns.GROUP,flex.registry.events.ui.patterns.MOUNTED,function(t){var n=void 0!==t.length&&t.length>0?t:null;null!==n&&n.forEach(function(t){null!==_node("*["+l.CONTAINER+"]:not(["+l.INITED+"])",!1,t).target&&e()})})}},t={init:e},function(){void 0===flex.registry.events.ui&&(flex.registry.events.ui={}),void 0===flex.registry.events.ui.window&&(flex.registry.events.ui.window={}),void 0===flex.registry.events.ui.window.resize&&(flex.registry.events.ui.window.resize={GROUP:"flex.ui.window.resize",REFRESH:"refresh",FINISH:"finish"})}(),n.global.attach(),o.attach(),void 0!==flex.libraries&&void 0!==flex.libraries.events&&void 0!==flex.libraries.html&&(flex.libraries.events.create(),flex.libraries.html.create()),{init:t.init}},flex.modules.attach({name:"ui.window.resize",protofunction:e,reference:["flex.events","flex.html"]})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){function e(e){var e=e||null,t=_nodes("*["+r.CONTAINER+(null!==e?'="'+e+'"':"")+"]:not(["+r.INITED+"])").target;null!==t&&Array.prototype.forEach.call(t,function(e){var t=e.getAttribute(r.CONTAINER);""!==t&&null!==t||e.setAttribute(r.CONTAINER,flex.unique()),e.setAttribute(r.INITED,!0)})}var t=null,n=null,o=null,r=null,l=null;return r={CONTAINER:"data-flex-ui-window-focus",INITED:"data-flex-window-focus-inited",GLOBAL_GROUP:"flex-window-focus-global-group",GLOBAL_EVENT_FLAG:"flex-window-focus-global-event",GLOBAL_CURRENT:"flex-window-focus-global-current",GLOBAL_EVENT_ID:"flex-window-focus-global-event-id",FOCUSED_ZINDEX:1e3},n={attach:function(){var e=flex.overhead.globaly.get(r.GLOBAL_GROUP,r.GLOBAL_EVENT_FLAG);e!==!0&&(flex.overhead.globaly.set(r.GLOBAL_GROUP,r.GLOBAL_EVENT_FLAG,!0),_node(window).events().add("click",function(e){return o.onClick(e),!0},r.GLOBAL_EVENT_ID))}},o={getContainer:function(e){var t=null,n=null;return"function"==typeof e.getAttribute&&(t=e.getAttribute(r.CONTAINER),""!==t&&null!==t)?{container:e,id:t}:(n=_node(e).html().find().parentByAttr({name:r.CONTAINER,value:null}),null!==n?{container:n,id:n.getAttribute(r.CONTAINER)}:null)},history:{is:function(e){return flex.overhead.globaly.get(r.GLOBAL_GROUP,r.GLOBAL_CURRENT)===e},set:function(e){flex.overhead.globaly.set(r.GLOBAL_GROUP,r.GLOBAL_CURRENT,e)},get:function(){return flex.overhead.globaly.get(r.GLOBAL_GROUP,r.GLOBAL_CURRENT)},del:function(){flex.overhead.globaly.del(r.GLOBAL_GROUP,r.GLOBAL_CURRENT)}},onClick:function(e){var t=o.getContainer(e.flex.target),n=o.history.get();null!==n&&o.focus.unset(n),null!==t&&o.history.is(t.id)===!1&&o.focus.set(t.id)},focus:{zIndex:function(e,t){var n=_node("*["+r.CONTAINER+'="'+e+'"]').target;null!==n&&(n.style.zIndex=t)},set:function(e){o.focus.zIndex(e,r.FOCUSED_ZINDEX),o.history.set(e)},unset:function(e){o.focus.zIndex(e,""),o.history.del(e)}}},l={attach:function(){null!==flex.oop.namespace.get("flex.registry.events.ui.patterns.GROUP")&&flex.events.core.listen(flex.registry.events.ui.patterns.GROUP,flex.registry.events.ui.patterns.MOUNTED,function(t){var n=void 0!==t.length&&t.length>0?t:null;null!==n&&n.forEach(function(t){null!==_node("*["+r.CONTAINER+"]:not(["+r.INITED+"])",!1,t).target&&e()})})}},t={init:e},n.attach(),l.attach(),void 0!==flex.libraries&&void 0!==flex.libraries.events&&void 0!==flex.libraries.html&&(flex.libraries.events.create(),flex.libraries.html.create()),{init:t.init}},flex.modules.attach({name:"ui.window.focus",protofunction:e,reference:["flex.events","flex.html"]})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){function e(e){var e=e||null,t=_nodes("*["+r.CONTAINER+(null!==e?'="'+e+'"':"")+"]:not(["+r.INITED+"])").target;null!==t&&Array.prototype.forEach.call(t,function(e){
var t=e.getAttribute(r.CONTAINER),n=null;""!==t&&null!==t&&(n=_nodes("*["+r.HOOK+'="'+t+'"]').target,null!==n&&o.attach(e,n,t)),e.setAttribute(r.INITED,!0),e.setAttribute(r.STATE,"false"),flex.overhead.objecty.set(e,r.STORAGE,{maximazed:!1},!0)})}var t=null,n=null,o=null,r=null;return r={CONTAINER:"data-flex-ui-window-maximize",HOOK:"data-flex-window-maximize-hook",INITED:"data-flex-window-maximize-inited",STATE:"data-flex-window-is-maximized",STORAGE:"flex-window-maximize-storage"},o={attach:function(e,t,n){Array.prototype.forEach.call(t,function(t,r){_node(t).events().add("click",function(t){return o.onClick(t,e,n),!0},n+"_"+r)})},onClick:function(e,t,n){var l=flex.overhead.objecty.get(t,r.STORAGE,!1);null!==l&&(l.maximazed===!1?o.actions.maximaze(t,l,n):o.actions.restore(t,l,n),setTimeout(function(){flex.events.core.fire(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.CHANGE,{container:t,id:n})},10))},actions:{maximaze:function(e,t,n){t.maximazed=!0,t.size={position:""!==e.style.position&&e.style.position,width:""!==e.style.width&&e.style.width,height:""!==e.style.height&&e.style.height,left:""!==e.style.left&&e.style.left,top:""!==e.style.top&&e.style.top},e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.left="0px",e.style.top="0px",e.setAttribute(r.STATE,"true"),setTimeout(function(){flex.events.core.fire(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.MAXIMIZED,{container:e,id:n})},10)},restore:function(e,t,n){t.maximazed=!1,e.style.position=t.size.position!==!1?t.size.position:"",e.style.width=t.size.width!==!1?t.size.width:"",e.style.height=t.size.height!==!1?t.size.height:"",e.style.left=t.size.left!==!1?t.size.left:"",e.style.top=t.size.top!==!1?t.size.top:"",e.setAttribute(r.STATE,"false"),setTimeout(function(){flex.events.core.fire(flex.registry.events.ui.window.maximize.GROUP,flex.registry.events.ui.window.maximize.RESTORED,{container:e,id:n})},10)},byID:{findByID:function(e){var e=e||null,t=null,n=[];return null!==e&&(t=_nodes("*["+r.CONTAINER+(null!==e?'="'+e+'"':"")+"]").target,null!==t&&t.length>0)?(Array.prototype.forEach.call(t,function(e){var t=flex.overhead.objecty.get(e,r.STORAGE,!1);null!==t&&n.push({container:e,storage:t})}),n.length>0?n:null):null},maximaze:function(e){var t=o.actions.byID.findByID(e);null!==t&&t.forEach(function(t){o.actions.maximaze(t.container,t.storage,e)})},restore:function(e){var t=o.actions.byID.findByID(e);null!==t&&t.forEach(function(t){o.actions.restore(t.container,t.storage,e)})}}}},n={attach:function(){null!==flex.oop.namespace.get("flex.registry.events.ui.patterns.GROUP")&&flex.events.core.listen(flex.registry.events.ui.patterns.GROUP,flex.registry.events.ui.patterns.MOUNTED,function(t){var n=void 0!==t.length&&t.length>0?t:null;null!==n&&n.forEach(function(t){null!==_node("*["+r.CONTAINER+"]:not(["+r.INITED+"])",!1,t).target&&e()})})}},void 0!==flex.libraries&&void 0!==flex.libraries.events&&flex.libraries.events.create(),function(){void 0===flex.registry.events.ui&&(flex.registry.events.ui={}),void 0===flex.registry.events.ui.window&&(flex.registry.events.ui.window={}),void 0===flex.registry.events.ui.window.maximize&&(flex.registry.events.ui.window.maximize={GROUP:"flex.ui.window.maximize",MAXIMIZED:"maximized",RESTORED:"restored",CHANGE:"change"})}(),n.attach(),t={init:e,maximaze:o.actions.byID.maximaze,restore:o.actions.byID.restore},{init:t.init,maximaze:t.maximaze,restore:t.restore}},flex.modules.attach({name:"ui.window.maximize",protofunction:e,reference:["flex.events"]})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,o=null,r=null,l=null,a=null,i=null,s=null,u=null,c=null,f=null,d=null,h=null,p=null,g=null,E=null,y=null,O=flex.libraries.types.array.create().ExArray;return e={values:{USE_STORAGE_CSS:!0,USE_STORAGE_JS:!0,USE_STORAGE_HTML:!0,USE_LOCALSTORAGE:!0,PATTERN_NODE:"pattern",PATTERN_SRC:"data-pattern",HOOK_PREFIX:"h_",HOOKS_SET:"data-hooks",CACHE_PATTERNS:!1,onLayoutBuildFinish:null},validator:{USE_STORAGE_CSS:function(e){return"boolean"==typeof e},USE_STORAGE_JS:function(e){return"boolean"==typeof e},USE_STORAGE_HTML:function(e){return"boolean"==typeof e},USE_LOCALSTORAGE:function(e){return"boolean"==typeof e},PATTERN_SRC:function(e){return"string"==typeof e},PATTERN_NODE:function(e){return"string"==typeof e&&(e.length>0&&0===e.replace(/\w/gi,"").length)},PATTERN_SRC:function(e){return"string"==typeof e},HOOK_PREFIX:function(e){return"string"==typeof e},HOOKS_SET:function(e){return"string"==typeof e},CACHE_PATTERNS:function(e){return"boolean"==typeof e},onLayoutBuildFinish:function(e){return"function"==typeof e}},setup:function(t){null!==t&&"object"==typeof t&&_object(t).forEach(function(t,n){void 0!==e.values[t]&&void 0!==e.validator[t]&&(e.values[t]=e.validator[t](n)?n:e.values[t])})},get:function(){return e.values},debug:function(){e.values.USE_STORAGE_CSS=!1,e.values.USE_STORAGE_JS=!1,e.values.USE_STORAGE_HTML=!1,e.values.USE_LOCALSTORAGE=!1,e.values.CACHE_PATTERNS=!1,flex.config.set({logs:{SHOW:["CRITICAL","LOGICAL","WARNING","NOTIFICATION","LOGS","KERNEL_LOGS"]}})}},t={measuring:{MEASURE:!0},classes:{SOURCE:function(){},PATTERN:function(){},CALLER:function(){}},regs:{BODY:/<\s*body[^>]*>(\n|\r|\s|.)*?<\s*\/body\s*>/gi,BODY_TAG:/<\s*body[^>]*>|<\s*\/\s*body\s*>/gi,BODY_CLEAR:/^[\n\r\s]*|[\n\r\s]*$/gi,FIRST_TAG:/^\s*<\s*\w{1,}/gi,TAG_BORDERS:/<|>/gi,CSS:/<link\s+.*?\/>|<link\s+.*?\>/gi,CSS_HREF:/href\s*\=\s*"(.*?)"|href\s*\=\s*'(.*?)'/gi,CSS_REL:/rel\s*=\s*"stylesheet"|rel\s*=\s*'stylesheet'/gi,CSS_TYPE:/type\s*=\s*"text\/css"|type\s*=\s*'text\/css'/gi,JS:/<script\s+.*?>/gi,JS_SRC:/src\s*\=\s*"(.*?)"|src\s*\=\s*'(.*?)'/gi,JS_TYPE:/type\s*=\s*"text\/javascript"|type\s*=\s*'text\/javascript'/gi,STRING:/"(.*?)"|'(.*?)'/gi,STRING_BORDERS:/"|'/gi,DOM:/\{\{\$[\w\.\,]*?\}\}/gi,DOM_OPEN_STR:"{{$",DOM_CLOSE_STR:"}}",HOOK:/\{\{[\w\d_\.]*?\}\}/gi,MODEL:/\{\{\:\:[\w\d_\.]*?\}\}/gi,MODEL_BORDERS:/\{\{\:\:|\}\}/gi,HOOK_OPEN:"\\{\\{",HOOK_CLOSE:"\\}\\}",HOOK_BORDERS:/\{\{|\}\}/gi,CONDITIONS:/<!--[\w_]*=.{1,}-->/gi,CONDITION_CONTENT:"<!--[open]-->(\\n|\\r|\\s|.)*?<!--[close]-->",CONDITION_CONTENT_ANY:"<!--[open]=.{1,}-->(\\n|\\r|\\s|.)*?<!--[close]-->",STRING_CON:/".*?"/gi,STRING_CON_STR:'".*"',STRING_CON_STRICT:'".*?"',STRING_BORDER_CON:/"/gi,CON_CLOSE_STR:"<!--[name]-->",OPEN_TAG:/<[\s]*[\w]{1,}/gi,COMMENT_BORDERS:/<!--|-->/gi,FIRST_WORD:/^\w+/gi,TAGS:/<\s*\w[^>\/]*.*?>/gi,ATTRS:/([\w-]{1,}\s*=\s*".{1,}?")|([\w-]{1,}\s*=\s*'.{1,}?')/gi,DOM_BORDERS:/\{\{\$|\}\}/gi,MODEL_OPEN_STR:"{{::",MODEL_CLOSE_STR:"}}",HOOK_OPEN_STR:"{{",HOOK_CLOSE_STR:"}}",ALL:/\{\{.*?\}\}/gi,INSIDE_TAG:/>(.*?)</gi,EVENT_ATTR:/[\w]{1,}(\s{1,})?=(\s{1,})?["']\{\{\@[\w\d_\.]*?\}\}["']/gi,EVENT_BORDERS:/\{\{\@|\}\}/gi},storage:{VIRTUAL_STORAGE_GROUP:"FLEX_UI_PATTERNS_GROUP",VIRTUAL_STORAGE_ID:"FLEX_UI_PATTERNS_STORAGE",CSS_ATTACHED_JOURNAL:"FLEX_UI_PATTERNS_CSS_JOURNAL",JS_ATTACHED_JOURNAL:"JS_ATTACHED_JOURNAL",PRELOAD_TRACKER:"FLEX_UI_PATTERNS_PRELOAD_TRACKER",CONTROLLERS_LINKS:"FLEX_PATTERNS_CONTROLLERS_LINKS",CONTROLLERS_STORAGE:"FLEX_PATTERNS_CONTROLLERS_STORAGE",CONDITIONS_STORAGE:"FLEX_PATTERNS_CONDITIONS_STORAGE",HOOKS_STORAGE:"FLEX_PATTERNS_HOOKS_STORAGE",MAPS_STORAGE:"FLEX_PATTERNS_MAPS_STORAGE",PATTERN_SOURCES:"FLEX_PATTERNS_PATTERN_SOURCES",GLOBAL_EVENTS:"FLEX_PATTERNS_GLOBAL_EVENTS",PATTERN_CACHE:"FLEX_PATTERNS_CACHE_STORAGE"},compatibility:{PARENT_TO_CHILD:{table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td",colgroup:"col"},CHILD_TO_PARENT:{tr:"tbody",th:"tbody",td:"tr",col:"colgroup",tbody:"table",thead:"table",tfoot:"table"},BASE:"div"},css:{classes:{MODEL_NODE:"data-flex-model-node"},attrs:{MODEL:"data-flex-model-data",DOM:"data-flex-pattern-dom",CONDITION:"data-flex-pattern-condition",PARENT:"data-flex-pattern-parrent"},selectors:{HOOK_WRAPPERS:".flex_patterns_hook_wrapper"}},events:{ONREADY:"onReady",ONUPDATE:"onUpdate",SETINSTNCE:"setInstance"},other:{SUBLEVEL_BEGIN:"_",SUBLEVEL_END:"_",BIND_PREFIX:"$$",DOM_PREFIX:"$",PARENT_MARK_HTML:"##parent##",ANCHOR:"ANCHOR::",EVENTS_HANDLE_ID:"flex_patterns_listener_handle_id",CACHE_PATTERNS_PREFIX:"PATTERNS_CACHE:"}},f={SIGNATURE:"[flex.ui.patterns]",source:{TEMPLATE_WAS_LOADED:"0001:TEMPLATE_WAS_LOADED",FAIL_TO_LOAD_TEMPLATE:"0002:FAIL_TO_LOAD_TEMPLATE",FAIL_TO_PARSE_TEMPLATE:"0003:FAIL_TO_PARSE_TEMPLATE",FAIL_TO_LOAD_JS_RESOURCE:"0004:FAIL_TO_LOAD_JS_RESOURCE",ONLY_ONE_MODEL_REF_CAN_BE_IN_ATTR:"0005: ONLY_ONE_MODEL_REF_CAN_BE_IN_ATTR",BAD_FORMAT_OF_STYLE_IN_ATTRIBUTE:"0006: BAD_FORMAT_OF_STYLE_IN_ATTRIBUTE",ONLY_ONE_MODEL_REF_CAN_BE_IN_STYLE_PROP:"0007: ONLY_ONE_MODEL_REF_CAN_BE_IN_STYLE_PROP",FAIL_TO_LOAD_PATTERN_IN_COMPONENT:"0008: FAIL_TO_LOAD_PATTERN_IN_COMPONENT"},pattern:{CANNOT_FIND_SOURCE_OF_TEMPLATE:"1000:CANNOT_FIND_SOURCE_OF_TEMPLATE",CANNOT_DETECT_HOOK_VALUE:"1001:CANNOT_DETECT_HOOK_VALUE",CANNOT_DETECT_HOOK_ANCHOR:"1002:CANNOT_DETECT_HOOK_ANCHOR"},caller:{CANNOT_INIT_PATTERN:"3000:CANNOT_INIT_PATTERN"},controller:{CONTROLLER_DEFINED_MORE_THAN_ONCE:"4000:CONTROLLER_DEFINED_MORE_THAN_ONCE"},layout:{PATTERN_SRC_DEFINED_TWICE_OR_MORE:"5000:PATTERN_SRC_DEFINED_TWICE_OR_MORE",PATTERN_SRC_OR_NAME_IS_TOO_SHORT:"5001:PATTERN_SRC_OR_NAME_IS_TOO_SHORT",HOOK_SRC_DEFINED_TWICE_OR_MORE:"5002:HOOK_SRC_DEFINED_TWICE_OR_MORE",HOOK_SRC_OR_NAME_IS_TOO_SHORT:"5003:HOOK_SRC_OR_NAME_IS_TOO_SHORT",HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS:"5004:HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS"}},n={proto:function(o){var r=this,l=null,a=null,i=null,s=null,p=null,g=null,E=null,y=null,O=null,v=null;return l=function(t,n){var l=null,a=null,s=null;return null===o.html?(s=c.get(r.url),null!==s&&e.get().USE_STORAGE_HTML===!0?i(s,t,n):(l=d.measure(),a=flex.ajax.send(r.url,flex.ajax.methods.GET,null,{success:function(e,o){d.measure(l,"loading sources for ("+r.url+")"),i(e.original,t,n)},fail:function(e,t){throw d.measure(l,"loading sources for ("+r.url+")"),flex.logs.log(O()+f.source.FAIL_TO_LOAD_TEMPLATE,flex.logs.types.CRITICAL),y(n),f.source.FAIL_TO_LOAD_TEMPLATE}}),a.send())):flex.logs.log(O()+f.source.TEMPLATE_WAS_LOADED,flex.logs.types.NOTIFICATION),!0},a={URLs:function(e){var t=flex.system.url.restore(r.url);return null!==t&&(e=e.map(function(e){var n=flex.system.url.parse(e,t);return null!==n&&n.url}),e=e.filter(function(e){return e!==!1})),e},html:function(e,n,r){var l=t.regs,a=e.match(l.BODY);return null!==a&&1===a.length?(o.html=a[0].replace(l.BODY_TAG,"").replace(l.BODY_CLEAR,""),o.original=e,E.getSRCs()?E.load(n):(g.procced(),n()),!0):(o.html=null,r(),!1)},css:function(){var e=t.regs,n=null!==o.original?o.original.match(e.CSS):null,r=[];null!==n&&Array.prototype.forEach.call(n,function(t){function n(t){var n=t.search(e.CSS_REL),o=t.search(e.CSS_TYPE);return n>0&&o>0}var o=t.match(e.CSS_HREF),l=null;n(t)!==!1&&null!==o&&1===o.length&&(l=o[0].match(e.STRING),null!==l&&1===l.length&&r.push(l[0].replace(e.STRING_BORDERS,"")))}),o.css=a.URLs(r)},js:function(){var e=t.regs,n=null!==o.original?o.original.match(e.JS):null,r=[];null!==n&&Array.prototype.forEach.call(n,function(t){function n(t){var n=t.search(e.JS_TYPE);return n>0}var o=t.match(e.JS_SRC),l=null;n(t)!==!1&&null!==o&&1===o.length&&(l=o[0].match(e.STRING),null!==l&&1===l.length&&r.push(l[0].replace(e.STRING_BORDERS,"")))}),o.js=a.URLs(r)}},i=function(e,t,n){function l(e){s.css.load(function(){s.js.load(function(){e||c.add(r.url,{original:o.original,html:o.html,js:o.js,css:o.css,map:o.map,flags:o.flags}),y(t)},function(){y(n)})})}"string"==typeof e?a.html(e,function(){a.js(),a.css(),l(!1)},function(){flex.logs.log(O()+f.source.FAIL_TO_PARSE_TEMPLATE,flex.logs.types.NOTIFICATION),y(n)}):"object"==typeof e&&(o.original=e.original,o.html=e.html,o.js=e.js,o.css=e.css,o.map=e.map,o.flags=e.flags,l(!0))},s={css:{load:function(n){var l=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CSS_ATTACHED_JOURNAL,{}),a=flex.unique();null!==o.css&&o.css.length>0?(flex.overhead.register.open(a,o.css,n),Array.prototype.forEach.call(o.css,function(t){var n=null,o=null;l[t]?flex.overhead.register.done(a,t):(l[t]=!0,n=c.get(t),null===n||e.get().USE_STORAGE_CSS===!1?(o=d.measure(),flex.resources.attach.css.connect(t,function(e){var t=flex.resources.parse.css.stringify(e);null!==t&&c.add(e,t),null!==a&&flex.overhead.register.done(a,e),d.measure(o,"loading resources for ("+r.url+"):: "+e)})):(flex.resources.attach.css.adoption(n,null,t),flex.overhead.register.done(a,t),c.add(t,n)))})):y(n)}},js:{load:function(l,a){var i=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.JS_ATTACHED_JOURNAL,{}),s=flex.unique();null!==o.js&&o.js.length>0?(flex.overhead.register.open(s,o.js,l),Array.prototype.forEach.call(o.js,function(t){var o=null,l=null,h=function(){flex.overhead.register.done(s,t);var e=flex.ajax.send(t,flex.ajax.methods.GET,null,{success:function(e,n){c.add(t,e.original)}});e.send(),d.measure(l,"loading resources for ("+r.url+"):: "+t)},p=function(){throw flex.logs.log(O()+f.source.FAIL_TO_LOAD_JS_RESOURCE,flex.logs.types.CRITICAL),d.measure(l,"loading resources for ("+r.url+"):: "+t),y(a),f.source.FAIL_TO_LOAD_JS_RESOURCE};void 0===i[t]?(u.references.assign(t,r.url),i[t]=!0,o=c.get(t),null===o||e.get().USE_STORAGE_JS===!1?(l=d.measure(),n.resource.isIn(t)?n.resource.isDone(t)?flex.overhead.register.done(s,t):n.resource.add(t,function(){flex.overhead.register.done(s,t)}):(n.resource.add(t,h),flex.resources.attach.js.connect(t,function(){n.resource.done(t)},p))):(u.current.set(t),flex.resources.attach.js.adoption(o,function(){flex.overhead.register.done(s,t),u.current.reset(t)}),c.add(t,o))):n.resource.isDone(t)?flex.overhead.register.done(s,t):n.resource.add(t,function(){flex.overhead.register.done(s,t)})})):y(l)}}},y=function(e){"function"==typeof e&&e.call(o.__instance,r.url,r.original_url,o.__instance)},E={getSRCs:function(){function t(n,r){Array.prototype.forEach.call(n,function(n){var l=n.getAttribute(e.get().PATTERN_SRC),a=null;null!==l&&""!==l&&(!~o.srcs.indexOf(l)&&o.srcs.push(l),a=n.nodeName.toLowerCase(),a===e.get().PATTERN_NODE?(r.src=l,r.hooks={},void 0!==n.children&&t(n.children,r.hooks)):(r[a]={src:l,hooks:{}},void 0!==n.children&&t(n.children,r[a].hooks)))})}var n=document.createElement("DIV");return n.innerHTML=o.html,o.srcs=[],o.map.component={},t(n.children,o.map.component),0===o.srcs.length&&(o.map.component=null),0===o.srcs.length&&(o.srcs=null),null!==o.srcs},load:function(e){n.init(o.srcs,e,E.onFail)},onFail:function(){var e=function(){this.urls=o.srcs,this.code=f.source.FAIL_TO_LOAD_PATTERN_IN_COMPONENT,this.message=O()+f.source.FAIL_TO_LOAD_PATTERN_IN_COMPONENT+":: URLs = "+JSON.stringify(o.srcs)},t=new e;throw flex.logs.log(t.message,flex.logs.types.CRITICAL),t}},g={map:{getting:function(e,t,n,r){var l=o.html.match(e),a={};l instanceof Array&&l.forEach(function(e){e=e.replace(t,""),e=e.split(","),e instanceof Array&&e.forEach(function(e){a[e]=!r||(void 0===a[e]?1:a[e]+=1)})}),o.map[n]=a},model:function(){g.map.getting(t.regs.MODEL,t.regs.MODEL_BORDERS,"model",!1)},dom:function(){g.map.getting(t.regs.DOM,t.regs.DOM_BORDERS,"dom",!0)}},binding:{model:function(){function e(n){var o={};return _object(n).forEach(function(n,r){var l=t.other.BIND_PREFIX+n;"object"==typeof r?o[n]=e(r):r===!0&&(Object.defineProperty(o,n,{get:function(){return this[l].val},set:function(e){var t=this[l].val;this[l].val=e,this[l].handle(e,t)},configurable:!0,enumerable:!0}),o[l]={val:"",handles:{},bind:function(e){var t=null;return"function"==typeof e&&(t=flex.unique(),this.handles[t]=e),t},unbind:function(e){return void 0!==this.handles[e]&&(delete this.handles[e],!0)},handle:function(e,t){_object(this.handles).forEach(function(n,o){o(e,t)})}},o[l].bind.bind(o[l]),o[l].unbind.bind(o[l]),o[l].handle.bind(o[l]))}),o}var n=null===o.binding.model?null!==o.map.model?e(o.map.model):null:o.binding.model;return o.binding.model=n,n}},attrs:{parse:function(e){var t=e.split("=");return{name:t[0].replace(/\s/gi,""),value:t[1].replace(/^\s*|\s*$/gi,"").replace(/(^"|"$)|(^'|'$)/gi,"")}},parseStyle:function(e){var t=e.split(";"),n=[];return t.forEach(function(t){var o=flex.unique(),t=t.replace(/::/gi,o),r=t.split(":");""!==t&&(2===r.length?n.push({name:r[0].replace(/\s/,""),value:r[1].replace(/^\s*|\s*$/,"").replace(new RegExp(o,"gi"),"::")}):flex.logs.log(O()+f.source.BAD_FORMAT_OF_STYLE_IN_ATTRIBUTE+". Style value in attr: ("+e+")",flex.logs.types.WARNING))}),n}},fix:function(){var e=o.html.match(t.regs.ALL);e instanceof Array&&e.forEach(function(e){o.html=o.html.replace(e,e.replace(/\s|\t|\r|\n/gi,""))})},tags:{get:function(){var e=null;return void 0===r.tags&&(e=o.html.match(t.regs.TAGS),e=e instanceof Array?e:[],r.tags=[],e.forEach(function(e){r.tags.push({org:e,mod:e})})),r.tags},accept:function(){r.tags instanceof Array&&r.tags.forEach(function(e){o.html=o.html.replace(e.org,e.mod)})}},hooks:{find:function(){var e=t.regs,n=o.html.match(e.HOOK);n instanceof Array&&n.forEach(function(n){var r=n.replace(e.HOOK_BORDERS,"");o.html=o.html.replace(n,e.HOOK_OPEN_STR+t.other.PARENT_MARK_HTML+r+e.HOOK_CLOSE_STR)})}},dom:{find:function(){var e=g.tags.get(),n=t.regs;e.forEach(function(e,o){var r=e.mod.match(n.DOM),l=[];r instanceof Array&&(r.forEach(function(e){var t=e.replace(n.DOM_BORDERS,"").split(",");l=l.concat(t.filter(function(e){return""!==e}))}),function(){var e=[];l=l.filter(function(t){return e.indexOf(t)===-1&&(e.push(t),!0)})}(),l=l.map(function(e){return t.other.PARENT_MARK_HTML+e}),void 0===e.tag&&(e.tag=e.mod.match(n.OPEN_TAG)[0]),e.mod=e.mod.replace(n.DOM,""),e.mod=e.mod.replace(e.tag,e.tag+" "+t.css.attrs.DOM+'="'+l.join(",")+'" '))})}},model:{inAttrs:function(){var e=g.tags.get(),n=t.regs;e.forEach(function(e,r){var l={},a=null;h.testReg(n.MODEL,e.mod)&&(a=e.mod.match(n.ATTRS),a instanceof Array&&a.forEach(function(o){var r=null,a=null,i=null;h.testReg(n.MODEL,o)&&(r=g.attrs.parse(o),"style"===r.name?(i=g.attrs.parseStyle(r.value),i.forEach(function(o){a=o.value.match(n.MODEL),a instanceof Array&&(a.length>1&&flex.logs.log(O()+f.source.ONLY_ONE_MODEL_REF_CAN_BE_IN_STYLE_PROP+". HTML fragment: ("+e.mod+"), Style prop: ("+o.value+")",flex.logs.types.WARNING),a=a[0],l["style."+o.name]=t.other.PARENT_MARK_HTML+a.replace(n.MODEL_BORDERS,""))})):(a=r.value.match(n.MODEL),a instanceof Array&&(a.length>1&&flex.logs.log(O()+f.source.ONLY_ONE_MODEL_REF_CAN_BE_IN_ATTR+". HTML fragment: ("+e.mod+"), Attr: ("+r.name+")",flex.logs.types.WARNING),a=a[0],l[r.name]=t.other.PARENT_MARK_HTML+a.replace(n.MODEL_BORDERS,""))),e.mod=e.mod.replace(o,""))}),Object.keys(l).length>0&&(void 0===e.tag&&(e.tag=e.mod.match(n.OPEN_TAG)[0]),e.mod=e.mod.replace(e.tag,e.tag+" "+t.css.attrs.MODEL+"='"+JSON.stringify(l)+"' "),o.flags.has_model=!0))})},inNodes:function(){var e=t.regs,n=o.html.match(e.INSIDE_TAG);n instanceof Array&&n.forEach(function(n){var r=null,l=n;h.testReg(e.MODEL,n)&&(r=l.match(e.MODEL),r.forEach(function(n){var o=n.replace(e.MODEL_BORDERS,"");o=e.MODEL_OPEN_STR+t.other.PARENT_MARK_HTML+o+e.MODEL_CLOSE_STR,l=l.replace(n,'<span class="'+t.css.classes.MODEL_NODE+'" style="display:none;">'+o+"</span>")}),o.html=o.html.replace(n,l),r.length>0&&(o.flags.has_model=!0))})}},conditions:{find:function(){var e=o.html.match(t.regs.CONDITIONS),n=[],r=o.html,l=null,a=null;e instanceof Array&&(o.map.conditions={},e=e.map(function(e){var r=e.replace(t.regs.COMMENT_BORDERS,""),l=r.split("=")[0];return n.indexOf(l)===-1&&n.push(l),o.map.conditions[r]=void 0===o.map.conditions[r]?1:o.map.conditions[r]+1,{value:r,name:l,content:"",corrected:""}}),e.forEach(function(e){var n=r.match(new RegExp(t.regs.CONDITION_CONTENT.replace("[open]",e.value).replace("[close]",e.name),"gi"));n instanceof Array&&(e.content=n,e.corrected=n,n.forEach(function(n,o){var l=n.match(t.regs.OPEN_TAG);l instanceof Array&&(l=function(e){var t={};return e.filter(function(e){return void 0===t[e]&&(t[e]=!0,!0)})}(l),l.forEach(function(n){e.corrected[o]=e.corrected[o].replace(new RegExp(n,"gi"),n+" "+t.css.attrs.CONDITION+'="'+t.other.PARENT_MARK_HTML+e.value+'"')}),r=r.replace(n,e.corrected[o]))}))}),l=r.match(new RegExp(t.css.attrs.CONDITION+"="+t.regs.STRING_CON_STR,"gi")),l instanceof Array&&(a=new RegExp(t.css.attrs.CONDITION+"="+t.regs.STRING_CON_STRICT,"gi"),l.forEach(function(e){var n=e.match(a),o=n.join(" "),l=o.match(t.regs.STRING_CON),i="";l instanceof Array&&l.length>1&&(l.reverse().forEach(function(e,n){i+=e.replace(t.regs.STRING_BORDER_CON,"")+(n<l.length-1?",":"")}),r=r.replace(o,t.css.attrs.CONDITION+'="'+i+'"'))})),e.forEach(function(e){var n=new RegExp("<\\!--"+e.name,"gi");r=r.replace(n,"<!--"+t.other.PARENT_MARK_HTML+e.name)}),e.length>0&&(o.flags.has_conditions=!0),o.html=r)}},events:{find:function(){var e=g.tags.get(),n=t.regs,l=[],a=h.getHash(r.url).replace("-","0"),i=0;e.forEach(function(e,t){var r=e.mod.match(n.EVENT_ATTR),s=[];r instanceof Array&&(r.forEach(function(e){var t=e.replace(n.EVENT_BORDERS,"").replace(/["']/gi,"").split("=");2===t.length&&s.push({event:t[0].replace(/^on/i,""),handle:t[1],id:a+i++,attr:e})}),function(){var e=[];s=s.filter(function(t){return e.indexOf(t.event)===-1&&(e.push(t.event),!0)})}(),s.forEach(function(t){e.mod=e.mod.replace(t.attr,n.DOM_OPEN_STR+t.id+n.DOM_CLOSE_STR)}),o.html=o.html.replace(e.org,e.mod),e.org=e.mod,l=l.concat(s))}),o.map.events=l}},procced:function(){g.fix(),g.hooks.find(),g.events.find(),g.map.model(),g.map.dom(),g.conditions.find(),g.model.inNodes(),g.model.inAttrs(),g.dom.find(),g.tags.accept()}},p={get:function(e){var n=o.html,e="string"==typeof e&&e,r="__no_parent__";return e!==!1?void 0===o.cache.html[e]?(n=n.replace(new RegExp(t.other.PARENT_MARK_HTML,"gi"),e+"."),o.cache.html[e]=n):n=o.cache.html[e]:void 0===o.cache.html[r]?(n=n.replace(new RegExp(t.other.PARENT_MARK_HTML,"gi"),""),o.cache.html[r]=n):n=o.cache.html[r],n}},O=function(){return f.SIGNATURE+":: pattern ("+r.url+")"},v={load:l,html:p.get,map:function(){return o.map},flags:function(){return o.flags}},{load:v.load,html:v.html,map:v.map,binding:{model:g.binding.model},flags:v.flags}},instance:function(e){return flex.oop.objects.validate(e,[{name:"url",type:"string"},{name:"html",type:"string",value:null},{name:"css",type:"array",value:null},{name:"js",type:"array",value:null}])!==!1?_object({parent:t.classes.SOURCE,constr:function(){this.url=flex.system.url.restore(e.url),this.original_url=e.url},privates:{original:null,html:e.html,css:e.css,js:e.js,map:{model:null,dom:null,conditions:null,events:null,component:null},binding:{model:null},cache:{html:{},regs:{}},flags:{has_model:!1,has_conditions:!1}},prototype:n.proto}).createInstanceClass():null},storage:{add:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_SOURCES,{});void 0===o[e]&&(o[e]=n)},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_SOURCES,{});return void 0!==n[e]?n[e]:null}},resource:{add:function(e,t){void 0===n.resource.data&&(n.resource.data={}),void 0===n.resource.data[e]&&(n.resource.data[e]={handles:[],status:!1}),n.resource.data[e].handles.push(t)},done:function(e){void 0===n.resource.data&&(n.resource.data={}),void 0!==n.resource.data[e]&&(n.resource.data[e].status=!0),_object(n.resource.data).forEach(function(e,t){t.status&&(t.handles.forEach(function(e){e()}),t.handles=[])})},isDone:function(e){return void 0===n.resource.data&&(n.resource.data={}),void 0!==n.resource.data[e]&&n.resource.data[e].status},isIn:function(e){return void 0===n.resource.data&&(n.resource.data={}),void 0!==n.resource.data[e]}},init:function(e,o,r){var l=e instanceof Array?e:[e],a=(flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PRELOAD_TRACKER,{}),flex.unique()),i=[],s=!1;flex.overhead.register.open(a,l,function(){"function"!=typeof o||s?flex.system.handle(r):o(i)}),l.forEach(function(e){var t=n.storage.get(e);null!==t?(i.push(t),flex.overhead.register.done(a,e)):(t=n.instance({url:e}),t.load(function(e,t,o){i.push(o),n.storage.add(t,o),flex.overhead.register.done(a,t)},function(e,t,n){s=!0,flex.overhead.register.done(a,t)}))})}},o={proto:function(r){var i=this,s=null,c=null,d=null,g=null,E=null,v=null,m=null,_=null,R=null,A=null,T=null,N=null,b={maps:{MODEL:"model",DOM:"dom"}};return g={get:function(e){function o(r,a){function i(e,n){_object(e).forEach(function(e,r){r instanceof t.classes.CALLER?n[t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END]=o(r.url,r.hooks):"object"==typeof r&&null!==r&&(n[e]={},i(r,n[e]))})}var s=void 0===l[r]?n.storage.get(r).map()[e]:l[r],u=[];return l[r]=s,null!==a?a.forEach(function(e){var t=_object(s).copy();i(e,t),u.push(t)}):u.push(_object(s).copy()),u}var l={};return o(i.url,r.hooks)},refs:function(){function e(e,t,o,r){var l=t.split(".");l.forEach(function(a,i){var s=null;i<l.length-1?(void 0===e[a]&&(e[a]={url:"",hooks:{}}),e=e[a].hooks):(s=n.storage.get(o),e[a]={url:o,hooks:{},events:null!==s?s.map().events:null,controller:m.convert(r.controller,o),path:t})})}function o(n,r){h.isArray(n)?n.forEach(function(e){o(e,r)}):n instanceof t.classes.CALLER?(void 0===a[r]&&(a[r]=!0,e(l,r,n.url,n)),o(n.hooks,r)):n instanceof Object&&_object(n).forEach(function(e,t){o(t,(""!==r?r+".":"")+e)})}var l=r.caller.map,a={};0===Object.keys(l).length&&(l=y.storage.get(i.url),null===l&&(l={})),0===Object.keys(l).length&&o(r.hooks,""),r.map.refs={url:i.url,hooks:l,events:i.source.map().events,controller:r.controller,path:""}}},c={nodes:function(){var e=_nodes("."+t.css.classes.MODEL_NODE,!1,r.wrapper).target,n={},o={};return null!==e&&e.length>0&&Array.prototype.forEach.call(e,function(e){var r=e.innerHTML,l=void 0!==o[r]?o[r]:r.replace(t.regs.MODEL_BORDERS,""),a=document.createTextNode("");o[r]=l,n[l]=void 0===n[l]?[]:n[l],e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e),n[l].push(a)}),n},attrs:function(){var e=_nodes("*["+t.css.attrs.MODEL+"]",!1,r.wrapper).target,n={},o={};return null!==e&&e.length>0&&Array.prototype.forEach.call(e,function(e){var r=e.getAttribute(t.css.attrs.MODEL),l=void 0!==o[r]?o[r]:JSON.parse(r);o[r]=l,_object(l).forEach(function(t,o){n[o]=void 0===n[o]?[]:n[o],n[o].push({node:e,attr:t})}),e.removeAttribute(t.css.attrs.MODEL)}),n},bind:function(){function e(e){var t=r.map.refs,n=e.split("."),o=!0;return n.forEach(function(e){null!==t&&void 0!==t.hooks[e]?t=t.hooks[e]:o=!1}),o}function o(i,u,c){function f(n,r,l){_object(n).forEach(function(n,a){var i=n;a instanceof t.classes.CALLER?(i=t.other.SUBLEVEL_BEGIN+i+t.other.SUBLEVEL_END,r[i]=o(a.url,a.hooks,l+(""===l?"":".")+i)):"object"==typeof a&&null!==a?(r[i]={},f(a,r[i],l+(""===l?"":".")+i)):null!==a&&void 0!==a||e((""!==l?l+".":"")+n)&&(i=t.other.SUBLEVEL_BEGIN+i+t.other.SUBLEVEL_END,r[i]=new O)})}var d=void 0===l[i]?n.storage.get(i).binding.model():l[i],p=new O,g=1===r.wrapper.children.length?r.wrapper.children[0]:null;return l[i]=d,null!==u?u.forEach(function(e){var n=Object.create(d);flex.oop.objects.copy(d,n),_object(n).forEach(function(o,r){var l=c+(""===c?"":".")+o,i=null,u=null;void 0!==a[l]&&a[l].length>0&&(!function(e){n[t.other.BIND_PREFIX+o].bind(function(t,n){e.nodeValue=t})}(a[l][0]),a[l].splice(0,1)),void 0!==s[l]&&s[l].length>0&&(i=s[l][0].attr,function(e){h.binds.isPossible(e,i)&&h.binds.assing(e,i,function(e,t,r){var l=t();n[o]!==l&&(n[o]=l)}),n[t.other.BIND_PREFIX+o].bind(function(t,n){var o=i.split("."),r=e;1===o.length?e.getAttribute(i)!==t&&e.setAttribute(i,t):1===o.length&&void 0!==e[i]?e[i]!==t&&(e[i]=t):o.forEach(function(e,n){n!==o.length-1?r=null!==r&&void 0!==r[e]?r[e]:null:null!==r&&void 0!==r[e]&&r[e]!==t&&(r[e]=t)})}),null!==g&&(i.indexOf(".")===-1&&void 0===e[i]?_node(e).bindingAttrs().bind(i,function(e,t,r,l,a){n[o]!==t&&(n[o]=t)},g):_node(e).bindingProps().bind(i,function(e,t,r,l,a){n[o]!==t&&(n[o]=t)},g))}(s[l][0].node),s[l].splice(0,1)),void 0===e[o]||e[o]instanceof t.classes.CALLER||e[o]instanceof Object||("function"==typeof e[o]?u=e[o]():"string"==typeof e[o]?u=e[o]:"function"==typeof e[o].toString&&(u=e[o].toString()),n[o]=u)}),f(e,n,c),p.push(n)}):p.push(_object(d).copy()),p}var l={},a=c.nodes(),s=c.attrs();r.map.model=o(i.url,r.hooks,"")},combine:function(){function e(n,l,i){function s(n,l,i){_object(n).forEach(function(n,u){u instanceof a.nodeList.NODE_LIST?(l[t.other.DOM_PREFIX+n]=u,void 0===r.cache.dom[n]&&(r.cache.dom[n]=[]),r.cache.dom[n].push({nodeList:u,path:i})):h.isArray(u)?(l[n]=void 0!==l[n]?l[n]:[],e(u,l[n],(""!==i?i+".":"")+n.replace(o,""))):u instanceof Object&&(l[n]=void 0!==l[n]?l[n]:{},s(u,l[n],(""!==i?i+".":"")+n.replace(o,"")))})}n.forEach(function(e,t){void 0===l[t]&&l.push({}),s(n[t],l[t],i)})}var n=d.bind(),o=new RegExp("^"+t.other.SUBLEVEL_BEGIN+"|"+t.other.SUBLEVEL_END+"$","gi");h.isArray(n)&&(r.map.model=h.isArray(r.map.model)?r.map.model:new O,e(n,r.map.model,""))},finalize:function(){function e(e){var t=e.split("."),n=r.map.refs;return null!==n&&t.forEach(function(e){void 0!==n.hooks&&void 0!==n.hooks[e]&&(n=n.hooks[e])}),n}function n(e){var t=e.split("."),n=r.map.refs,o=null;return null!==n&&t.forEach(function(e){void 0!==n.hooks&&void 0!==n.hooks[e]&&o!==!1?(n=n.hooks[e],o=n.url):o=!1}),null!==o&&o}function o(n,o,r){function l(e){var n=e.split("."),o="";return n.forEach(function(e){o+=(""!==o?".":"")+t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END}),o}var i=void 0===a[o]?l(o):a[o],s=E.anchors.get(i),u=null;a[o]=i,null!==s?(u=c.collection(r,s,n,e(o),d.indexes),n.bind("add",u.add),n.bind("remove",u.remove)):flex.logs.log(A()+f.pattern.CANNOT_DETECT_HOOK_ANCHOR,flex.logs.types.WARNING)}function l(e,r,a){function i(e,r,a){_object(e).forEach(function(e,s){var u=null,c=null;s instanceof t.classes.CALLER?(u=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END,void 0===r[u]&&(r[u]=new O),o(r[u],(""!==a?a+".":"")+e,s.url),l(s.hooks,r[u],(""!==a?a+".":"")+e)):s instanceof Object?(void 0===r[e]&&(r[e]={}),i(s,r[e],(""!==a?a+".":"")+e)):null===s?(c=n((""!==a?a+".":"")+e),c!==!1?(u=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END,void 0===r[u]&&(r[u]=new O),o(r[u],(""!==a?a+".":"")+e,c)):void 0===r[e]&&(r[e]=s)):void 0===r[e]&&(r[e]=s)})}e.forEach(function(e,t){void 0===r[t]&&r.push({}),i(e,r[t],a)})}var a={};return h.isArray(r.hooks)&&(r.map.model=h.isArray(r.map.model)?r.map.model:new O,l(r.hooks,r.map.model,"")),r.map.model},collection:function(e,t,n,o,r){var i=function(e,t){var i=this,s=null,u=null,c=null,f=null,d=null,p=null,g=r,E=null;return this.url=e,this.anchor=t,this.parent=n,this.refs=o,this.start=null,u=function(){var e=i.anchor.parentNode,t=null;if(null===i.start){try{Array.prototype.forEach.call(e.childNodes,function(e){if(e===i.anchor)throw"found";e instanceof Element&&(t=e)})}catch(e){}null!==t?i.start=Array.prototype.indexOf.call(e.children,t)+1:i.start=0}return i.start},c=function(e,t,n){var o=i.anchor.parentNode,r=null,l=u(),a=l+(i.parent.length-2);if(i.parent.length-1===t+(n-1))if(o.children.length-1>a){r=o.children[a+1];for(var s=e.length-1;s>=0;s-=1)o.insertBefore(e[0],r)}else for(var s=e.length-1;s>=0;s-=1)o.appendChild(e[0]);else if(void 0!==o.children[l+t]){r=o.children[l+t];for(var s=e.length-1;s>=0;s-=1)o.insertBefore(e[0],r)}},f=function(e,t){var n=null!==i.anchor.parentNode?i.anchor.parentNode.children:null,o=null,r=u();if(null!==n.length&&void 0!==n[r+e])for(var l=t-1;l>=0;l-=1)o=n[r+e+l],o.parentNode.removeChild(o)},p=function e(t,n){var n=null===n?null:void 0!==n.hooks?n.hooks:null;return null!==n&&t.forEach(function(o,r){_object(o).forEach(function(o,a){void 0!==n[o]&&(t[r][o]=l.instance({url:n[o].url,hooks:e(h.isArray(a)?a:[a],n[o])}))})}),t},s=function(e){var t=h.isArray(e.item)?e.item:[e.item],n=l.instance({url:i.url,hooks:p(t,i.refs)});n=n.build(),t.forEach(function(t,o){i.parent[e.index+o]=1===n.model[o].length?n.model[o][0]:n.model[o]}),c(n.nodes,e.index,e.count),E.add(n.model),g()},d=function(e){f(e.index,e.count),E.remove(h.isArray(e.item)?e.item:[e.item]),g()},E={add:function(e){e.forEach(function(e){e instanceof Object&&_object(e).forEach(function(e,t){t instanceof a.nodeList.NODE_LIST&&(void 0===i.parent[e]&&(i.parent[e]=a.nodeList.create()),
i.parent[e].add(t))})})},remove:function(e){e.forEach(function(e){e instanceof Object&&_object(e).forEach(function(e,t){t instanceof a.nodeList.NODE_LIST&&void 0!==i.parent[e]&&(void 0===i.parent[e]&&(i.parent[e]=a.nodeList.create()),i.parent[e].exclude(t))})})}},{add:s,remove:d}};return new i(e,t)}},d={nodes:function(){var e=_nodes("*["+t.css.attrs.DOM+"]",!1,r.wrapper).target,n={},o={};return null!==e&&e.length>0&&Array.prototype.forEach.call(e,function(e){var r=e.getAttribute(t.css.attrs.DOM),l=void 0!==o[r]?o[r]:r.split(",");o[r]=l,l.forEach(function(t){n[t]=void 0===n[t]?[]:n[t],n[t].push(e)}),e.removeAttribute(t.css.attrs.DOM)}),n},bind:function(){function e(n,o){var r=null;return n instanceof Array?(r=[],n.forEach(function(t){r.push(e(t,o))})):"object"==typeof n?(r={},_object(n).forEach(function(t,n){r[t]=e(n,o+(""===o?"":".")+t)})):"number"==typeof n&&void 0!==t[o]&&t[o].length>=n&&(r=a.nodeList.create(t[o].slice(0,n)),t[o].splice(0,n)),r}var t=d.nodes(),n=g.get(b.maps.DOM);return e(n,"")},indexes:function(){function e(t,n,o){h.isArray(t)?t.forEach(function(t,r){e(t,n.concat([r]),o)}):t instanceof Object&&_object(t).forEach(function(t,r){r instanceof a.nodeList.NODE_LIST?(r.setIndexes(n),null!==o&&(void 0===o[t]&&(o[t]=a.nodeList.create()),o[t].add(r))):h.isArray(r)&&e(r,n,r)})}h.isArray(r.map.model)&&e(r.map.model,[],null)}},s={cache:{load:function(e,n){var l=r.cache.html,n=n instanceof Object&&n,a={};if(h.isArray(r.hooks))return r.hooks.forEach(function(n){_object(n).forEach(function(n,o){var r=null,l=null,i=null;o instanceof t.classes.CALLER&&(r=t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END,l=(e===!1?"":e+".")+r,i=l+o.url,a[i]=void 0!==a[i]?a[i]:{url:o.url,hooks:[],path:l},h.isArray(o.hooks)?a[i].hooks=a[i].hooks.concat(o.hooks.getOriginal()):a[i].hooks.push(o.hooks))})}),_object(a).forEach(function(e,t){var r=o.instance({id:flex.unique(),url:t.url,hooks:t.hooks});r=r.html(t.path,n),l[e]={hooks:t.hooks,html:r.html,fragments:r.fragments,parent:t.path,cursor:0}}),l}},getHTML:function(e,n,o,l){var a=!1,i=null,s=null,u=(e===!1?"":e+".")+t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END;return o instanceof t.classes.CALLER&&(s=u+o.url,void 0!==r.cache.html[s]&&(i=r.cache.html[s],a={html:"<!--"+t.other.ANCHOR+u+"-->"+i.fragments.slice(i.cursor,i.cursor+o.hooks.length).join(""),fragments:null,original:i.original},i.cursor+=o.hooks.length)),a},build:function(e,n){var e="string"==typeof e&&e,n=n instanceof Object&&n,o="",l=null,a=t.regs,u=_.reset().regs,c=[],f=N.getCache();return null===f?(l=i.source.html(e),h.isArray(r.hooks)&&(s.cache.load(e,n),r.hooks.forEach(function(t,r){var i=l;_object(t).forEach(function(t,n){var o=(e?e+".":"")+t,l=s.getHTML(e,t,n,r);u[o]=void 0===u[o]?new RegExp(a.HOOK_OPEN+o.replace(/\./gi,"\\.")+a.HOOK_CLOSE,"gi"):u[o],i=l!==!1?i.replace(u[o],l.html):i,i=l!==!1?i:E.insert(o,n,i)}),i=v.html(i,v.getByPath(e?e:"",n),t,e),o+=i,c.push(i)})),r.html=""!==o?o:l,N.setCache({html:r.html,fragments:0===c.length?[l]:c}),0===c.length?[l]:c):(r.html=f.html,f.fragments)},wrap:function(){r.wrapper=h.getPattern(r.html),r.wrapper.innerHTML=r.html},map:function(){function e(o,r,l,a){var i="",s=null;o instanceof t.classes.CALLER?(i=t.other.SUBLEVEL_BEGIN+l+t.other.SUBLEVEL_END,void 0===a[i]&&(s=n.storage.get(o.url),r=(""===r?"":r+".")+i,a.inc=void 0===a.inc?[]:a.inc,a[i]={url:o.url,html:s.html(r)},a.inc.push(i),e(o.hooks,r,l,a[i]))):h.isArray(o)?o.forEach(function(t){e(t,r,l,a)}):o instanceof Object&&_object(o).forEach(function(t,n){e(n,r,t,a)})}r.map.html={url:i.url,html:i.source.html("")},e(r.hooks,"","",r.map.html)}},E={cache:{},getValue:function(e,n){var o="";return n instanceof t.classes.CALLER?o=E.convert(n.hooks):"function"==typeof n?o=E.getValue(e,n()):"string"==typeof n?o=n:"object"==typeof n?(o={},_object(n).forEach(function(e,t){o[e]=E.getValue(e,t)})):"function"==typeof n.toString?o=n.toString():(flex.logs.log(A()+f.pattern.CANNOT_DETECT_HOOK_VALUE+". Hook name: ("+e+")",flex.logs.types.WARNING),o=""),o},convert:function(e){var t=[];return h.isArray(e)&&e.forEach(function(e){var n={};_object(e).forEach(function(e,t){n[e]=E.getValue(e,t)}),t.push(n)}),t},insert:function(e,n,o){function l(e,n,o){var o=void 0!==o?o:{};return _object(n).forEach(function(n,r){r instanceof t.classes.CALLER||"object"!=typeof r?o[e+"."+n]=r:l(e+"."+n,r,o)}),o}var a=r.cache.regs;return"object"==typeof n?(_object(l(e,n)).forEach(function(e,t){o=E.insert(e,t,o)}),o):(a[e]=void 0===a[e]?new RegExp(t.regs.HOOK_OPEN+e+t.regs.HOOK_CLOSE,"gi"):a[e],o.replace(a[e],E.getValue(e,n)))},anchors:{html:function(){function e(e){var n=e.split("."),o="";return n.forEach(function(e,r){o+=r===n.length-1?(""!==o?".":"")+t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END:(""!==o?".":"")+e}),o}var n=r.html.match(t.regs.HOOK),o=t.regs,l={},a={};n instanceof Array&&n.forEach(function(n){var i=n.replace(t.regs.HOOK_BORDERS,""),s=void 0!==l[i]?l[i]:new RegExp(o.HOOK_OPEN+i.replace(/\./gi,"\\.")+o.HOOK_CLOSE,"gi");l[i]=s,i=void 0===a[i]?e(i):a[i],a[i]=i,r.html=r.html.replace(s,"<!--"+t.other.ANCHOR+i+"-->")})},convert:function(){for(var e=document.createTreeWalker(r.wrapper,NodeFilter.SHOW_COMMENT,{acceptNode:function(e){return~e.nodeValue.indexOf(t.other.ANCHOR)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1),n=[],o={};e.nextNode();)n.push(e.currentNode);n.forEach(function(e){var n=document.createTextNode(""),r=e.nodeValue.replace(t.other.ANCHOR,"");void 0===o[r]&&(o[r]=[]),o[r].push(n),e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)}),r.map.anchors=o},get:function(e){var t=null;return null!==r.map.anchors&&r.map.anchors[e]instanceof Array&&r.map.anchors[e].length>0&&(t=r.map.anchors[e][0],r.map.anchors[e].splice(0,1)),t}}},v={find:function(){function e(o,r){h.isArray(r)?r.forEach(function(t){e(o,t)}):"object"==typeof r&&_object(r).forEach(function(r,l){var a=null,i=null;l instanceof t.classes.CALLER?void 0===n[l.url]&&(a=t.other.SUBLEVEL_BEGIN+r+t.other.SUBLEVEL_END,i=_object(l.conditions).copy(),i=0===Object.keys(i).length?p.storage.get(l.url):i,o[a]=null!==i?i:{},e(o[a],l.hooks)):"object"==typeof l&&(o[r]={},e(o[r],l))})}var n={};return 0===Object.keys(r.conditions).length&&(r.conditions=p.storage.get(i.url),r.conditions=null===r.conditions?{}:r.conditions),e(r.conditions,r.hooks),r.conditions},html:function(e,o,l,a){var s=null,u=a!==!1?a+".":"",c=null,f=null,d="";return r.cache.html_conds=void 0===r.cache.html_conds?{regs:{},matches:{},removed:{}}:r.cache.html_conds,c=r.cache.html_conds,o!==!1&&(s=n.storage.get(i.url),null!==s&&s.flags().has_conditions&&!s.flags().has_model?(f=s.map().conditions,_object(o).forEach(function(n,o){var r=null,a=null,i=null;o instanceof Function&&(r=o(l),a=u+n+"="+r,i=null,c.regs[a]=void 0!==c.regs[a]?c.regs[a]:new RegExp(t.regs.CONDITION_CONTENT.replace("[open]",a.replace(".","\\.")).replace("[close]",(u+n).replace(".","\\.")),"gi"),i=e.match(c.regs[a]),i instanceof Array&&i.length>0&&i.forEach(function(t){e=e.replace(t,t.replace("<!--"+a+"-->","").replace("<!--"+u+n+"-->",""))}),c.regs[n]=void 0!==c.regs[n]?c.regs[n]:new RegExp(t.regs.CONDITION_CONTENT_ANY.replace("[open]",(u+n).replace(".","\\.")).replace("[close]",(u+n).replace(".","\\.")),"gi"),e=e.replace(c.regs[n],""),d+=""===d?u+n:"|"+u+n)}),c.regs[d]=void 0!==c.regs[d]?c.regs[d]:new RegExp(t.css.attrs.CONDITION+'=".*?('+d+').*?"',"gi"),e=e.replace(c.regs[d],"")):_object(o).forEach(function(t,n){var o=u+t,r="OPEN-"+o,l="CLOSE-"+o;c.removed[r]=void 0!==c.removed[r]?c.removed[r]:new RegExp("<\\!--"+o.replace(".","\\.")+"=.{1,}-->","gi"),c.removed[l]=void 0!==c.removed[l]?c.removed[l]:new RegExp("<\\!--"+o.replace(".","\\.")+"-->","gi"),e=e.replace(c.removed[r],""),e=e.replace(c.removed[l],"")})),e},getByPath:function(e,t){var n=e.split("."),o=void 0!==t&&t!==!1?t:r.conditions,l=r.cache.conditions;return""!==e&&void 0===l[e]&&(n.forEach(function(e){o=null!==o&&void 0!==o[e]&&"object"==typeof o?o[e]:null}),l[e]=null!==o?Object.keys(o).length>0?o:null:o),""!==e?l[e]:o},apply:function(){function e(){s||(Array.prototype.forEach.call(o,function(e,t){var n=document.createTextNode("");e.parentNode.insertBefore(n,e),e.__anchor=n}),s=!0)}function n(o,r,s,u){function c(e,t,n,o){var r=function(e,t,n,o){this.hooks=e,this.model=t,this.funcs=n,this.conds=o};return r.prototype={getter:function(){var e=this,t={};return _object(this.hooks).forEach(function(n,o){t[n]=void 0!==e.model[n]?e.model[n]:o}),t},results:function(e,t){var o={},r=this.getter();return void 0!==e&&(r[e]=t),_object(n).forEach(function(e,t){o[e]=t(r)}),o},update:function(e,t){var n=this.results(e,t);_object(this.conds).forEach(function(e,t){var o=!0;t.conds.forEach(function(e){o=o?n[e.con]===e.val:o}),o?t.nodes.forEach(function(e){void 0!==e.__anchor&&e.__anchor.parentNode.insertBefore(e,e.__anchor)}):t.nodes.forEach(function(e){null!==e.parentNode&&e.parentNode.removeChild(e)})})}},new r(e,t,n,o)}function f(e){_object(s).forEach(function(n,o){"object"!=typeof o&&void 0!==s[t.other.BIND_PREFIX+n]&&s[t.other.BIND_PREFIX+n].bind(function(t,o){e.update(n,t)})})}var d={},p={},g=[];h.isArray(o)?o.forEach(function(e,t){n(e,r,null!==s&&void 0!==s[t]?s[t]:null,o.length)}):"object"==typeof o&&(_object(a).forEach(function(e,t){var n=null;t.path===r&&(n=void 0===i[e]?l[e].length/u:i[e],i[e]=n,l[e].length>=n&&(d[e]={conds:t.conditions,nodes:l[e].slice(0,n)},l[e].splice(0,n)))}),Object.keys(d).length>0&&(p=v.getByPath(r),null!==p&&(g=c(o,s,p,d),null!==s&&Object.keys(s).length>0?(e(),f(g),g.update()):g.update())),_object(o).forEach(function(e,l){var a=null;l instanceof t.classes.CALLER?(a=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END,n(l.hooks,(""===r?"":r+".")+a,null!==s&&void 0!==s[a]?s[a]:null,-1)):h.isArray(l)&&o.forEach(function(e,t){n(e,r,null!==s&&void 0!==s[t]?s[t]:null,-1)})}))}var o=_nodes("*["+t.css.attrs.CONDITION+"]",!1,r.wrapper).target,l=null,a={},i={},s=!1;o instanceof NodeList&&(Array.prototype.forEach.call(o,function(e,n){var o=e.getAttribute(t.css.attrs.CONDITION);a[o]=void 0===a[o]?[]:a[o],a[o].push(e),e.removeAttribute(t.css.attrs.CONDITION)}),l=a,a={},_object(l).forEach(function(e,t){var n=e.split(","),o=n[0].split("=")[0];a[e]={path:o.indexOf(".")===-1?"":o.replace(/\.[\w\d_]{1,}$/gi,""),conditions:n.map(function(e){return e=e.split("="),{con:e[0].indexOf(".")===-1?e[0]:e[0].replace(/.*[^\w\d]/gi,""),val:e[1]}})}}),n(r.hooks,"",r.map.model,h.isArray(r.hooks)?r.hooks.length:1))}},m={convert:function(e,n){return e=null!==e?e:u.storage.get(n),e instanceof Function&&(void 0!==e.prototype[t.events.ONREADY]||void 0!==e.prototype[t.events.ONUPDATE]||void 0!==e.prototype[t.events.SETINSTNCE])?new e(r.__instance):e},init:function(){r.controller=m.convert(r.caller.controller,i.url),r.listener=null===r.listener?new a.listener.create(r.__instance):r.listener},events:function(){function e(t,o){var r=null;"object"==typeof t&&null!==t&&(o.push({path:t.path,controller:t.controller}),t.events instanceof Array&&t.events.length>0&&(r=o.map(function(e){return e.path}),r=r.reverse(),t.events.forEach(function(e){o.forEach(function(t,o){var l=r[o]+(""!==r[o]?".":"")+e.handle,a=null;null!==t.controller&&"object"==typeof t.controller&&(a=_object(t.controller).getByPath(l),void 0!==n[e.id]&&(a instanceof Function?n[e.id].forEach(function(n){~r.indexOf(n.path)&&(a=a.bind(t.controller),n.nodeList.on(e.event,a))}):a instanceof Array&&a.length===n[e.id].length&&n[e.id].forEach(function(n,o){~r.indexOf(n.path)&&a[o]instanceof Function&&(a[o]=a[o].bind(t.controller),n.nodeList.on(e.event,a[o]))})))})})),void 0!==t.hooks&&"object"==typeof t.hooks&&null!==t.hooks&&_object(t.hooks).forEach(function(t,n){e(n,o.filter(function(){return!0}))}))}var t=r.map.refs,n=r.cache.dom;e(t,[])},apply:function(e){function n(o,r,l,a){o instanceof t.classes.CALLER?(l=null!==o.controller?o.controller:u.storage.get(o.url),n(o.hooks,r,l,null!==o.exchange?o.exchange:a)):h.isArray(o)?o.forEach(function(e,o){(e instanceof t.classes.CALLER||e instanceof Object||h.isArray(e))&&n(e,null!==r&&void 0!==r[o]?r[o]:null,l,a)}):o instanceof Object&&!h.isArray(o)&&(null!==l&&m.handle(l,r,a,e),_object(o).forEach(function(e,o){var l=e;o instanceof t.classes.CALLER&&(l=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END),(o instanceof t.classes.CALLER||o instanceof Object||h.isArray(o))&&n(o,null!==r&&void 0!==r[l]?r[l]:null,null,a)}))}n(r.hooks,r.map.model,r.controller,null===r.caller.exchange?null:r.caller.exchange)},handle:function(e,n,o,l){function a(e,t){var t=void 0!==t?t:r.__instance;e.call(t,{model:n,listener:r.listener,exchange:o,instance:r.__instance})}var l="boolean"==typeof l&&l;e instanceof Function?a(e):e instanceof Object&&(l?e[t.events.ONUPDATE]instanceof Function&&a(e[t.events.ONUPDATE],e):e[t.events.ONREADY]instanceof Function&&a(e[t.events.ONREADY],e),e[t.events.SETINSTNCE]instanceof Function?a(e[t.events.SETINSTNCE],e):(e.model=n,e.listener=r.listener,e.exchange=o,e.instance=r.__instance))}},_={reset:function(){return r.cache={regs:{},conditions:{},html:{},dom:{}},r.cache}},N={getString:function(){function e(n){var o=null;return h.isArray(n)?n.map(function(t){return e(t)}):n instanceof t.classes.CALLER?{url:n.url,hooks:e(n.hooks)}:"object"==typeof n?(o={},_object(n).forEach(function(t,n){o[t]=e(n)}),o):n}var n={url:i.url,hooks:e(r.hooks)};return JSON.stringify(n)},setHash:function(){r.hash=e.get().CACHE_PATTERNS?t.other.CACHE_PATTERNS_PREFIX+h.getHash(N.getString()):null},getCache:function(){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_CACHE,{}),o=null;return e.get().CACHE_PATTERNS&&void 0!==r.hash&&null!==r.hash?null===n||void 0===n[r.hash]?(o=flex.localStorage.getJSON(r.hash),null!==o?(n[r.hash]=o,_object(n[r.hash]).copy()):null):void 0!==n[r.hash]?_object(n[r.hash]).copy():void 0:null},setCache:function(t){e.get().CACHE_PATTERNS&&void 0!==r.hash&&null!==r.hash&&flex.localStorage.addJSON(r.hash,t)}},R={make:function(e){var e="boolean"==typeof e&&e;s.build(!1,r.conditions),E.anchors.html(),s.wrap(),E.anchors.convert(),c.bind(),c.combine(),c.finalize(),d.indexes(),v.apply(),m.apply(e),m.events(),s.map()},build:function(){return _.reset(),N.setHash(),v.find(),m.init(),g.refs(),R.make(!1),m.handle(r.caller.onReady,r.map.model,r.caller.exchange),{nodes:r.wrapper.children,model:r.map.model}},update:function(e){function n(e,o,r){var a=[];return h.isArray(e)&&h.isArray(o)?e.length!==o.length&&(o=null):o=null,e.forEach(function(e,i){var s={};e instanceof Object&&(_object(e).forEach(function(e,a){void 0!==r.hooks[e]?s[e]=l.instance({url:r.hooks[e].url,hooks:n(a instanceof Array?a:[a],null!==o&&o[i][e]instanceof t.classes.CALLER?o[i][e].hooks:null,r.hooks[e])}):s[e]=a}),null!==o&&_object(o[i]).forEach(function(e,t){void 0===s[e]&&(s[e]=t)}),a.push(s))}),a}var e=h.isArray(e)?e:[e],o=null;null!==r.map.refs&&(o=n(e,r.hooks,r.map.refs),r.hooks=o,r.caller.unmount(),R.make(!0),m.handle(r.caller.onUpdate,r.map.model,r.caller.exchange),r.caller.mount(r.wrapper.children))},html:function(e,t){var n=s.build(e,t);return{html:r.html,fragments:n}}},A=function(){return f.SIGNATURE+":: pattern ("+i.url+")"},T={build:R.build,html:R.html,update:R.update},{build:T.build,html:T.html,update:T.update}},instance:function(e){return flex.oop.objects.validate(e,[{name:"url",type:"string"},{name:"conditions",type:"object",value:{}},{name:"caller",type:"object",value:null},{name:"hooks",type:["object","array"],value:null}])!==!1?_object({parent:t.classes.PATTERN,constr:function(){if(this.id=flex.unique(),this.url=flex.system.url.restore(e.url),this.source=n.storage.get(e.url),null===this.source)throw flex.logs.log(f.pattern.CANNOT_FIND_SOURCE_OF_TEMPLATE+": "+this.url,flex.logs.types.CRITICAL),new Error(f.pattern.CANNOT_FIND_SOURCE_OF_TEMPLATE+": "+this.url)},privates:{caller:e.caller,hooks:e.hooks,conditions:e.conditions,html:null,wrapper:null,map:{model:null,html:null,hooks:null,refs:null,anchors:null},listener:null,model:null,cache:{html:null,regs:null}},prototype:o.proto}).createInstanceClass():null}},l={proto:function(e){var r=this,a=null,s=null,c=null,d=null,p=null,g=null,v=null;return c={inHooks:function(n){var n=void 0===n?e.hooks:n;n=h.isArray(n)?n:null!==n?new O([n]):null,null!==n&&n.forEach(function(n){_object(n).forEach(function(n,o){o instanceof t.classes.CALLER&&e.patterns.indexOf(o.url)===-1&&(e.patterns.push(o.url),c.inHooks(o.hooks))})}),e.patterns.indexOf(r.url)===-1&&e.patterns.push(r.url)},inMap:function(t){var t=void 0===t?e.map:t;null!==t&&t instanceof Object&&_object(t).forEach(function(t,n){var o=null;null!==n&&n instanceof Object&&(o=void 0!==n.url?flex.system.url.restore(n.url):null,void 0!==n.url&&!~e.patterns.indexOf(o)&&e.patterns.push(o),void 0!==n.hooks&&c.inMap(n.hooks))})}},d=function(t){var t=void 0===t?e.pattern.nodes:t,n=[];e.mounted=Array.prototype.filter.call(t,function(){return!0}),null!==e.node?Array.prototype.forEach.call(e.node,function(o){Array.prototype.forEach.call(t,function(t){e.replace?o.parentNode.insertBefore(t,o):o.appendChild(t)}),e.replace&&o.parentNode.removeChild(o),!~n.indexOf(o.parentNode)&&n.push(o.parentNode)}):null!==e.before&&void 0!==e.before.parentNode&&null!==e.before.parentNode?Array.prototype.forEach.call(e.before,function(o){Array.prototype.forEach.call(t,function(t){o.parentNode.insertBefore(t,e.before)}),!~n.indexOf(o.parentNode)&&n.push(o.parentNode)}):null!==e.after&&void 0!==e.after.parentNode&&null!==e.after.parentNode&&Array.prototype.forEach.call(e.after,function(e){var o=void 0!==e.nextSibling?e.nextSibling:null;null!==o?Array.prototype.forEach.call(t,function(e){o.parentNode.insertBefore(e,o)}):Array.prototype.forEach.call(t,function(t){e.parentNode.appendChild(t)}),!~n.indexOf(e.parentNode)&&n.push(e.parentNode)}),void 0===d.ui_created&&(d.ui_created=!0,null!==flex.oop.namespace.get("flex.libraries.ui.window.move")&&flex.libraries.ui.window.move.create(),null!==flex.oop.namespace.get("flex.libraries.ui.window.focus")&&flex.libraries.ui.window.focus.create(),null!==flex.oop.namespace.get("flex.libraries.ui.window.resize")&&flex.libraries.ui.window.resize.create(),null!==flex.oop.namespace.get("flex.libraries.ui.window.maximize")&&flex.libraries.ui.window.maximize.create()),i.init(!0,r.url),flex.events.core.fire(flex.registry.events.ui.patterns.GROUP,flex.registry.events.ui.patterns.MOUNTED,n)},p=function(){var t=null;e.mounted instanceof Array&&e.mounted.length>0&&(t=void 0!==e.mounted[0].parentNode&&null!==e.mounted[0].parentNode?e.mounted[0].parentNode:null,null!==t&&e.mounted.forEach(function(e){t.removeChild(e)}))},a=function(){function a(t){function n(e,t){function o(e,t){var o={};return _object(t).forEach(function(t,r){void 0!==e.hooks[t]?o[t]=l.instance({url:e.hooks[t].src,hooks:n(e.hooks[t],r)}):o[t]=r}),o}return h.isArray(t)?t.map(function(t){return o(e,t)}):o(e,t)}var o=null,a=(_object(t).copy(),{id:e.id,node:e.node,before:e.before,after:e.after,replace:e.replace,conditions:e.conditions,controller:null===e.controller?u.storage.get(r.url):e.controller,onReady:e.onReady,exchange:e.exchange,remove_missing_hooks:e.remove_missing_hooks,map:e.map});return null!==e.hooks&&(a.url=t.src,a.hooks=n(t,e.hooks),o=l.instance(a),o.render()),o}function i(){function n(e,o){h.isArray(e)&&e.forEach(function(e){_object(e).forEach(function(r,a){void 0===o[r]||a instanceof t.classes.CALLER?void 0!==o[r]&&void 0!==o[r].hooks&&a instanceof t.classes.CALLER&&n(a.hooks,o[r].hooks):(e[r]=l.instance({url:o[r].url,hooks:a}),void 0!==o[r].hooks&&n(e[r].hooks,o[r].hooks))})})}var o=0===Object.keys(e.map).length?y.storage.get(r.url):e.map;null!==o&&null!==e.hooks&&n(e.hooks,o)}function s(t){var o=0===Object.keys(e.map).length?y.storage.get(r.url):e.map,l=e.patterns.length;c.inMap(o),l!==e.patterns.length?n.init(e.patterns,t,v):t()}function p(t){s(function(){return h.isArray(e.hooks)?e.hooks.forEach(function(t,n){e.hooks[n]=E.apply(t,r.url)}):(e.hooks=E.apply({},r.url),Object.keys(e.hooks).length>0&&(e.hooks=new O([e.hooks])),!h.isArray(e.hooks)&&(e.hooks=null)),1!==t.length||null===t[0].map().component?(i(),e.pattern=o.instance({id:e.id,url:r.url,hooks:e.hooks,caller:e.__instance}).build(),d(),!0):void a(t[0].map().component)})}function v(){throw flex.logs.log(g()+f.caller.CANNOT_INIT_PATTERN,flex.logs.types.CRITICAL),e.onReady(null,f.caller.CANNOT_INIT_PATTERN,r.url),f.caller.CANNOT_INIT_PATTERN}c.inHooks(),c.inMap(),n.init(e.patterns,p,v)},s=function(){return o.instance({id:e.id,url:r.url,hooks:e.hooks,caller:e.__instance}).build()},g=function(){return f.SIGNATURE+":: caller ("+r.url+")"},v={render:a,build:s,mount:d,unmount:p},{render:v.render,build:v.build,mount:v.mount,unmount:v.unmount,hooks:e.hooks,map:e.map,conditions:e.conditions,controller:e.controller,exchange:e.exchange,onReady:e.onReady}},instance:function(e){return flex.oop.objects.validate(e,[{name:"url",type:"string"},{name:"node",type:["node","string","array","NodeList"],value:null},{name:"before",type:["node","string","array","NodeList"],value:null},{name:"after",type:["node","string","array","NodeList"],value:null},{name:"id",type:"string",value:flex.unique()},{name:"replace",type:"boolean",value:!1},{name:"hooks",type:["object","array"],value:null},{name:"conditions",type:"object",value:{}},{name:"controller",type:["function","object"],value:null},{name:t.events.ONREADY,type:"function",value:function(){}},{name:"map",type:"object",value:{}},{name:"exchange",type:"object",value:null},{name:"remove_missing_hooks",type:"boolean",value:!0},{name:"component",type:"string",value:null}])!==!1?_object({parent:t.classes.CALLER,constr:function(){this.id=e.id,this.url=flex.system.url.restore(e.url)},privates:{id:e.id,node:null!==e.node?"string"==typeof e.node?_nodes(e.node).target:e.node instanceof Array?e.node:e.node instanceof NodeList?e.node:[e.node]:null,before:null!==e.before?"string"==typeof e.before?_nodes(e.before).target:e.before instanceof Array?e.before:e.before instanceof NodeList?e.before:[e.before]:null,after:null!==e.after?"string"==typeof e.after?_nodes(e.after).target:e.after instanceof Array?e.after:e.after instanceof NodeList?e.after:[e.after]:null,hooks:null!==e.hooks?new O(e.hooks instanceof Array?e.hooks:[e.hooks]):null,replace:e.replace,conditions:e.conditions,controller:e.controller,onReady:e.onReady,exchange:e.exchange,remove_missing_hooks:e.remove_missing_hooks,map:e.map,component:e.component,pattern:null,mounted:null,patterns:[]},prototype:l.proto}).createInstanceClass():null}},a={nodeList:{NODE_LIST:function(e){function t(e){return e.collection_id=flex.unique(),e.indexes=null,e}e instanceof NodeList||e instanceof Array?this.collections=[t(e)]:h.isNode(e)?this.collections=[t([e])]:this.collections=[]},init:function(){a.nodeList.NODE_LIST.prototype={add:function(e){function t(e){return e.collection_id=flex.unique(),e.indexes=null,e}e instanceof NodeList||e instanceof Array?this.collections.push(t(e)):e instanceof a.nodeList.NODE_LIST?this.collections=this.collections.concat(e.collections):h.isNode(e)&&this.collections.push(t([e]))},setIndexes:function(e){this.collections.forEach(function(t){t.indexes=e})},exclude:function(e){var t=[],n=[],o=this;e instanceof a.nodeList.NODE_LIST&&(t=e.collections.map(function(e){return e.collection_id}),o.collections.forEach(function(e,o){~t.indexOf(e.collection_id)&&n.unshift(o)}),n.forEach(function(e){o.collections.splice(e,1)}))},css:function(e){var t=this;"object"==typeof e&&null!==e&&_object(e).forEach(function(e,n){t.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){void 0!==t.style[e]&&(t.style[e]=n)})})})},addClass:function(e){this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){var n=t.className.replace(/\s{2,}/gi,"").split(" ");n.indexOf(e)===-1&&(n.push(e),t.className=n.join(" "))})})},removeClass:function(e){this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){var n=t.className.replace(/\s{2,}/gi,"").split(" "),o=n.indexOf(e);o!==-1&&(n.splice(o,1),t.className=n.join(" "))})})},show:function(){this.collections.forEach(function(e){Array.prototype.forEach.call(e,function(e){e.style.display=void 0!==e.__display?e.__display:"block"})})},hide:function(){this.collections.forEach(function(e){Array.prototype.forEach.call(e,function(e){e.__display=e.style.display,e.style.display="none"})})},remove:function(){this.collections.forEach(function(e){Array.prototype.forEach.call(e,function(e){void 0!==e.parentNode&&null!==e.parentNode&&e.parentNode.removeChild(e)})}),this.collections=[]},append:function(e){"function"==typeof e.appendChild&&this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){e.appendChild(t)})})},insertBefore:function(e){void 0!==e.parentNode&&null!==e.parentNode&&"function"==typeof e.parentNode.insertBefore&&h.isNode(e)&&this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){e.parentNode.insertBefore(t,e)})})},attr:function(e,t){var n=[];return this.collections.forEach(function(o){Array.prototype.forEach.call(o,function(o){void 0!==t?(o.setAttribute(e,t),n.push(!0)):n.push(o.getAttribute(e))})}),1===n.length?n[0]:n},removeAttr:function(e){var t=[];return this.collections.forEach(function(n){Array.prototype.forEach.call(n,function(n){t.push(n.removeAttribute(e))})}),1===t.length?t[0]:t},on:function(e,t){if("function"!=typeof t)throw Error("Defined [handle] is not a function");this.collections.forEach(function(n){Array.prototype.forEach.call(n,function(o){flex.events.DOM.add(o,e,function(e){t(e,n.indexes)})})})},getAsArray:function(){var e=[];return this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){e.push(t)})}),e}}},create:function(e){return new a.nodeList.NODE_LIST(e)},addMethod:function(e,t){"string"==typeof e&&"function"==typeof t&&(void 0!==a.nodeList.NODE_LIST.prototype[e]&&flex.logs.log("Method ["+e+"] of NODE_LIST list class was overwritten.",flex.logs.types.NOTIFICATION),a.nodeList.NODE_LIST.prototype[e]=t)}},listener:{LISTENER:function(e){var e=e,n={},o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.GLOBAL_EVENTS,{}),r=null,l=null,a=null;r=function(e,r,l,a){var l=~["string","number"].indexOf(typeof l)?l:flex.unique(),a="boolean"==typeof a&&a;return!!(r instanceof Function&&~["string","number"].indexOf(typeof e))&&(void 0!==n[e]?n[e]:{},a&&(n[e][l]=r),!a&&(o[e][l]=r),r[t.other.EVENTS_HANDLE_ID]=l,l)},l=function(e,r,l){var l=~["string","number"].indexOf(typeof l)?l:null,e=~["string","number"].indexOf(typeof e)?e:null,r=r instanceof Function?r:null;return null!==e&&(null===l&&null!==r&&(l=void 0!==r[t.other.EVENTS_HANDLE_ID]?r[t.other.EVENTS_HANDLE_ID]:null),null!==l)&&(void 0!==n[e][l]&&delete n[e][l],void 0!==o[e][l]&&delete o[e][l],0===Object.keys(n[e]).length&&delete n[e],0===Object.keys(o[e]).length&&delete o[e],!0)},a=function(t,r,l){var t=~["string","number"].indexOf(typeof t)?t:null,l="boolean"==typeof l&&l,a=l?o:n;return null!==t&&void 0!==a[t]&&(_object(a[t]).forEach(function(t){t.call(e,r)}),!0)},this.bind=function e(t,n,o){return e(t,n,o,!1)},this.bindGlobal=function(e,t,n){return r(e,t,n,!0)},this.unbind=function e(t,n,o){return e(t,n,o)},this.trigger=function e(t,n){return e(t,n,!1)},this.triggerGlobal=function(e,t){return a(e,t,!0)}},create:function(){return new a.listener.LISTENER(r)}},map:{MAP:function(e){if(void 0===e||void 0===e.nodeType)throw Error("Context [context] should be a node.");this.context=e},init:function(){a.map.MAP.prototype={select:function(e){var t=_nodes(e,!1,this.context);return null!==t.target&&t.target.length>0?t.target.length>1?t.target:t.target[0]:null}}},create:function(e){return new a.map.MAP(e)}}},i={journal:{data:[],add:function(e){i.journal.data.push(flex.system.url.restore(e))},done:function(t){var n=i.journal.data.indexOf(t);n!==-1&&i.journal.data.splice(n,1),0===i.journal.data.length&&"function"==typeof e.get().onLayoutBuildFinish&&void 0===e.get().onLayoutBuildFinish.started&&(e.get().onLayoutBuildFinish.started=!0,e.get().onLayoutBuildFinish())}},getScheme:function(){var t=null,n=null;return void 0===i.getScheme.scheme&&(i.getScheme.scheme={}),n=i.getScheme.scheme,0===Object.keys(n).length&&(t=_nodes('link[rel="'+e.get().PATTERN_NODE+'"]').target,null!==t&&t instanceof NodeList&&t.length>0&&Array.prototype.forEach.call(t,function(t){var o=null,r=null,l=null;t.hasAttribute("name")&&t.hasAttribute("src")&&(o=t.getAttribute("name").toLowerCase(),r=t.getAttribute("src"),l=t.hasAttribute(e.get().HOOKS_SET)?t.getAttribute(e.get().HOOKS_SET):"",o.length>0&&r.length>0&&void 0===n[o]?n[o]={name:o,src:r,hooks_set:l}:void 0!==n[o]?flex.logs.log(f.layout.PATTERN_SRC_DEFINED_TWICE_OR_MORE,flex.logs.types.WARNING):flex.logs.log(f.layout.PATTERN_SRC_OR_NAME_IS_TOO_SHORT,flex.logs.types.WARNING))})),n},getHooksMap:function(){var e=null,t=null;return void 0===i.getHooksMap.map&&(i.getHooksMap.map={}),t=i.getHooksMap.map,0===Object.keys(t).length&&(e=_nodes('link[rel="hook"]').target,null!==e&&e instanceof NodeList&&e.length>0&&Array.prototype.forEach.call(e,function(e){var n=null,o=null;e.hasAttribute("name")&&e.hasAttribute("src")&&(n=e.getAttribute("name").toLowerCase(),o=e.getAttribute("src"),n.length>0&&o.length>0&&void 0===t[n]?t[n]={name:n,src:o}:void 0!==t[n]?flex.logs.log(f.layout.HOOK_SRC_DEFINED_TWICE_OR_MORE,flex.logs.types.WARNING):flex.logs.log(f.layout.HOOK_SRC_OR_NAME_IS_TOO_SHORT,flex.logs.types.WARNING))})),t},initByScheme:function(n){var o=i.getScheme(),r=[];Object.keys(o).length>0&&(_object(o).forEach(function(e,t){var n=_nodes(e).target;null!==n&&n instanceof NodeList&&n.length>0&&Array.prototype.forEach.call(n,function(e,n){void 0!==e.__in_work||i.helpers.isNested(e)||(e.__in_work=!0,i.journal.add(t.src),r.push({node:e,scheme:t}))})}),r.forEach(function(o){o.node.setAttribute(e.get().PATTERN_SRC,o.scheme.src),!o.node.hasAttribute(e.get().HOOKS_SET)&&o.node.setAttribute(e.get().HOOKS_SET,o.scheme.hooks_set),o.node.hasAttribute(t.events.ONREADY)&&n||i.caller(o.node)}))},initByHTML:function(n){var o=_nodes(e.get().PATTERN_NODE).target,n="boolean"==typeof n&&n,r=[];null!==o&&o instanceof NodeList&&o.length>0&&(Array.prototype.forEach.call(o,function(t){void 0===t.__in_work&&!i.helpers.isNested(t)&&t.hasAttribute(e.get().PATTERN_SRC)&&(t.__in_work=!0,i.journal.add(t.getAttribute(e.get().PATTERN_SRC)),r.push(t))}),r.forEach(function(e){i.helpers.isNested(e)||e.hasAttribute(t.events.ONREADY)&&n||i.caller(e)}))},init:function(e,t){i.initByScheme(e),i.initByHTML(e),void 0!==t&&i.journal.done(t)},caller:function(n,o,r,a){function s(e,t){var n=-1;try{e.forEach(function(e,o){if(void 0===e[t])throw n=o,"found"})}catch(e){}return n}function u(e,t){var n=e.getAttribute(t),o=null;return"string"==typeof n&&""!==n?(o=n.split("."),n=window,o.forEach(function(e){n=null!==n&&void 0!==n[e]?n[e]:null}),n):null}function c(t,n,o){var r=-1;return void 0!==t.children&&t.children.length>0&&Array.prototype.forEach.call(t.children,function(t){var l=t.nodeName.toLowerCase(),a=0===l.indexOf(e.get().HOOK_PREFIX)||o.indexOf(l)!==-1;if(r=r===-1?a:r?a?r:null:a?null:r,null===r)throw flex.logs.log(f.layout.HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS+" ("+n+")",flex.logs.types.CRITICAL),new Error(f.layout.HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS+" ("+n+")")}),r===-1&&(r=!1),r}function d(t){return 0===t.indexOf(e.get().HOOK_PREFIX)?t.replace(e.get().HOOK_PREFIX,""):t}function h(t){var n=t.hasAttribute(e.get().HOOKS_SET)?t.getAttribute(e.get().HOOKS_SET):[];return"string"==typeof n&&(n=n.split(","),n=n.map(function(e){return e.replace(/\s/gi,"")})),n}function p(e,t){var n=0,t=void 0===t?d(e.nodeName.toLowerCase()):t;void 0===g.hooks[t]||g.hooks instanceof Array||(g.hooks=[g.hooks]),g.hooks instanceof Array?(n=s(g.hooks,t),n===-1&&(g.hooks.push({}),n=g.hooks.length-1),c(e,g.url,a)?g.hooks[n][t]=i.caller(e,!0,r+(""===r?"":".")+t,a):g.hooks[n][t]=e.innerHTML):c(e,g.url,a)?g.hooks[t]=i.caller(e,!0,r+(""===r?"":".")+t,a):g.hooks[t]=e.innerHTML}var g=null,o=void 0!==o&&o,r=void 0!==r?r:n.nodeName.toLowerCase(),E=i.getHooksMap(),y=!(a instanceof Array),a=a instanceof Array?a.concat(h(n)):h(n);
return y=!!y&&(1===a.length&&a[0]),g={url:n.hasAttribute(e.get().PATTERN_SRC)?n.getAttribute(e.get().PATTERN_SRC):void 0!==E[r]?E[r].src:null,hooks:{}},y===!1||c(n,g.url,a)?Array.prototype.forEach.call(n.children,function(e){p(e)}):p(n,y),"object"==typeof g.hooks&&0===Object.keys(g.hooks).length&&delete g.hooks,o||null===g.url?null!==g.url?g=l.instance(g):g.hooks:(g.node=n,g.replace=!0,g.onReady=u(n,t.events.ONREADY),g=l.instance(g).render())},attach:function(){"complete"!==document.readyState?flex.events.DOM.add(window,"load",function(){i.init(!0)}):i.init(!0)},helpers:{isNested:function(t){var n=null,o=i.getScheme();return void 0!==t.parentNode&&null!==t.parentNode&&(n=t.parentNode.nodeName.toLowerCase(),n===e.get().PATTERN_NODE.toLowerCase()||(void 0!==o[n]||"body"!==n&&i.helpers.isNested(t.parentNode)))}}},u={references:{assign:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_LINKS,{});void 0===o[e]&&(o[e]=n)},getPatternURL:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_LINKS,{});return void 0!==n[e]?n[e]:null}},storage:{add:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_STORAGE,{});void 0===o[e]?o[e]=n:flex.logs.log("["+e+"]"+f.controller.CONTROLLER_DEFINED_MORE_THAN_ONCE,flex.logs.types.WARNING)},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_STORAGE,{});return void 0!==n[e]?n[e]:null}},current:{data:null,set:function(e){u.current.data=e},get:function(){return u.current.data},reset:function(){u.current.data=null}},attach:function(e){var t=null,n=null;~["function","object"].indexOf(typeof e)&&(t=null!==u.current.get()?u.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=u.references.getPatternURL(t),u.storage.add(n,e)))}},c={virtual:{add:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.VIRTUAL_STORAGE_ID,{});if(null!==o&&void 0===o[e])return o[e]=n,!0},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.VIRTUAL_STORAGE_ID,{});return null!==n&&void 0!==n[e]?n[e]:null}},local:{add:function(t,n){return e.get().USE_LOCALSTORAGE===!0&&flex.localStorage.addJSON(t,{html:n,hash:flex.hashes.get(t)})},get:function(n){function o(){void 0===c.local.resetPatternsCache&&(flex.localStorage.reset(t.other.CACHE_PATTERNS_PREFIX),c.local.resetPatternsCache=!0)}var r=null;if(e.get().USE_LOCALSTORAGE===!0){if(flex.hashes.update(n),r=flex.localStorage.getJSON(n),null!==r){if(r.hash===flex.hashes.get(n))return r.html;o()}}else o();return null}},add:function(e,t){c.local.add(e,t),c.virtual.add(e,t)},get:function(e){var t=c.virtual.get(e);return null===t&&(t=c.local.get(e)),t}},d={measure:function(){var e={};return function(n,o){if(t.measuring.MEASURE){var n=void 0===n?flex.unique():n;return void 0===e[n]?e[n]=performance.now():(flex.logs.log(f.SIGNATURE+"Operation ["+o+"] was taken "+(performance.now()-e[n]).toFixed(4)+"ms.",flex.logs.types.NOTIFICATION),delete e[n]),n}}}()},p={storage:{add:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONDITIONS_STORAGE,{});o[e]=n},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONDITIONS_STORAGE,{});return void 0!==n[e]?n[e]:null}},attach:function(e){var t=null,n=null;"object"==typeof e&&null!==e&&(t=null!==u.current.get()?u.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=u.references.getPatternURL(t),p.storage.add(n,e)))}},E={storage:{add:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.HOOKS_STORAGE,{});o[e]=n},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.HOOKS_STORAGE,{});return void 0!==n[e]?n[e]:null}},attach:function(e){var t=null,n=null;"object"==typeof e&&null!==e&&(t=null!==u.current.get()?u.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=u.references.getPatternURL(t),E.storage.add(n,e)))},apply:function(e,t){function n(e,t){_object(e).forEach(function(e,o){void 0===t[e]?t[e]=o:null!==t[e]&&"object"==typeof t[e]&&n(o,t[e])})}var o=E.storage.get(t);return null!==o&&"object"==typeof o&&n(o,e),e}},y={storage:{add:function(e,n){var o=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.MAPS_STORAGE,{});o[e]=n},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.MAPS_STORAGE,{});return void 0!==n[e]?n[e]:null}},attach:function(e){var t=null,n=null;"object"==typeof e&&null!==e&&(t=null!==u.current.get()?u.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=u.references.getPatternURL(t),y.storage.add(n,e)))}},h={testReg:function(e,t){return e.lastIndex=0,e.test(t)},binds:{data:{value:[{nodes:["input","textarea"],event:"change",getter:function(){return this.value},setter:function(e){this.value=e}}]},assing:function(e,t,n){var o=e.nodeName.toLowerCase(),r=null;return void 0!==h.binds.data[t]&&(h.binds.data[t].forEach(function(e){e.nodes.indexOf(o)!==-1&&(r=e)}),null!==r&&!function(e,t,n,o,r){_node(t).events().add(e,function(e){r.call(t,e,n,o)})}(r.event,e,r.getter.bind(e),r.setter.bind(e),n)),!1},isPossible:function(e,t){var n=e.nodeName.toLowerCase();if(void 0!==h.binds.data[t])try{h.binds.data[t].forEach(function(e){if(e.nodes.indexOf(n)!==-1)throw"found"})}catch(e){return"found"===e}return!1}},isNode:function(e){return void 0!==e&&void 0!==e.nodeName&&void 0!==e.parentNode&&void 0!==e.nodeType},isArray:function(e){return e instanceof Array||e instanceof O},getTextNode:function(e,t,n){var o=null,n=void 0!==n?n:null;if(void 0!==e.childNodes)if(null!==n&&void 0!==e.childNodes[n]&&e.childNodes[n].nodeValue===t)o=e.childNodes[n];else try{Array.prototype.forEach.call(e.childNodes,function(e){if(3===e.nodeType&&e.nodeValue===t)throw o=e,"found"})}catch(e){}return o},getPattern:function(e){function n(e){return"string"==typeof e?void 0!==t.compatibility.CHILD_TO_PARENT[e]?document.createElement(t.compatibility.CHILD_TO_PARENT[e]):document.createElement(t.compatibility.BASE):null}function o(e){var n=e.match(t.regs.FIRST_TAG);return null!==n&&1===n.length?n[0].replace(t.regs.TAG_BORDERS,"").replace(/\s/gi,"").match(t.regs.FIRST_WORD)[0].toLowerCase():null}var r=o(e);return null!==r?n(r):null},getHash:function(e){var t,n,o,r=0;if(0===e.length)return r;for(t=0,o=e.length;t<o;t++)n=e.charCodeAt(t),r=(r<<5)-r+n,r|=0;return r.toString()}},g={init:function(){flex.callers.define.node("ui.patterns.append",function(e){return"object"==typeof e&&this.target&&(e.node=this.target),l.instance(e)}),flex.callers.define.nodes("ui.patterns.append",function(){var e=[];return Array.prototype.forEach.call(this.target,function(t){"object"==typeof parameters&&this.target&&(parameters.node=this.target),e.push(l.instance(parameters))}),e})}},a.nodeList.init(),a.map.init(),function(){void 0===flex.registry.events.ui&&(flex.registry.events.ui={}),void 0===flex.registry.events.ui.patterns&&(flex.registry.events.ui.patterns={GROUP:"flex.registry.events.ui.patterns",MOUNTED:"MOUNTED"})}(),s={preload:n.init,get:l.instance,controller:{attach:u.attach},conditions:{attach:p.attach},hooks:{attach:E.attach},map:{attach:y.attach},classes:{NODE_LIST:{addMethod:a.nodeList.addMethod}},setup:e.setup,debug:e.debug,layout:i.init},g.init(),window._controller=s.controller.attach,window._conditions=s.conditions.attach,window._hooks=s.hooks.attach,window._map=s.map.attach,i.attach(),{preload:s.preload,get:s.get,classes:{NODE_LIST:{addMethod:s.classes.NODE_LIST.addMethod}},setup:s.setup,debug:s.debug,layout:s.layout}},flex.modules.attach({name:"ui.patterns",protofunction:e,reference:["flex.events","flex.html","flex.binds","flex.types.array"],onAfterAttach:function(){flex.libraries.events.create(),flex.libraries.html.create(),flex.libraries.binds.create(),flex.libraries.types.array.create(),window._patterns=flex.libraries.ui.patterns.create()}})}}(),flex.init({resources:{MODULES:["flex.ui.patterns","flex.ui.window.resize","flex.ui.window.focus","flex.ui.window.maximize","flex.ui.window.move"],USE_STORAGED:!0},settings:{CHECK_PATHS_IN_CSS:!0},logs:{SHOW:["CRITICAL"]}});
//# sourceMappingURL=maps/expatterns.min.js.map
