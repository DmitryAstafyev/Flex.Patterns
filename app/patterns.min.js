!function(){"use strict";var e=function(){};e.prototype=function(){var e={},t={},n={},r={},o={},l={},a={},s={},i={},c={},u={},f={},d={},h={},p={},g={},E={},y={},O={},_={};return e={defaults:{resources:{USE_STORAGED:{type:"boolean",value:!1},WAIT_ASYNCHRONOUS:{type:"boolean",value:!0},MODULES:{type:"array",value:[]},EXTERNAL:{type:"array",value:[]},ASYNCHRONOUS:{type:"array",value:[]}},paths:{CORE:{type:"string",value:function(){function e(e){return e=E.url.parse(e.toLowerCase()),n.files.CORE=e.target,n.files.CORE_URL=e.url,e=e.path}var t=E.resources.js.getCurrentSRC(!0),r=null;if(null!==t)return e(t);if(r=document.querySelector('script[src*="'+n.files.CORE+'"]'),null!==r)return e(r.src);throw new Error("Cannot detect URL and PATH to core script (default name: flex.core.js)")}},ATTACH:{type:"string",value:"/app"}},events:{onFlexLoad:{type:"function",value:null},onPageLoad:{type:"function",value:null}},settings:{CHECK_PATHS_IN_CSS:{type:"boolean",value:!1},ATTACH_PATH_SIGNATURE:{type:"string",value:"ATTACH::"},KERNEL_PATH_SIGNATURE:{type:"string",value:"KERNEL::"}},patterns:{TEST_FUNCTION:"flexPatternTest"},cache:{reset:{ON_NEW_MODULE:{type:"boolean",value:!0},ON_UPDATED_MODULE:{type:"boolean",value:!1},ON_NEW_RESOURCE:{type:"boolean",value:!1},ON_UPDATED_RESOURCE:{type:"boolean",value:!1},ON_CRITICAL_ERROR:{type:"boolean",value:!0}}},logs:{SHOW:{type:"array",value:["CRITICAL","LOGICAL","WARNING"]}}},init:function(t){function r(e,t,n){function o(e){return e instanceof Array?"array":typeof e}var n=n||"",a=null;if("object"==typeof e.content)if(void 0!==e.content.type&&void 0!==e.content.value)a=l.namespace.get(n,t),o(a)===e.content.type?e.parent[e.name]=a:e.parent[e.name]="function"==typeof e.content.value?e.content.value():e.content.value;else for(var s in e.content)r({content:e.content[s],parent:e.content,name:s},t,n+(""===n?"":".")+s)}var o=p.globaly.get(n.storage.GROUP,n.storage.DEFAULT_CONFIG),a=p.globaly.get(n.storage.GROUP,n.storage.DEFAULT_CONFIG_FLAG);null===a?(null===o?p.globaly.set(n.storage.GROUP,n.storage.DEFAULT_CONFIG,l.objects.copy(e.defaults)):e.defaults=l.objects.copy(o),t&&(a=p.globaly.set(n.storage.GROUP,n.storage.DEFAULT_CONFIG_FLAG,!0)),r({content:e.defaults,parent:null,name:null},t||{}),void 0!==t&&(s.modification(),u.init(),f.preload(),h.preload())):_.log("[CORE]:: flex was initialized before. Initialization can be done only once per session.",_.types.WARNING)},get:function(){return e.defaults},set:function(t){for(var n in t)void 0!==e.defaults[n]&&typeof e.defaults[n]==typeof t[n]&&(e.defaults[n]=t[n])}},t={onFlexLoad:function(){var r=p.globaly.get(n.storage.GROUP,n.storage.DEFAULT_CONFIG_FLAG),l=!1;null!==r?f.isReady()&&d.isReady()&&h.isReady()&&f.attach.unexpected.isReady()&&(l=!0):f.isReady()&&f.attach.unexpected.isReady()&&(l=!0),l?void 0===t.onFlexLoad.__inited?(s.execution()||(t.onFlexLoad.__inited=!0,E.handle(e.defaults.events.onFlexLoad,null,"config.defaults.events.onFlexLoad",this),null!==e.defaults.events.onPageLoad&&("complete"!==document.readyState?o.DOM.add(window,"load",e.defaults.events.onPageLoad):E.handle(e.defaults.events.onPageLoad,null,"config.defaults.events.onPageLoad",this))),f.attach.unexpected.launched.accept(),c.update.queue.unlock()):_.log("Double start of [onFlexLoad]",_.types.CRITICAL):f.attach.unexpected.isReady()}},n={storage:{GROUP:"flex.core",RESOURCES_JOURNAL:"flex.modules.resources.journal",UNEXPECTED_JOURNAL:"flex.modules.unexpected.journal",DEFAULT_CONFIG:"flex.defualt.config",DEFAULT_CONFIG_FLAG:"flex.defualt.config.flag",WAITING_REGISTER_TASKS:"flex.register.wait.tasts"},resources:{types:{CSS:".css",JS:".js"}},regs:{urls:{PARAMS:/\?.*/gi,EXTENSION:/(\.[\w\n]*)$/gi,JS_URL:/[\w]*:\/\/[\w\n:\/\.]*\.js/gi,NOT_URL_SYMBOLS:/[\s\t\n\r]/gi,JS_EXP_IN_URL:/\.js$/gi,CSS_EXP_IN_URL:/\.css$/gi}},register:{EXTERNAL_HISTROY:"flex.external.history",MODULES_HISTROY:"flex.modules.history",MODULES_HISTROY_CREATION:"flex.modules.history.created",RESOURCES_HISTORY:"flex.modules.resources.history",ASYNCHRONOUS_HISTORY:"asynchronous.history"},hashes:{LOCAL_STORAGE_NAME:"flex.hash.storage"},cache:{STORAGE:"flex.cache.storage.reset_data",URL_PARAM_VERSION:"flexhash"},files:{CORE:"",CORE_URL:"",ROOT:"",FLEX:"",detect:function(){function e(e){return e=E.url.parse(e.toLowerCase()),n.files.CORE=e.target,n.files.CORE_URL=e.url,n.files.ROOT=e.home+"/"+e.dirs.filter(function(e,t,n){return t!==n.length-1}).join("/"),n.files.FLEX=e.path,0===e.dirs.length&&setTimeout(function(){_.log("Flex core file ["+e.target+"] attached in root ["+e.home+']. Recommendation: attach flex\'s libraries (include core) in some subfolder (for example, "core", "flex", "kernel" or any other).',_.types.NOTIFICATION)},10),e.path}var t=E.resources.js.getCurrentSRC(!0),r=null;if(null!==t)return e(t);if(""!==n.files.CORE&&(r=document.querySelector('script[src*="'+n.files.CORE+'"]'),null!==r))return e(r.src);throw new Error("Cannot detect URL and PATH to core script. Setup name of manually [options.files.CORE]")}},other:{STORAGE_PREFIX:"[FLEX_SYSTEM_RESURCES]"}},r={settings:{DEFAULT_TIMEOUT:15e3,DEFAULT_METHOD:"POST",methods:{POST:"POST",GET:"GET",PUT:"PUT",DELETE:"DELETE",OPTIONS:"OPTIONS"},regs:{URLENCODED:/-urlencoded/gi,JSON:/application\/json/gi},headers:{CONTENT_TYPE:"Content-Type",ACCEPT:"Accept"}},requests:{storage:{},add:function(e){var t=r.requests.storage;return void 0===t[e.settings.id]&&(t[e.settings.id]=e,!0)},remove:function(e){var t=r.requests.storage;return void 0!==t[e.settings.id]&&(t[e.settings.id]=null,delete t[e.settings.id],!0)},isConflict:function(e){return void 0!==r.requests.storage[e]}},create:function(e,t,n,l,a){var s=null;return e="string"==typeof e?e:null,t="string"==typeof t&&[r.settings.methods.POST,r.settings.methods.GET,r.settings.methods.PUT,r.settings.methods.DELETE,r.settings.methods.OPTIONS].indexOf(t.toUpperCase())!==-1?t.toUpperCase():r.settings.DEFAULT_METHOD,a=r.parse.settings(a),n=r.parse.parameters(n,a),l=r.parse.callbacks(l),null!==e?(s=function(e,t,n,r,o){this.settings=o,this.url=e,this.method=t,this.parameters=n,this.callbacks=r,this.timerID=null,this.response=null,this.responseHeaders=null,this.httpRequest=null},s.prototype={send:function(){var e=this;try{r.requests.add(e),e.httpRequest=new XMLHttpRequest;for(var t in e.events)!function(e,t){o.DOM.add(t.httpRequest,e,function(n){return t.events[e](n,t)})}(t,e);if(null!==e.httpRequest){switch(e.callback(e.callbacks.before),e.method){case r.settings.methods.POST:e.httpRequest.open(e.method,e.url,!0),e.setHeaders(e),e.httpRequest.send(e.parameters._parameters);break;case r.settings.methods.GET:e.httpRequest.open(e.method,e.url+(""!==e.parameters._parameters?"?":"")+e.parameters._parameters,!0),e.setHeaders(e),e.httpRequest.send();break;default:e.httpRequest.open(e.method,e.url,!0),e.setHeaders(e),e.httpRequest.send(e.parameters._parameters)}return e.timerID=setTimeout(function(){e.events.timeout(null,e)},e.settings.timeout),!0}throw"Fail create XMLHttpRequest"}catch(t){e.callback(e.callbacks.fail,t),e.destroy(e)}},setHeaders:function(e){if(null!==e.settings.headers)for(var t in e.settings.headers)e.httpRequest.setRequestHeader(t,e.settings.headers[t])},events:{readystatechange:function(e,t){if(r.requests.isConflict(t.settings.id)!==!1&&e.target&&e.target.readyState)switch(t.callback(t.callbacks.reaction,e),e.target.readyState){case 2:t.responseHeaders=t.parseHeaders(e.target.getAllResponseHeaders()),t.callback(t.callbacks.headers,e);break;case 4:return 200===e.target.status?(t.response=t.parse(e.target.responseText),t.destroy(t),t.callback(t.callbacks.success,e),!0):(t.destroy(t),t.callback(t.callbacks.fail,e),!1)}},timeout:function(e,t){r.requests.isConflict(t.settings.id)!==!1&&(t.callback(t.callbacks.timeout,e),t.destroy(t))}},parse:function(e){var t={original:e,parsed:void 0};try{t.parsed=JSON.parse(e)}catch(e){}finally{return t}},parseHeaders:function(e){var t={_headers:e,headers:{}},n=null;return"string"==typeof e&&(n=e.split("\r\n"),n instanceof Array&&n.forEach(function(e){var n=e.split(":");n instanceof Array&&""!==n[0]&&(t.headers[n[0]]=e.replace(n[0]+":",""))})),t},callback:function(e,t){null!==e&&E.handle(e,[this.response,{id:this.id,event:void 0!==t?t:null,headers:this.responseHeaders,response:this.response,parameters:this.parameters,url:this.url,abort:this.abort.bind(this)}],"ajax.callback:: request ID:: "+this.id+" URL:: "+this.url,this)},abort:function(){null!==this.httpRequest&&"function"==typeof this.httpRequest.abort&&this.httpRequest.abort()},destroy:function(e){clearTimeout(e.timerID),r.requests.remove(e)}},new s(e,t,n,l,a)):null},parse:{settings:function(e){var e="object"==typeof e&&null!==e?e:{};return e.id="string"==typeof e.id?e.id:"number"==typeof e.id?e.id:y.id(),e.id=r.requests.isConflict(e.id)===!1?e.id:y.id(),e.timeout="number"==typeof e.timeout?e.timeout:r.settings.DEFAULT_TIMEOUT,e.doNotChangeHeaders="boolean"==typeof e.doNotChangeHeaders&&e.doNotChangeHeaders,e.doNotChangeParameters="boolean"==typeof e.doNotChangeParameters&&e.doNotChangeParameters,e.doNotEncodeParametersAsURL="boolean"==typeof e.doNotEncodeParametersAsURL&&e.doNotEncodeParametersAsURL,e.headers=r.parse.headers(e),e},parameters:function(e,t){var n=e,o={},l="",a=[],s=null;if(t.doNotChangeParameters)l=e;else{if(n instanceof Array)Array.prototype.forEach.call(n,function(e,t){var r=null;n[t]=param.replace(/^\s*\?/gi,""),r=n[t].split("="),r instanceof Array&&2===r.length?o[r[0]]=r[1]:a.push(n[t])});else if("object"==typeof n&&null!==n)for(var i in n){switch(typeof n[i]){case"string":o[i]=n[i];break;case"boolean":o[i]=n[i].toString();break;case"number":o[i]=n[i].toString();break;case"object":o[i]=JSON.stringify(n[i]);break;default:try{o[i]=JSON.stringify(n[i])}catch(e){}}o[i]=o[i]}if("string"!=typeof e)if(r.settings.regs.JSON.lastIndex=0,r.settings.regs.URLENCODED.lastIndex=0,r.settings.regs.JSON.test(t.headers[r.settings.headers.CONTENT_TYPE]))l=JSON.stringify(o);else{s=r.settings.regs.URLENCODED.test(t.headers[r.settings.headers.CONTENT_TYPE]),s=!t.doNotEncodeParametersAsURL&&s;for(var i in o)l+="&"+i+"="+s?encodeURIComponent(o[i]):o[i];l=l.replace(/^\s*\&/gi,"")}else l=e}return{original:e,parameters:o,_parameters:l,excluded:a}},callbacks:function(e){var t={before:null,success:null,fail:null,reaction:null,timeout:null};return"object"==typeof e&&null!==e&&(t.before="function"==typeof e.before?e.before:null,t.success="function"==typeof e.success?e.success:null,t.fail="function"==typeof e.fail?e.fail:null,t.reaction="function"==typeof e.reaction?e.reaction:null,t.timeout="function"==typeof e.timeout?e.timeout:null,t.headers="function"==typeof e.headers?e.headers:null),t},headers:function(e){var t={};return e.doNotChangeHeaders?t="object"==typeof e.headers&&null!==e.headers?e.headers:{}:("object"==typeof e.headers&&null!==e.headers&&l.objects.forEach(e.headers,function(e,n){var r=e.split("-");r.forEach(function(e,t){r[t]=e.charAt(0).toUpperCase()+e.slice(1)}),t[r.join("-")]=n}),void 0===t[r.settings.headers.CONTENT_TYPE]&&(t[r.settings.headers.CONTENT_TYPE]="application/x-www-form-urlencoded"),void 0===t[r.settings.headers.ACCEPT]&&(t[r.settings.headers.ACCEPT]="*/*")),e.headers=t,e.headers}}},l={namespace:{create:function(e,t){var t=t||window,n=null,r=t,o=null;if("string"==typeof e)try{return Array.prototype.forEach.call(e.split("."),function(e){n=r,e in r||(r[e]={}),r=r[e],o=e}),{target:r,parent:n,root:t,name:o}}catch(e){return null}return null},get:function(e,t){var t=t||window,n=t;if("string"==typeof e)try{return Array.prototype.forEach.call(e.split("."),function(e){if(!(e in n))throw"Property ["+n+"] was not found";n=n[e]}),n}catch(e){return null}return null}},classes:{of:function(e){return null===e?null:void 0===e?null:Object.prototype.toString.call(e).slice(8,-1)},create:function(e){var t="function"==typeof e.constr?e.constr:null,n="function"==typeof e.parent?e.parent:null,r=void 0!==e.privates?e.privates:{},o=void 0!==e.prototype?e.prototype:{},a=null,s=null;if(this instanceof l.classes.create)throw Error("Method [flex.oop.classes.create] cannot be used with derective NEW");if(null!==n){a=n,a.prototype=n.prototype,s="function"==typeof o?o.call(new t,r):o,t.prototype=new a;for(var i in s)t.prototype[i]=s[i]}else t.prototype="function"==typeof o?o.call(new t,r):o;return r.__instance=new t,r.__instance}},objects:{forEach:function(e,t){if("object"==typeof e){for(var n in e)!function(e,t,n){n(e,t[e])}(n,e,t);"toString"in{toString:null}||Array.prototype.forEach.call(["toString","valueOf","constructor","hasOwnPropery","isPrototypeOf","propertyIsEnumerable","toLocaleString"],function(r){e.hasOwnProperty(prototype)&&t(r,e[n])})}},extend:function(e,t,n){var n="Array"===l.classes.of(n)?n:[],t=null!==t&&void 0!==t&&"object"==typeof t?t:{},e="object"==typeof e?[e]:"Array"===l.classes.of(e)?e:null;return null!==e&&Array.prototype.forEach.call(e,function(e){if("object"==typeof e)for(var r in e)n.indexOf(r)===-1&&(t[r]=e[r])}),t},copy:function(e,t){function n(e){var t=null;return e instanceof Array?(t=[],Array.prototype.forEach.call(e,function(e){e instanceof Array||"object"==typeof e||"function"==typeof e?t.push(n(e)):t.push(e)})):t="object"==typeof e&&null!==e&&"function"!=typeof e?r(e):e,t}var t=t||{},e="object"==typeof e?e:null,r=l.objects.copy;if(null!==e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=n(e[o]));return t}return null},validate:function(e,t){var e="object"==typeof e?e:null,t=t||null,n=null,r=null;if(null!==e&&null!==t){t=t instanceof Array?t:[t];try{t.forEach(function(t){if(t.name&&t.type)if(e[t.name]||"boolean"==typeof e[t.name]||"number"==typeof e[t.name]){if(t.type="string"==typeof t.type?[t.type]:t.type,t.type instanceof Array){n=!1;try{t.type.forEach(function(r){if("function"==typeof r?n=e[t.name]instanceof Array==!0||n:"node"===r?void 0!==e[t.name]&&(n=!!e[t.name].nodeName||n):n="array"===r?e[t.name]instanceof Array==!0||n:void 0!==window[r]&&["string","number","bool"].indexOf(r)===-1?e[t.name]instanceof window[r]||n:typeof e[t.name]===r||n,n!==!1)throw"found"})}catch(e){"found"!==e&&(n=!1)}finally{if(n===!1){if(void 0===t.value)throw"deny";e[t.name]=t.value}else{if(void 0!==t.values&&t.values instanceof Array){try{r=!1,t.values.forEach(function(n){if(e[t.name]===n)throw r=!0,"found"})}catch(e){}if(r===!1)throw"deny"}if("function"==typeof t.handle)try{e[t.name]=t.handle(e[t.name])}catch(n){if(!t.value)throw"deny";e[t.name]=t.value}}}}}else{if(void 0===t.value)throw"deny";e[t.name]=t.value}})}catch(e){return!1}return!0}return null},isValueIn:function(e,t,n){var n="boolean"==typeof n&&n;if(e instanceof Array){try{e.forEach(function(e){if(e===t)throw"found"}),n!==!1&&e.forEach(function(e){if(("object"==typeof e||e instanceof Array)&&l.objects.isValueIn(e,t,n)===!0)throw"found"})}catch(e){return!0}return!1}if("object"==typeof e){try{l.objects.forEach(e,function(e,n){if(n===t)throw"found"}),n!==!1&&l.objects.forEach(e,function(e,r){if(("object"==typeof r||r instanceof Array)&&l.objects.isValueIn(r,t,n)===!0)throw"found"})}catch(e){return!0}return!1}return null},getByPath:function(e,t){var e="object"==typeof e?e:null,t="string"==typeof t?t:t instanceof Array?t:null,n=null,r={NO_BY_PATH:"NO_BY_PATH"},o=e,l=!1;if(null!==e&&null!==t){n=t instanceof Array?t:t.split(".");try{n.forEach(function(e){if(void 0===o[e])throw r.NO_BY_PATH;o=o[e]}),l=!0}catch(e){if(e!==r.NO_BY_PATH)throw e}}return l?o:void 0},findBy:function(e,t,n,r){var e="object"==typeof e?e:null,t="string"==typeof t?t:null,r="boolean"==typeof r&&r,o=r?[]:null,a={FOUND:"1"};if(null!==e&&null!==t){t=t.split(".");try{l.objects.forEach(e,function(e,s){var i=l.objects.getByPath(s,t);if(void 0!==i&&i===n){if(!r)throw o=s,a.FOUND;o.push(s)}})}catch(e){if(e!==a.FOUND)throw e}}return o}},wrappers:{objects:function(){O.prototypes.add.object("forEach",function(e){return l.objects.forEach(this.target,e)}),O.prototypes.add.object("extend",function(e,t){return l.objects.extend(this.target,e,t)}),O.prototypes.add.object("copy",function(e){return l.objects.copy(this.target,e)}),O.prototypes.add.object("validate",function(e){return l.objects.validate(this.target,e)}),O.prototypes.add.object("isValueIn",function(e,t){return l.objects.isValueIn(this.target,e,t)}),O.prototypes.add.object("getByPath",function(e){return l.objects.getByPath(this.target,e)}),O.prototypes.add.object("findBy",function(e,t,n){return l.objects.findBy(this.target,e,t,n)}),O.prototypes.add.object("createInstanceClass",function(){return l.classes.create(this.target)})}}},a={findBy:function(e,t,n,r){var e=e instanceof Array?e:null,t="string"==typeof t?t:null,r="boolean"==typeof r&&r,o=r?[]:null,a={FOUND:"1"};if(null!==e&&null!==t){t=t.split(".");try{e.forEach(function(e){var s=l.objects.getByPath(e,t);if(void 0!==s&&s===n){if(!r)throw o=e,a.FOUND;o.push(e)}})}catch(e){if(e!==a.FOUND)throw e}}return o},wrappers:{array:function(){O.prototypes.add.array("findBy",function(e,t,n){return a.findBy(this.target,e,t,n)})}}},u={init:function(){E.localStorage.isAvailable()!==!1&&(u.storage.load(),u.actions.hash(),e.defaults.resources.USE_STORAGED===!0&&u.attach())},attach:function(){["ON_NEW_MODULE","ON_UPDATED_MODULE","ON_NEW_RESOURCE","ON_UPDATED_RESOURCE"].forEach(function(t){o.core.listen(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache[t],function(n){u.events.on(e.defaults.cache.reset[t],n)})}),o.core.listen(flex.registry.events.system.logs.GROUP,flex.registry.events.system.logs.CRITICAL,function(t){u.events.on(e.defaults.cache.reset.ON_CRITICAL_ERROR,t)})},events:{on:function(e,t){e===!0&&u.actions.reset(t)},fire:{ON_NEW_MODULE:function(e){o.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_NEW_MODULE,e)},ON_UPDATED_MODULE:function(e){o.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_UPDATED_MODULE,e)},ON_NEW_RESOURCE:function(e){o.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_NEW_RESOURCE,e)},ON_UPDATED_RESOURCE:function(e){o.core.fire(flex.registry.events.system.cache.GROUP,flex.registry.events.system.cache.ON_UPDATED_RESOURCE,e)}}},actions:{reset:function(){var e=!1;return function(t,r){var r="boolean"==typeof r&&r;e===!1&&(e=!0,u.storage.data.reseted===!1||r===!0?(E.localStorage.reset(n.other.STORAGE_PREFIX),_.log('[CACHE]: cache was reseted. The reason is "'+t+'"',_.types.WARNING),u.storage.data.reseted=!0,u.storage.save()):(u.storage.data.reseted=!1,u.storage.save()))}}(),hash:function(){var e=null,t=document.querySelector('script[src*="'+n.files.CORE+'"]');return null!==t&&(e=E.url.parse(t.src.toLowerCase()),null!==e.params&&e.params[n.cache.URL_PARAM_VERSION]&&(e=e.params[n.cache.URL_PARAM_VERSION],u.storage.data.hash!==e&&(u.storage.data.hash=e,u.storage.save(),u.actions.reset(e,!0)))),e}},storage:{data:{reseted:!0,hash:null},load:function(){function e(e){for(var t in u.storage.data)if(void 0===e[t])return!1;return!0}var t=E.localStorage.getJSON(n.cache.STORAGE);return null!==t&&(e(t)===!0?u.storage.data=t:u.storage.save()),!1},save:function(){E.localStorage.setJSON(n.cache.STORAGE,u.storage.data)}}},c={storage:{data:{},get:function(){return c.storage.data=E.localStorage.getJSON(n.hashes.LOCAL_STORAGE_NAME,n.other.STORAGE_PREFIX),"object"==typeof c.storage.data&&null!==c.storage.data||c.storage.create(),c.storage.data},create:function(){c.storage.data={},c.storage.update()},update:function(){E.localStorage.setJSON(n.hashes.LOCAL_STORAGE_NAME,c.storage.data,n.other.STORAGE_PREFIX)}},get:function(e){var t=c.storage.get();return"object"==typeof t[e]?t[e].hash:null},set:function(e,t){var n=c.storage.get();return"string"==typeof t&&(n[e]={url:e,hash:t},c.storage.update(),!0)},update:{add:function(e){c.update.queue.add(e)},queue:{queue:{},journal:{},isLock:!0,unlock:function(){c.update.queue.isLock=!1,c.update.proceed()},add:function(e){"string"==typeof e&&void 0===c.update.queue.journal[e]&&(c.update.queue.journal[e]=!0,c.update.queue.queue[e]={url:e,working:!1}),c.update.queue.isLock||c.update.proceed()},del:function(e){"string"==typeof e&&(c.update.queue.queue[e]=null,delete c.update.queue.queue[e])},work:function(e){"object"==typeof c.update.queue.queue[e]&&(c.update.queue.queue[e].working=!0)},isWorking:function(e){if("object"==typeof c.update.queue.queue[e])return c.update.queue.queue[e].working}},proceed:function(){l.objects.forEach(c.update.queue.queue,function(e,t){var n=null;c.update.queue.isWorking(e)===!1&&(c.update.queue.work(e),n=r.create(t.url,r.settings.methods.GET,null,{headers:function(n,r){c.update.processing(e,t.url,r)},fail:function(n,r){c.update.fail(e,t.url,r)}}),n.send())})},processing:function(e,t,n){var r="",o=c.get(t);null!==n.headers&&""!==n.headers._headers&&(c.update.queue.del(e),l.objects.forEach(n.headers.headers,function(e,t){"date"!==e.toLowerCase()&&(r+=t)}),c.get(t)!==r&&(null===o?_.log("[HASHES]:: hash for resource ["+t+"] was generated. Next updating of page, resource will be loaded again.",_.types.KERNEL_LOGS):(_.log("[HASHES]:: resource ["+t+"] have to be updated.",_.types.KERNEL_LOGS),c.resources.update(t)),c.set(t,r)),n.abort())},fail:function(e,t,n){null===n.headers&&(_.log("[HASHES]:: fail to load hash for resource ["+t+"].",_.types.KERNEL_LOGS),c.update.queue.del(e))}},resources:{update:function(e){return c.resources.css.update(e)===!0||void _.log("[HASHES]:: resource ["+e+"] cannot be updated in current session. It will be done after page be reloaded.",_.types.KERNEL_LOGS)},css:{update:function(e){var t=document.querySelector("style["+E.resources.css.settings.attr.SRC+'$="'+e+'"]');return null!==t&&(E.resources.css.connect(e,function(){t.parentNode.removeChild(t),_.log("[HASHES]:: resource ["+e+"] have been updated in current session.",_.types.KERNEL_LOGS)}),!0)}}}},f={isReady:function(){return p.register.isReady(n.register.MODULES_HISTROY)},preload:function(){var t=e.defaults.resources.MODULES;t instanceof Array&&(t.length>0?(p.register.open(n.register.MODULES_HISTROY,t.map(function(e){return f.tools.clearName(e)}),d.preload),Array.prototype.forEach.call(t,function(e){var t=f.reference.getSource(e);null===f.registry.getSettings(e.replace(/^flex\./gi,""))&&f.registry.add({name:e,hash:c.get(t),autoHash:!0,source:t}),f.reference.history.add(e),f.repository.call(e)})):d.preload())},reference:{history:{data:[],add:function(e){f.reference.history.data.push(e.replace("flex.libraries.","").replace(/^flex\./gi,""))},isIn:function(e){return f.reference.history.data.indexOf(e.replace("flex.libraries.","").replace(/^flex\./gi,""))!==-1}},caller:{name:null,ready:null},getSource:function(e){var t=e.split("."),r="";return r=t.length>0?"flex"===t[0]?n.files.FLEX+e:n.files.ROOT+t[0]+"/"+e.replace(t[0]+".",""):n.files.ROOT+e,r+".js"},call:function(e){var t=f.reference.caller,n=f.reference.history;null!==t.name&&(null===f.storage.get(e)?(t.ready=!1,n.isIn(e)===!1&&(n.add(e),f.repository.call(e))):t.ready=t.ready!==!1)},check:function(e,t){var r=f.reference.caller,o=f.storage.get(e),t="function"==typeof t&&t,a=[];if(null!==o)try{r.name=e,r.ready=!0,o.reference instanceof Array&&o.reference.forEach(function(e){var n=f.reference.getSource(e),r=f.tools.fullName(e.replace(/^flex\./gi,"")),o=null;null===f.registry.getSettings(e.replace(/^flex\./gi,""))&&f.registry.add({name:e,hash:c.get(n),autoHash:!0,source:n}),t&&(o=l.namespace.get(r),null!==o&&void 0!==o.create||a.push(r)),f.reference.call(e)})}catch(t){_.log("[MODULES]:: module ["+e+"] generated error during request for references:\n\r"+_.parseError(t),_.types.CRITICAL),r.ready=!1}finally{o.ready=r.ready,r.name=null,r.ready=null,t&&(a.length>0?(a=a.filter(function(e){var t=l.namespace.get(e);return null===t||void 0===t.create}),a.length>0?(p.register.open(n.register.MODULES_HISTROY_CREATION+":"+e,a,t),f.reference.waited.add(e)):t()):t())}else t&&t()},pending:function(){var e=f.storage.pending(),t=f.reference.check;e.length>0&&Array.prototype.forEach.call(e,function(e){t(e)})},waited:{tasks:[],add:function(e){f.reference.waited.tasks.push(e)},done:function(e){f.reference.waited.tasks.forEach(function(t){p.register.done(n.register.MODULES_HISTROY_CREATION+":"+t,e)})}}},registry:{makeCaller:function(e){var t=l.namespace.create(e.name.replace(/^flex\./gi,""),flex.libraries),n=null;null!==t&&(n=f.tools.fullName(e.name.replace(/^flex\./gi,"")),Object.defineProperty(t.parent,t.name,{enumerable:!1,configurable:!1,value:function(){f.reference.call(n)}}))},getSettings:function(e){var e=0===e.indexOf("flex.libraries.")?e.replace("flex.libraries.",""):e;return l.namespace.get(e,flex.libraries_data)},add:function(e){var t=null,n=e.name.replace(/^flex\./gi,"");return null===f.registry.getSettings(n)&&(t=l.namespace.create(n,flex.libraries_data),null!==t)&&(t.target.name=e.name,t.target.source=e.source,t.target.hash=e.hash,t.target.autoHash=e.autoHash,f.registry.makeCaller(e),!0)},validateSRC:function(t){return E.url.sterilize(t.replace(e.defaults.settings.KERNEL_PATH_SIGNATURE,e.defaults.paths.CORE+"/"))}},storage:{data:{},add:function(e){var t=f.storage.data;return void 0===t[e.name]&&(t[e.name]={name:e.name,protofunction:e.protofunction,onBeforeAttach:e.onBeforeAttach,onAfterAttach:e.onAfterAttach,extend:e.extend,reference:e.reference,ready:!1},!0)},get:function(e){return void 0===f.storage.data[e]?null:f.storage.data[e]},pending:function(){var e=[];for(var t in f.storage.data)f.storage.data[t].ready===!1&&e.push(t);return e}},attach:{queue:{data:[],add:function(e){f.attach.queue.data.push(e)},reset:function(){f.attach.queue.data=[]},proceed:function(){var e=f.attach.queue;Array.prototype.forEach.call(e.data,function(t,n){"boolean"!=typeof t.going&&(e.data[n].going=!0,f.attach.embody.procceed(t))}),e.reset()}},safely:function(e){var t=f.attach.queue;return t.add(e),t.proceed(),!1},embody:{createConstructor:function(e,t){var n=f.storage.get(e),t="function"==typeof t?t:null;return null!==t||null!==n?(t=null!==t?t:n.protofunction,"function"==typeof t.prototype?function(){return"function"==typeof t.prototype&&(t.prototype=t.prototype()),new t}:(_.log("[MODULES]:: cannot create caller for module ["+e+"]. Prototype of module should be a function.",_.types.CRITICAL),null)):(_.log("[MODULES]:: cannot create caller for module ["+e+"]. Incorrect prototype function.",_.types.CRITICAL),null)},procceed:function(e){var t=null;if(l.objects.validate(e,[{name:"name",type:"string"},{name:"protofunction",type:"function"},{name:"reference",type:"array",value:null},{name:"resources",type:"array",value:[]},{name:"onBeforeAttach",type:"function",value:null},{name:"onAfterAttach",type:"function",value:null},{name:"extend",type:["array","object"],value:[]}])!==!1)if(f.reference.history.isIn(e.name)){if(e.name=f.tools.fullName(e.name),t=l.namespace.get(e.name),null!==t&&t!==!1&&void 0===t.create&&(f.storage.add(e),t.create=f.attach.embody.createConstructor(e.name,e.protofunction),null!==t.create))return f.repository.add(e),f.reference.check(e.name,function(){E.handle(e.onBeforeAttach),f.resources.check(e.name,e.resources,function(){f.reference.pending(),p.register.done(n.register.MODULES_HISTROY,e.name),E.handle(e.onAfterAttach),f.reference.waited.done(e.name),_.log("[MODULES]:: ["+e.name+"] was initialized.",_.types.KERNEL_LOGS)})}),!0}else null===f.registry.getSettings(e.name.replace(/^flex\./gi,""))&&f.registry.add({name:e.name,hash:null,autoHash:!1,source:null}),e.name=f.tools.fullName(e.name),f.storage.add(e),f.repository.add(e);return!1}},unexpected:{isReady:function(){return f.attach.unexpected.journal.isReady(!0)},journal:{consts:{MODULES:"(modules)",RESOURCES:"(resources)"},modules:{add:function(e){return f.attach.unexpected.journal.add(e,!0)},done:function(e){f.attach.unexpected.journal.done(e,!0),f.attach.unexpected.journal.isReady(!0)&&t.onFlexLoad()},isIn:function(e){return f.attach.unexpected.journal.isIn(e,!0)},isReady:function(){return f.attach.unexpected.journal.isReady(!0)}},resource:{add:function(e){return f.attach.unexpected.journal.add(e,!1)},done:function(e){return f.attach.unexpected.journal.done(e,!1)},isIn:function(e){return f.attach.unexpected.journal.isIn(e,!1)}},add:function(e,t){var r=f.attach.unexpected.journal.consts,o=p.globaly.get(n.storage.GROUP,(t?r.MODULES:r.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{});o[e]||(o[e]=!1)},done:function(e,t){var r=f.attach.unexpected.journal.consts,o=p.globaly.get(n.storage.GROUP,(t?r.MODULES:r.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{});void 0!==o[e]&&(o[e]=!0)},isIn:function(e,t){var r=f.attach.unexpected.journal.consts,o=p.globaly.get(n.storage.GROUP,(t?r.MODULES:r.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{});return void 0!==o[e]},isReady:function(e){var t=f.attach.unexpected.journal.consts,r=p.globaly.get(n.storage.GROUP,(e?t.MODULES:t.RESOURCES)+n.storage.UNEXPECTED_JOURNAL,{}),o=!0;return l.objects.forEach(r,function(e,t){o=o!==!1&&t}),o}},launched:{storage:[],add:function(e){f.attach.unexpected.launched.storage.push(e)},reset:function(e){f.attach.unexpected.launched.storage=null},accept:function(){f.attach.unexpected.launched.storage.forEach(function(e){e.call(window)}),f.attach.unexpected.launched.reset()}},safely:function(t,n){function r(t){return"string"==typeof t?E.url.sterilize(t.replace(e.defaults.settings.ATTACH_PATH_SIGNATURE,e.defaults.paths.ATTACH+"/")):null}function o(){f.attach.unexpected.journal.modules.add(t.src),t.require=t.require.map(function(e){return"string"==typeof e.url?(e.url=r(e.url),null!==e&&(e=f.attach.unexpected.journal.resource.isIn(e.url)===!1?e:null),e):(_.log("["+t.name+"]:: some resource was defined incorrectly. Field [url] was not found.",_.types.CRITICAL),null)}),t.require=t.require.filter(function(e){return null!==e}),c.update.add(t.src),t.require.length>0?(a=y.id(t.src),p.register.open(a,t.require.map(function(e){return e.url}),function(){f.attach.unexpected.embody(t)}),t.require.forEach(function(e){f.attach.unexpected.journal.resource.add(e.url)}),t.require.forEach(function(e){c.update.add(e.url),d.repository.call(e.url,c.get(e.url),function(){p.register.done(a,e.url),f.attach.unexpected.journal.resource.done(e.url)})})):f.attach.unexpected.embody(t)}var a=null,n="boolean"==typeof n&&n;l.objects.validate(t,[{name:"name",type:"string"},{name:"launch",type:"function",value:null},{name:"constructor",type:"function",value:null},{name:"module",type:"function",value:null},{name:"require",type:"array",value:[]},{name:"onBeforeAttach",type:"function",value:null},{name:"onAfterAttach",type:"function",value:null},{name:"extend",type:["array","object"],value:null}])!==!1?(n||(t.src=E.resources.js.getCurrentSRC()),t.src=null===t.src?d.inbuilt.get.js():t.src,null!==t.src?f.attach.unexpected.journal.modules.isIn(t.src)===!1&&(null!==t.launch?o():null!==t.module&&(f.registry.add({name:t.name,source:t.src,hash:c.get(t.src),autoHash:!0})!==!1?o():_.log("["+t.name+"]:: attempt to attach module twice",_.types.WARNING))):_.log("["+t.name+"]:: unexpected error with module. Cannot detect URL",_.types.CRITICAL)):"string"==typeof t.name?"function"!=typeof t.module&&_.log("["+t.name+"]:: to attach new module, should be defined parameter [module] as function",_.types.CRITICAL):_.log("Fail to attach new module.",_.types.CRITICAL)},embody:function(e){var t=null;if(l.objects.validate(e,[{name:"name",type:"string"},{name:"src",type:"string"},{name:"launch",type:"function",value:null},{name:"constructor",type:"function",value:null},{name:"module",type:"function",value:null},{name:"onBeforeAttach",type:"function",value:null},{name:"onAfterAttach",type:"function",value:null},{name:"extend",type:["array","object"],value:[]}])!==!1){if(null!==e.launch)return f.attach.unexpected.launched.add(e.launch),f.attach.unexpected.journal.modules.done(e.src),!0;if(null!==e.module&&(e.name=f.tools.fullName(e.name),t=l.namespace.get(e.name),null!==t&&t!==!1&&void 0===t.create))return e.protofunction=null===e.constructor?function(){}:e.constructor,e.protofunction.prototype=e.module,t.create=f.attach.embody.createConstructor(e.name,e.protofunction),f.attach.unexpected.journal.modules.done(e.src),
!0}return!1}}},resources:{loader:{load:function(e,t,n){var o=r.create(e,r.settings.methods.GET,null,{success:function(n,r){f.resources.loader.success(e,n,t)},fail:function(n,r){f.resources.loader.fail(r,e,n,t)}});o.send()},success:function(e,t,r){E.localStorage.setJSON(e,{value:t.original,url:e,hash:r},n.other.STORAGE_PREFIX)},fail:function(e,t,n,r){_.log("[MODULES]:: cannot load resource: ["+t+"]. Resource will be attached.",_.types.WARNING)}},check:function(e,t,r){var o=f.registry.getSettings(e);null!==o&&null!==t&&(t instanceof Array||(t=[t]),t.length>0?(t=t.map(function(e){if("string"==typeof e.url)return{url:f.registry.validateSRC(e.url),hash:o.autoHash===!0?c.get(e.url):o.hash,autoHash:o.autoHash}}),p.register.open(n.register.RESOURCES_HISTORY+":"+e,t.map(function(e){return e.url}),r),f.resources.get(t,e)):r())},get:function(e,t){var r=p.globaly.get(n.storage.GROUP,n.storage.RESOURCES_JOURNAL,{});Array.prototype.forEach.call(e,function(e){r[e.url]||(f.resources.load(t,e),r[e.url]=t)})},load:function(t,r){function o(e,t){var r=null,o=E.url.getTypeOfResource(t.url);if(o===n.resources.types.CSS)E.resources.css.adoption(t.value,null,E.url.restoreFullURL(t.url));else if(o===n.resources.types.JS){r=new Function(t.value);try{r.call(window),_.log("[MODULES]:: resource: ["+t.url+"] was adopted.",_.types.KERNEL_LOGS)}catch(e){_.log("[MODULES]:: during initialization of resource: ["+t.url+"] happened error:/n/r"+_.parseError(e),_.types.WARNING)}}p.register.done(n.register.RESOURCES_HISTORY+":"+e,t.url)}function l(e,t){var r=E.url.getTypeOfResource(t.url);r===n.resources.types.CSS?E.resources.css.connect(t.url,function(){p.register.done(n.register.RESOURCES_HISTORY+":"+e,t.url),_.log("[MODULES]:: resource of module ["+e+"] (file: ["+t.url+"]) is reloaded.",_.types.KERNEL_LOGS)},null):r===n.resources.types.JS&&E.resources.js.connect(t.url,function(){p.register.done(n.register.RESOURCES_HISTORY+":"+e,t.url),_.log("[MODULES]:: resource of module ["+e+"] (file: ["+t.url+"]) is reloaded.",_.types.KERNEL_LOGS)},null),f.resources.loader.load(t.url,t.hash,t.autoHash)}var a=E.localStorage,s=a.getJSON(r.url,n.other.STORAGE_PREFIX);null!==s&&e.defaults.resources.USE_STORAGED!==!1?r.hash===s.hash?o(t,s):(l(t,r),_.log("[MODULES]:: resource of module ["+t+"] (file: ["+r.url+"]) will be reloaded.",_.types.KERNEL_LOGS)):l(t,r),r.autoHash===!0&&c.update.add(r.url)}},repository:{add:function(e){var t=f.registry.getSettings(e.name),r={name:e.name||null,constr:e.protofunction||null,protofunction:e.protofunction.prototype||null,reference:e.reference||null,resources:e.resources||null,onBeforeAttach:e.onBeforeAttach||null,onAfterAttach:e.onAfterAttach||null,extend:e.extend||null,unexpected:e.unexpected||null};f.repository.getHash(e.name);return r.constr="function"==typeof r.constr?g.js.stringify(r.constr):null,r.protofunction="function"==typeof r.protofunction?g.js.stringify(r.protofunction):null,r.reference=r.reference instanceof Array?r.reference:null,r.onBeforeAttach="function"==typeof r.onBeforeAttach?g.js.stringify(r.onBeforeAttach):null,r.onAfterAttach="function"==typeof r.onAfterAttach?g.js.stringify(r.onAfterAttach):null,null!==r.constr&&null!==r.protofunction?(_.log("[MODULES]:: module ["+e.name+"] was updated.",_.types.KERNEL_LOGS),t.autoHash===!0&&(t.hash=c.get(t.source),c.set(t.source,t.hash),c.update.add(t.source)),E.localStorage.set(e.name,JSON.stringify({data:r,hash:t.hash}),!0,n.other.STORAGE_PREFIX)):null},get:function(t,r){var o=E.localStorage,l=o.get(t,!0,n.other.STORAGE_PREFIX),a=f.registry.getSettings(t);if(null===a.source&&null!==l||null!==l&&e.defaults.resources.USE_STORAGED!==!1)try{return l=JSON.parse(l),l.hash===r||null===a.source?(l.data.protofunction=g.js.parse({constr:{params:l.data.constr.params,body:l.data.constr.body},proto:{params:l.data.protofunction.params,body:l.data.protofunction.body}}),null!==l.data.onBeforeAttach&&(l.data.onBeforeAttach=g.js.parseFunction(l.data.onBeforeAttach.params,l.data.onBeforeAttach.body)),null!==l.data.onAfterAttach&&(l.data.onAfterAttach=g.js.parseFunction(l.data.onAfterAttach.params,l.data.onAfterAttach.body)),l.data.constr=null,delete l.data.constr,l.data):(_.log("[MODULES]:: module ["+t+"] will be updated.",_.types.KERNEL_LOGS),u.events.fire.ON_UPDATED_MODULE(t),o.del(t,n.other.STORAGE_PREFIX),null)}catch(e){return _.log("[MODULES]:: new module ["+t+"] is detected.",_.types.WARNING),u.events.fire.ON_NEW_MODULE(t),o.del(t,n.other.STORAGE_PREFIX),null}else _.log("[MODULES]:: new module ["+t+"] new module is detected.",_.types.WARNING),u.events.fire.ON_NEW_MODULE(t);return null},getHash:function(e){var t=E.localStorage,r=t.get(e,!0,n.other.STORAGE_PREFIX);if(null!==r)try{return r=JSON.parse(r),r.hash}catch(e){return null}return null},call:function(e){var e=f.tools.clearName(e),t=f.registry.getSettings(e),r=null;if(null!==t&&void 0!==t.hash){if(p.register.add(n.register.MODULES_HISTROY,f.tools.clearName(e)),r=f.storage.get(f.tools.fullName(e)),r=null!==r?r:f.repository.get(f.tools.fullName(e),t.hash),null!==r)return f.attach.safely(r),!0;if(E.url.is.js(t.source))return E.resources.js.connect(t.source,null,null),!0;if(E.url.is.css(t.source))return E.resources.css.connect(t.source,null,null),!0}return _.log("[MODULES]:: module ["+e+"] cannot be called. Check definitions in registry [flex.registry.modules.js].",_.types.CRITICAL),!1}},tools:{fullName:function(e){return e=e.toLowerCase(),(0!==e.indexOf("flex.libraries.")?"flex.libraries."+e:e).replace(/\.\./gi,".")},clearName:function(e){return e=e.toLowerCase().replace("flex.",""),e.indexOf("libraries.")===-1?"flex.libraries."+e:"flex."+e}}},d={isReady:function(){return void 0!==d.preload.__started&&p.register.isReady(n.register.EXTERNAL_HISTROY)},queue:{create:function(e){p.register.open(n.register.EXTERNAL_HISTROY,e.map(function(e){return e.url}),t.onFlexLoad)},add:function(e){return"string"==typeof e&&p.register.add(n.register.EXTERNAL_HISTROY,e)},done:function(e){return"string"==typeof e&&p.register.done(n.register.EXTERNAL_HISTROY,e)}},preload:function(){var n=e.defaults.resources.EXTERNAL;d.preload.__started=!0,n instanceof Array&&n.length>0?(d.queue.create(n),Array.prototype.forEach.call(n,function(e){l.objects.validate(e,[{name:"url",type:"string"},{name:"hash",type:"string",value:!1}])!==!1&&(e.autoHash=e.hash===!1,e.hash=e.hash===!1?c.get(e.url):e.hash,d.repository.call(e.url,e.hash),e.autoHash===!0&&c.update.add(e.url))})):t.onFlexLoad()},embody:function(t){function r(n,r,o,l){var a=null;if(e.defaults.resources.USE_STORAGED===!1||null===t.body)E.resources.js.connect(r,o,l);else{a=new Function(n);try{return d.inbuilt.set.js(r),a.call(window),d.inbuilt.set.js(null),E.handle(o,null,"external.embody",this),!0}catch(e){return _.log("During initialization of resource: ["+r+"] happened error:/n/r"+_.parseError(e),_.types.WARNING),E.handle(l,null,"external.embody",this),!1}}}function o(n,r,o,l){return e.defaults.resources.USE_STORAGED===!1||null===t.body?E.resources.css.connect(r,o,l):(d.inbuilt.set.css(r),E.resources.css.adoption(n,null,E.url.restoreFullURL(r)),d.inbuilt.set.css(null),E.handle(o,null,"external.embody",this)),!0}var l=null,a=E.url.getTypeOfResource(t.url);a===n.resources.types.JS?l=r:a===n.resources.types.CSS&&(l=o),null!==l&&l(t.body,t.url,function(){null!==t.callback?E.handle(t.callback,t.url,"[flex]external.embody"):d.queue.done(t.url)},function(){_.log("Resource ["+t.url+"] was not load. But FLEX continues loading.",_.types.CRITICAL),null===t.callback&&d.queue.done(t.url)})},inbuilt:{storage:{js:null,css:null},set:{js:function(e){d.inbuilt.storage.js=e},css:function(e){d.inbuilt.storage.css=e}},get:{js:function(){return d.inbuilt.storage.js},css:function(){return d.inbuilt.storage.css}}},repository:{add:function(t){var r=d.repository.getHash(t.url);return r!==t.hash&&e.defaults.resources.USE_STORAGED!==!1&&null!==t.body?E.localStorage.set(t.url,JSON.stringify({body:t.body,hash:t.hash}),!0,n.other.STORAGE_PREFIX):null},get:function(t,r){var o=E.localStorage,l=o.get(t,!0,n.other.STORAGE_PREFIX);if(null!==l&&e.defaults.resources.USE_STORAGED!==!1)try{return l=JSON.parse(l),l.hash===r?l:(o.del(t,n.other.STORAGE_PREFIX),u.events.fire.ON_UPDATED_RESOURCE(t),null)}catch(e){return u.events.fire.ON_NEW_RESOURCE(t),o.del(t,n.other.STORAGE_PREFIX),null}else u.events.fire.ON_NEW_RESOURCE(t);return null},getHash:function(e){var t=E.localStorage,r=t.get(e,!0,n.other.STORAGE_PREFIX);if(null!==r)try{return r=JSON.parse(r),r.hash}catch(e){return null}return null},call:function(e,t,n){var r=d.repository.get(e,t),n="function"==typeof n?n:null;null!==r&&r.hash===t?d.embody({url:e,hash:t,body:r.body,callback:n}):d.loader.load(e,t,!0,n)}},loader:{load:function(e,t,n,o){var l=r.create(e,r.settings.methods.GET,null,{success:function(r,l){d.loader.success(e,r,t,n,o)},fail:function(r,l){d.loader.fail(l,e,t,n,o)}});l.send(),_.log("[EXTERNAL]:: resource: ["+e+"] will be reloaded.",_.types.KERNEL_LOGS)},success:function(e,t,n,r,o){d.repository.add({url:e,hash:n,body:null!==t?t.original:null}),r===!0&&d.embody({url:e,hash:n,body:null!==t?t.original:null,callback:o}),_.log("[EXTERNAL]:: resource: ["+e+"] is reloaded.",_.types.KERNEL_LOGS)},fail:function(e,t,n,r,o){_.log("[EXTERNAL]:: cannot load resource: ["+t+"] cannot be loaded by XMLHttpRequest.",_.types.WARNING),d.embody({url:t,hash:n,body:null,callback:o})}}},h={isReady:function(){return void 0!==h.preload.__started&&(!e.defaults.resources.WAIT_ASYNCHRONOUS||p.register.isReady(n.register.ASYNCHRONOUS_HISTORY))},preload:function(){var r=e.defaults.resources.ASYNCHRONOUS;h.preload.__started=!0,r instanceof Array&&r.length>0?(p.register.open(n.register.ASYNCHRONOUS_HISTORY,Array.prototype.map.call(r,function(e,t){return t}),function(){t.onFlexLoad()}),Array.prototype.forEach.call(r,function(e,t){var r=y.id();l.objects.validate(e,[{name:"resources",type:"array"},{name:"storage",type:"boolean",value:!0},{name:"finish",type:"function",value:null}])!==!1&&(e.resources=e.resources.filter(function(e){return"string"==typeof e.url}),p.register.open(r,e.resources.map(function(e){return e.url}),function(){E.handle(e.finish),p.register.done(n.register.ASYNCHRONOUS_HISTORY,t)}),e.resources.forEach(function(t){l.objects.validate(t,[{name:"url",type:"string"},{name:"hash",type:"string",value:!1},{name:"after",type:"array",value:!1}])!==!1&&(t.hash===!1&&(t.hash=c.get(t.url),c.update.add(t.url)),h.repository.call(t,r,e.storage))}))})):t.onFlexLoad()},embody:function(t){function r(n,r,o,l){var a=null;if(e.defaults.resources.USE_STORAGED===!1||l===!1||null===t.body)return E.resources.js.connect(o,function(){p.register.done(n,o),h.wait.check()},function(){_.log("[ASYNCHRONOUS]:: cannot load resource: ["+o+"].",_.types.CRITICAL)}),!1;a=new Function(r);try{return a.call(window),!0}catch(e){return _.log("[ASYNCHRONOUS]:: during initialization of resource: ["+o+"] happened error:/n/r"+_.parseError(e),_.types.WARNING),!1}}function o(n,r,o,l){return e.defaults.resources.USE_STORAGED===!1||l===!1||null===t.body?E.resources.css.connect(o,null,function(){_.log("[ASYNCHRONOUS]:: cannot load resource: ["+o+"].",_.types.CRITICAL)}):E.resources.css.adoption(r,null,E.url.restoreFullURL(o)),!0}var l=E.url.getTypeOfResource(t.url),a=null;l===n.resources.types.JS?a=r:l===n.resources.types.CSS&&(a=o),null!==a&&a(t.id,t.body,t.url,t.storage)!==!1&&(p.register.done(t.id,t.url),h.wait.check())},repository:{add:function(t){return e.defaults.resources.USE_STORAGED!==!1&&null!==t.body?E.localStorage.set(t.url,JSON.stringify({body:t.body,hash:t.hash}),!0,n.other.STORAGE_PREFIX):null},get:function(t,r){var o=E.localStorage,l=o.get(t,!0,n.other.STORAGE_PREFIX);if(null!==l&&e.defaults.resources.USE_STORAGED!==!1)try{return l=JSON.parse(l),l.hash!==r?(_.log("[ASYNCHRONOUS]:: resource ["+t+"] will be updated.",_.types.KERNEL_LOGS),o.del(t,n.other.STORAGE_PREFIX),u.events.fire.ON_UPDATED_RESOURCE(t),null):l}catch(e){return o.del(t,n.other.STORAGE_PREFIX),u.events.fire.ON_NEW_RESOURCE(t),null}else u.events.fire.ON_NEW_RESOURCE(t);return null},call:function(e,t,n){function r(e,t,n){var r=h.repository.get(e.url,e.hash);null!==r||n===!1?h.embody({url:e.url,id:t,body:null!==r?r.body:null,storage:n}):h.loader.load(e.url,t,!0,n,e.hash)}var o=!0;e.after===!1?r(e,t,n):(e.after.forEach(function(e){o=o!==!1&&p.register.isDone(t,e)}),o!==!1?(r(e,t,n),h.wait.remove(e.url)):h.wait.add(e,t,n))}},loader:{load:function(e,t,n,o,l){var a=r.create(e,r.settings.methods.GET,null,{success:function(r,a){h.loader.success(e,r,t,n,o,l)},fail:function(r,a){h.loader.fail(a,e,r,t,n,o,l)}});a.send()},success:function(e,t,n,r,o,l){o!==!1&&null!==t&&void 0!==t.original&&h.repository.add({url:e,body:t.original,hash:l}),r!==!1&&h.embody({url:e,id:n,body:null!==t?t.original:null,storage:o})},fail:function(e,t,n,r,o,l,a){_.log("[ASYNCHRONOUS]:: cannot load resource: ["+t+"] cannot be loaded by XMLHttpRequest.",_.types.WARNING),h.embody({url:t,id:r,body:null,storage:!1})}},wait:{storage:{},add:function(e,t,n){var r=h.wait.storage;r[e.url]||(r[e.url]=e,r[e.url].id=t,r[e.url].storage=n)},remove:function(e){var t=h.wait.storage;t[e]&&(t[e]=null,delete t[e])},check:function(){var e=h.wait.storage;for(var t in e)h.repository.call(e[t],e[t].id,e[t].storage)}}},g={js:{stringify:function(e){var t=g.js.tools,n=null,r=null;if("function"==typeof e)return n=e.toString(),r={params:t.getParams(n),body:t.getBody(n)},null!==r.params&&null!==r.body?r:null},parse:function(e){var t=g.js.parseFunction(e.constr.params,e.constr.body);return"function"==typeof t&&(t.prototype=g.js.parseFunction(e.proto.params,e.proto.body),"function"==typeof t.prototype)?t:null},parseFunction:function(e,t){return"string"==typeof e&&"string"==typeof t?""===e?new Function(t):new Function(e,t):null},tools:{regs:{FUNCTION:/^\(?function\s.*?\(.*?\)\s*?\{/gi,ARGUMENTS:/\(.*?\)/gi,ARGUMENTS_BORDERS:/[\(\)]/gi,BODY_END:/\}$/gi,STRICT:/(use strict)/gi},getBody:function(e){return e=e.replace(g.js.tools.regs.FUNCTION,""),e=e.replace(g.js.tools.regs.BODY_END,""),e.search(g.js.tools.regs.STRICT)===-1&&(e='"use strict";'+e),e},getParams:function(e){var t=e.match(g.js.tools.regs.FUNCTION);return null!==t&&1===t.length&&(t=t[0].match(g.js.tools.regs.ARGUMENTS),1===t.length)?t=t[0].replace(g.js.tools.regs.ARGUMENTS_BORDERS,""):null}}},css:{stringify:function(e){function t(e){function t(e){var t="";return e.cssRules&&(t="@keyframes "+e.name+" {\n\r",Array.prototype.forEach.call(e.cssRules,function(e){t+=e.keyText+" { "+e.style.cssText+" }\n\r"}),t+="}"),t}var n="";document;return e.cssRules||e.rules?Array.prototype.forEach.call(e.cssRules||e.rules,function(e){n+="string"==typeof e.cssText?e.cssText+"\n\r":t(e)+"\n\r"}):"string"==typeof e.cssText&&(n=e.cssText),n}var n=(document.styleSheets,null);try{Array.prototype.forEach.call(document.styleSheets,function(r){if(r.href&&r.href.indexOf(e)!==-1)throw n=t(r),"found"})}catch(e){}finally{return n}}}},p={globaly:{storage:{},get:function(e,t,n){var r=p.globaly.storage;return e in r&&t in r[e]?r[e][t]:n?p.globaly.set(e,t,n):null},set:function(e,t,n){var r=p.globaly.storage;return r[e]=e in r?r[e]:{},r[e][t]=n,r[e][t]},remove:function(e,t){var n=p.globaly.storage;return e in n&&t in n[e]&&(n[e][t]=null,delete n[e][t],0===Object.keys(n[e]).length&&(n[e]=null,delete n[e]),!0)}},objecty:{settings:{COMMON_STORAGE_NAME:"FlexObjectStorage"},set:function(e,t,n,r){var r="boolean"!=typeof r||r,o=p.objecty.settings;return"object"==typeof e&&"string"==typeof t&&void 0!==n?("object"!=typeof e[o.COMMON_STORAGE_NAME]&&(e[o.COMMON_STORAGE_NAME]={}),r===!1?void 0===e[o.COMMON_STORAGE_NAME][t]&&(e[o.COMMON_STORAGE_NAME][t]=n):e[o.COMMON_STORAGE_NAME][t]=n,n):null},get:function(e,t,n,r){var n="boolean"==typeof n&&n,r=void 0!==r?r:null,o=null,l=p.objecty.settings,a=p.objecty.tools;if("object"==typeof e&&"string"==typeof t)if("object"==typeof e[l.COMMON_STORAGE_NAME]){if(void 0!==e[l.COMMON_STORAGE_NAME][t])return o=e[l.COMMON_STORAGE_NAME][t],n===!0&&(e[l.COMMON_STORAGE_NAME][t]=null,a.deleteAttribute(e,t),a.clear(e)),o;if(null!==r)return e[l.COMMON_STORAGE_NAME][t]=r,e[l.COMMON_STORAGE_NAME][t]}else if(null!==r)return e[l.COMMON_STORAGE_NAME]={},e[l.COMMON_STORAGE_NAME][t]=r,e[l.COMMON_STORAGE_NAME][t];return null},remove:function(e,t){var n=p.objecty.settings,r=p.objecty.tools;return"object"==typeof e&&"string"==typeof t?"object"==typeof e[n.COMMON_STORAGE_NAME]&&void 0!==e[n.COMMON_STORAGE_NAME][t]&&(e[n.COMMON_STORAGE_NAME][t]=null,r.deleteAttribute(e,t),r.clear(e),!0):null},tools:{deleteAttribute:function(e,t){try{delete e[t]}catch(n){e.removeAttribute(t)}},clear:function(e){var t=p.objecty.settings,n=p.objecty.tools;0===Object.keys(e[t.COMMON_STORAGE_NAME]).length&&(e[t.COMMON_STORAGE_NAME]=null,n.deleteAttribute(e,t.COMMON_STORAGE_NAME))}}},register:{settings:{COMMON_STORAGE_NAME:"FlexRegisterStorage"},build:function(e,t){var n=function(e,t){this.name=e,this.onReady=t,this.items={}};return n.prototype={add:function(e){return!this.items[e]&&(this.items[e]={isDone:!1,key:e},!0)},done:function(e,t){var t="boolean"==typeof t&&t;return this.items[e]&&(this.items[e].isDone=!0),t===!1&&this.isReady()!==!1&&(null!==this.onReady&&void 0===this.handled&&(this.handled=!0,E.handle(this.onReady,null,"Register: "+this.name,this)),!0)},isReady:function(){for(var e in this.items)if(this.items[e].isDone===!1)return!1;return!0},isIn:function(e){return!!this.items[e]},isDone:function(e){return this.items[e]?this.items[e].isDone:null}},new n(e,t)},open:function(e,t,r){var e="string"==typeof e?e:null,t=t instanceof Array?t:void 0!==t?[t]:null,r="function"==typeof r?r:null,o=null,l=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return null!==e&&!l[e]&&(o=p.register.build(e,r),t.forEach(function(e){o.add(e)}),l[e]=o,!0)},add:function(e,t){var r=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!!r[e]&&r[e].add(t)},done:function(e,t,r){var o=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{}),r="boolean"==typeof r&&r;return o[e]&&o[e].done(t,r)!==!1&&(o[e]=null,delete o[e]),!1},isIn:function(e,t){var r=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!!r[e]&&r[e].isIn(t)},isDone:function(e,t){var r=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!!r[e]&&r[e].isDone(t)},isReady:function(e){var t=p.globaly.get(n.storage.GROUP,p.register.settings.COMMON_STORAGE_NAME,{});return!t[e]||t[e].isReady()}}},o={DOM:{add:function(){return"function"==typeof window.addEventListener?function(e,t,n){var r=t instanceof Array?t:[t];Array.prototype.forEach.call(r,function(t){e.addEventListener(t,n,!1)})}:"function"==typeof document.attachEvent?function(e,t,n){var r=t instanceof Array?t:[t];Array.prototype.forEach.call(r,function(t){e.attachEvent("on"+t,n)})}:function(e,t,n){var r=t instanceof Array?t:[t];Array.prototype.forEach.call(r,function(t){e["on"+t]=n})}}(),remove:function(){return"function"==typeof window.removeEventListener?function(e,t,n){e.removeEventListener(t,n,!1)}:"function"==typeof document.detachEvent?function(e,t,n){e.detachEvent("on"+t,n)}:function(e,t,n){e["on"+t]=null}}()},core:{storage:{},listen:function(e,t,n,r,l){var e=e||null,t=t||null,n=n||null,r=r||y.id(),l="boolean"==typeof l&&l,a=null,s=o.core;return null!==e&&null!==t&&null!==n&&((l===!1||null!==s.get(e,t))&&(a=s.register(e,t),a[r]=n,r))},remove:function(e,t,n){var e=e||null,t=t||null,n=n||null,r=null,l=o.core.storage,a=o.core;return null!==e&&null!==t&&null!==n&&(r=a.register(e,t),n in r)&&(r[n]=null,delete r[n],0===Object.keys(r).length&&(l[e][t]=null,delete l[e][t],0===Object.keys(l[e]).length&&(l[e]=null,delete l[e])),!0)},register:function(e,t){var n=o.core.storage;return e in n||(n[e]={}),t in n[e]||(n[e][t]={}),n[e][t]},get:function(e,t){var n=o.core.storage;return e in n&&t in n[e]?n[e][t]:null},fire:function(e,t,n){var r=o.core.get(e,t);if(null!==r)for(var l in r)try{r[l](n)}catch(e){}}}},E={handle:function(e,t,n,r,o){function l(){return null===t?e.call(r):"number"==typeof t.length&&"object"==typeof t?e.apply(r,t):e.call(r,t)}var e=e||null,t=t||null,n=n||null,r=r||null,o=o||!1;if(null!==e){if(!o)return l();try{return l()}catch(e){return _.log("Initializer runFunction method catch error: \r\n"+_.parseError(e)+"\r\n Call point: "+n,_.types.WARNING),null}}return null},localStorage:{get:function(e,t,n){var r=null,t="boolean"==typeof t&&t,n="string"==typeof n?n:"";try{return r=window.localStorage.getItem(n+e),"string"!=typeof r&&(r=null),t!==!1&&(r=E.convertor.BASE64.decode(r),r=E.convertor.UTF8.decode(r)),r}catch(e){return null}},set:function(e,t,n,r){var o=t,n="boolean"==typeof n&&n,r="string"==typeof r?r:"";try{return window.localStorage.removeItem(r+e),n!==!1&&(o="string"!=typeof t?JSON.stringify(t):o,o=E.convertor.UTF8.encode(o),o=E.convertor.BASE64.encode(o)),window.localStorage.setItem(r+e,o),!0}catch(t){return _.log("Error during saving data into localStorage. [key]:["+e+"]",_.types.WARNING),!1}},del:function(e,t){var t="string"==typeof t?t:"";try{return window.localStorage.removeItem(t+e),!0}catch(t){return _.log("Error during deleting data from localStorage. [key]:["+e+"]",_.types.WARNING),null}},getJSON:function(e,t){var n=E.localStorage.get(e,!0,t);if(null!==n)try{return n=JSON.parse(n)}catch(e){return null}return null},setJSON:function(e,t,n){return E.localStorage.set(e,JSON.stringify(t),!0,n)},reset:function(e){var e="string"==typeof e?e:"",t=[];try{if(null!==e){for(var n in window.localStorage)0===n.indexOf(e)&&t.push(n);t.forEach(function(e){window.localStorage.removeItem(e)})}else window.localStorage.clear();return!0}catch(e){return!1}},isAvailable:function(){var e=y.id(),t=!1;return E.localStorage.set(e,e),t=E.localStorage.get(e)===e,E.localStorage.del(e),t}},resources:{settings:{RESOURCES_MARK_ATTR:{name:"data-flex-connect-mark",value:"dynamically"},CSS_TIMER_PROPERTY:"flex_css_load_event_timer",CSS_TIMER_DURATION:5e3},css:{settings:{URLS:[{reg:/url\('([^\)'].*?)'\)/gi,left:/url\('/gi,right:/'\)/gi,_left:'url("',_right:'")'},{reg:/url\("([^\)"].*?)"\)/gi,left:/url\("/gi,right:/"\)/gi,_left:'url("',_right:'")'}],attr:{SRC:"data-flex-src"}},connect:function(e,t,n){function r(e){var t=E.resources.settings,n=document.createElement("LINK");return n.type="text/css",n.href=e,n.rel="stylesheet",n.setAttribute(t.RESOURCES_MARK_ATTR.name,t.RESOURCES_MARK_ATTR.value),{link:n,append:function(){document.head.appendChild(n)}}}function l(e,t,n){function r(e,t){clearTimeout(e[l.CSS_TIMER_PROPERTY]),e[l.CSS_TIMER_PROPERTY]=null,delete e[l.CSS_TIMER_PROPERTY]}var l=E.resources.settings;e[l.CSS_TIMER_PROPERTY]=setTimeout(function(){if(void 0!==e[l.CSS_TIMER_PROPERTY]){var a=document.createElement("IMG");r(e,l),o.DOM.add(a,["load","error"],function(e){E.handle(n,t,"system.resources.css.connect",this)}),a.src=t}},l.CSS_TIMER_DURATION),o.DOM.add(e,"load",function(o){void 0!==e[l.CSS_TIMER_PROPERTY]&&(r(e,l),E.handle(n,t,"system.resources.css.connect",this))})}function a(e){document.styleSheets;try{Array.prototype.forEach.call(document.styleSheets,function(t){if(t.href.indexOf(e)!==-1)throw"found"})}catch(e){if("found"===e)return!0}return!1}var s=null,t=t||null,n=n||null,e=e||null;return null!==e&&a(e)===!1&&(s=r(e),o.DOM.add(s.link,"error",function(t){_.log("During loading CSS resource ["+e+"] was error",_.types.WARNING)}),null!==n&&o.DOM.add(s.link,"error",n),null!==t?l(s.link,e,t):E.handle(t,null,"system.resources.css.connect",this),s.append(),!0)},adoption:function(e,t,n){var t=null!==t&&"object"==typeof t&&void 0!==t.body?t:document,r=t.createElement("style"),n="string"==typeof n?n:null;if("string"==typeof e)try{return null!==n&&(e=E.resources.css.correctPaths(e,n),r.setAttribute(E.resources.css.settings.attr.SRC,n)),r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(t.createTextNode(e)),t.head.appendChild(r),r}catch(t){return _.log("Error during adoption of CSS resource: url = ["+n+"], cssText starts from ["+e.substr(0,50)+" (...)]",_.types.CRITICAL),null}return null},correctPaths:function(t,n){function r(e,t){var n=null;return 0!==e.trim().toLowerCase().indexOf("data:")?(n=E.url.parse(e,t),null!==n?n.url:e):e}return e.defaults.settings.CHECK_PATHS_IN_CSS!==!1&&"string"==typeof n&&""!==n&&E.resources.css.settings.URLS.forEach(function(e){var o=t.match(e.reg);o instanceof Array&&o.forEach(function(o){var l=o;l=l.replace(e.left,""),l=l.replace(e.right,""),l=r(l,n),null!==l&&(t=t.replace(o,e._left+l+e._right))})}),t}},js:{connect:function(e,t,n){function r(e){var t=E.resources.settings,n=document.createElement("SCRIPT");return n.type="application/javascript",n.src=e,n.setAttribute(t.RESOURCES_MARK_ATTR.name,t.RESOURCES_MARK_ATTR.value),{script:n,append:function(){document.head.appendChild(n)}}}var l=null,t=t||null,n=n||null,e=e||null;return null!==e&&(l=r(e),null!==t&&o.DOM.add(l.script,"load",t),null!==n&&o.DOM.add(l.script,"error",n),l.append(),l.script)},adoption:function(e,t){var n=document.createElement("SCRIPT"),t=t||null,e=e||null;null!==e&&(n.type="application/javascript",n.appendChild(document.createTextNode(e)),document.body.insertBefore(n,document.body.childNodes[0]),null!==t&&E.handle(t,null,"system.resources.js.adoption",this))},getCurrentSRC:function(e){var t=null,e="boolean"==typeof e&&e;try{throw new Error("Script URL detection")}catch(r){return"string"==typeof r.stack&&(t=r.stack.match(n.regs.urls.JS_URL),t instanceof Array&&t.length>0)?e?t[t.length-1]:t[t.length-1].indexOf(n.files.CORE_URL)===-1?t[t.length-1]:null:null}}}},convertor:{UTF8:{encode:function(e){return unescape(encodeURIComponent(e))},decode:function(e){return decodeURIComponent(escape(e))}},BASE64:{decode:function(e){var t,n,r,o,l,a,s={},i=[],c="",u=String.fromCharCode,f=[[65,91],[97,123],[48,58],[43,44],[47,48]],d=0,h=0,p=0;for(n in f)for(t=f[n][0];t<f[n][1];t++)i.push(u(t));for(t=0;t<64;t++)s[i[t]]=t;if(e.length<100);for(t=0;t<e.length;t+=72)for(p=e.substring(t,t+72),o=0;o<p.length;o++)for(r=s[p.charAt(o)],d=(d<<6)+r,h+=6;h>=8;)l=u((d>>>(h-=8))%256),a=l.charCodeAt(0),c=0!==a?c+l:c;return c},encode:function(e){var t,n,r,o,l,a,s,i,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,d=0,h="",p=[];if(!e)return e;do t=e.charCodeAt(f++),n=e.charCodeAt(f++),r=e.charCodeAt(f++),c=t<<16|n<<8|r,o=c>>18&63,l=c>>12&63,a=c>>6&63,s=63&c,p[d++]=u.charAt(o)+u.charAt(l)+u.charAt(a)+u.charAt(s);while(f<e.length);return h=p.join(""),i=e.length%3,(i?h.slice(0,i-3):h)+"===".slice(i||3)}}},url:{settings:{parser:{LAST:/([^\/]*)$/gi,CORRECTION:/[\/\\]$/gi,BAD_SLASH:/\\/gi,PROTOCOL:/:\/\//gi,DOUBLE:/\/{2,}/gi}},getURLInfo:function(e){var t=document.createElement("a"),n=null;return"string"==typeof e&&(t.setAttribute("href",e),n={hostname:t.hostname,host:t.host,port:t.port,protocol:t.protocol,isFull:!1},""!==n.hostname?n.isFull=0===e.indexOf(n.protocol+"//"+n.hostname):n.isFull=!1),n},getCurrentDomain:function(){var e=null;return e=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host},getParams:function(e){var t=null,n=null;return e=e.split("?"),t=2===e.length?e[1]:null,e=e[0],null!==t&&(n=t.split("&"),t={},n.forEach(function(e){var n=e.split("=");2===n.length&&(t[n[0]]=n[1])})),{url:e,params:t}},restoreFullURL:function(e){var t=e;return"string"==typeof e?(t=E.url.getURLInfo(t),t.isFull===!1?""===t.hostname?E.url.getCurrentDomain()+(0!==e.indexOf("/")?"/":"")+e:t.protocol+"//"+t.host+(0!==e.indexOf("/")?"/":"")+e:e):null},parse:function(e,t){function n(e){var t=0,n=!0,r=-1,o="";return e.split("/").forEach(function(e,l){".."===e?(t+=1,r!==-1&&r!==l-1&&(n=!1),r=l):o+="/"+e}),n===!0&&{count:t,url:o}}function r(e){return e=e.replace(E.url.settings.parser.CORRECTION,""),e=e.replace(E.url.settings.parser.BAD_SLASH,"/")}var o=null,l=null,t="string"==typeof t?t:null,a=0,s=null,i=null;if("string"==typeof e&&(e=r(e),i=E.url.getParams(e),e=i.url,i=i.params,l=E.url.getURLInfo(e),null!==l&&(a=n(e),a!==!1)))if(a.count>0){if(null!==t&&(s=E.url.parse(t),null!==s&&a.count<s.parts.length-1))return s.parts.splice(s.parts.length-a.count,a.count),s.parts=s.parts.map(function(e){return"//"===e?"":e}),e=s.parts.join("/")+a.url,E.url.parse(e)}else{if(l.isFull!==!1)return o={target:e.match(E.url.settings.parser.LAST),_path:"",_url:e,_hostname:l.hostname,hostname:""!==l.hostname?l.hostname:window.location.hostname,_host:l.host,host:""!==l.host?l.host:window.location.host,_port:l.port,port:""!==l.port?l.port:window.location.port,_protocol:l.protocol,protocol:":"!==l.protocol?l.protocol:window.location.protocol,home:""===l.hostname?window.location.protocol+"//"+window.location.host:l.protocol+"//"+l.host,_home:""!==l.hostname?l.protocol+"//"+l.host:"",params:i,dirs:null,parts:null},o.target instanceof Array&&o.target.length>0?(o.target=o.target[0],o.target.indexOf(".")===-1&&(o.target=""),o._path=e.replace(o.target,"")):o.target="",""===o._home?(o.path=o.home+(0===o._path.indexOf("/")?"":"/")+o._path,o.url=o.home+(0===o._url.indexOf("/")?"":"/")+o._url):(o.path=o._path,o.url=o._url),o.parts=o.url.split("/").map(function(e){return""===e?"//":e}),o.parts.indexOf(o.target)!==-1&&o.parts.splice(o.parts.indexOf(o.target),1),o.dirs=o.path.replace(o.home,"").split("/"),o.dirs=o.dirs.filter(function(e){return""!==e}),o;if(t=null===t?E.url.getCurrentDomain():t,s=E.url.parse(t),null!==s)return 0===e.indexOf("~/")?e=e.replace("~",s.home):(s.parts=s.parts.map(function(e){return"//"===e?"":e}),e=s.parts.join("/")+(0!==e.indexOf("/")?"/":"")+e),E.url.parse(e)}return null},sterilize:function(e){var t=y.id();return e.replace(E.url.settings.parser.PROTOCOL,t).replace(E.url.settings.parser.BAD_SLASH,"/").replace(E.url.settings.parser.DOUBLE,"/").replace(t,"://")},getTypeOfResource:function(e){var t=e.replace(n.regs.urls.PARAMS,"");return t=t.match(n.regs.urls.EXTENSION),t instanceof Array&&1===t.length?t[0].toLowerCase():null},is:{clear:function(e){return"string"==typeof e?(e=e.split("?"),e=e[0],e=e.replace(n.regs.urls.NOT_URL_SYMBOLS,"")):null},js:function(e){return e=E.url.is.clear(e),null!==e&&(n.regs.urls.JS_EXP_IN_URL.lastIndex=0,n.regs.urls.JS_EXP_IN_URL.test(e))},css:function(e){return e=E.url.is.clear(e),null!==e&&(n.regs.urls.CSS_EXP_IN_URL.lastIndex=0,n.regs.urls.CSS_EXP_IN_URL.test(e))}}}},y={id:function(){var e=0;return function(t){return e+=1,(t||"")+(new Date).valueOf()+"_"+e}}()},_={types:{CRITICAL:"CRITICAL",LOGICAL:"LOGICAL",WARNING:"WARNING",NOTIFICATION:"NOTIFICATION",LOGS:"LOG",KERNEL_LOGS:"KERNEL_LOGS"},rendering:{CRITICAL:"color: #FF0000;font-weight:bold;",LOGICAL:"color: #00FFF7;font-weight:bold;",WARNING:"color: #A69600;font-weight:bold;",NOTIFICATION:"color: #988DFF;font-weight:bold;",LOGS:"color: #6C6C6C;",KERNEL_LOGS:"color: #008B0E;font-weight:bold;"},parseError:function(e){var t=e.name+": "+e.message+"\r\n--------------------------------------------";for(var n in e)"name"!==n&&"message"!==n&&(t=t+"\r\n  "+n+"="+e[n]);return t},log:function(t,n){var n=n||"LOGS";console&&_.types[n]&&void 0!==console.log&&e.defaults.logs.SHOW.indexOf(n)!==-1&&(console.log("%c ["+n+"]%c"+t,_.rendering[n],_.rendering.LOGS),_.callEvent(t,n))},callEvent:function(e,t){null!==l.namespace.get("flex.registry.events.system.logs")&&void 0!==flex.registry.events.system.logs[t]&&o.core.fire(flex.registry.events.system.logs.GROUP,flex.registry.events.system.logs[t],e)}},O={callers:{node:function(){var e={};return function(t,n,r){var o=null,n="boolean"==typeof n&&n;return"string"==typeof t?(n&&e[t]&&null!==e[t]&&(o=e[t]),o=null!==o?o:(r||document).querySelector(t),n&&!e[t]&&null!==o&&(e[t]=o),new O.constructors.node(o)):void 0===t||"string"!=typeof t.nodeName&&t!=window?null:new O.constructors.node(t)}}(),nodes:function(){var e={};return function(t,n,r){var o=null,n="boolean"==typeof n&&n;if("string"==typeof t)return n&&e[t]&&null!==e[t]&&e[t].length>0&&(o=e[t]),o=null!==o?o:(r||document).querySelectorAll(t),n&&!e[t]&&null!==o&&o.length>0&&(e[t]=o),new O.constructors.nodes(o);if(void 0!==t&&"number"==typeof t.length&&t.length>0){
if("string"==typeof t[0])return o=[],Array.prototype.forEach.call(t,function(e,t){var n=(r||document).querySelector(e);null!==n&&o.push(n)}),new O.constructors.nodes(o);if("string"==typeof t[0].nodeName)return new O.constructors.nodes(t)}return null}}(),array:function(e){return e instanceof Array?new O.constructors.array(e):null},string:function(e){return"string"==typeof e?new O.constructors.string(e):null},boolean:function(e){return"boolean"==typeof e?new O.constructors.boolean(e):null},object:function(e){return"object"==typeof e?new O.constructors.object(e):null}},prototypes:{node:{},nodes:{},array:{},string:{},boolean:{},object:{},update:{update:function(e){function t(e){var n=null;for(var r in e)if(e.hasOwnProperty(r))if("object"==typeof e[r]&&"target"!==r){n=function(){return n.target=this.target,n};for(var o in e[r])n[o]=e[r][o];e[r]=n}else"function"==typeof e[r]&&t(e[r])}O.prototypes[e]&&t(O.prototypes[e])},node:function(){O.prototypes.update.update("node")},nodes:function(){O.prototypes.update.update("nodes")},array:function(){O.prototypes.update.update("array")},string:function(){O.prototypes.update.update("string")},boolean:function(){O.prototypes.update.update("boolean")},object:function(){O.prototypes.update.update("object")}},add:{add:function(e,t,n){var r=null,o=null;"string"==typeof e&&"string"==typeof t&&void 0!==n&&O.prototypes[e]&&(r=t.split("."),o=O.prototypes[e],r.forEach(function(e,t){void 0===o[e]?t===r.length-1?o[e]=n:(o[e]={},o=o[e]):"object"==typeof o[e]||"function"==typeof o[e]?o=o[e]:(o[e]={},o=o[e])}),O.prototypes.update[e]())},node:function(e,t){O.prototypes.add.add("node",e,t)},nodes:function(e,t){O.prototypes.add.add("nodes",e,t)},array:function(e,t){O.prototypes.add.add("array",e,t)},string:function(e,t){O.prototypes.add.add("string",e,t)},boolean:function(e,t){O.prototypes.add.add("boolean",e,t)},object:function(e,t){O.prototypes.add.add("object",e,t)}}},constructors:{node:function(e){this.target=e},nodes:function(e){this.target=e},array:function(e){this.target=e},string:function(e){this.target=e},boolean:function(e){this.target=e},object:function(e){this.target=e}},build:function(){for(var e in O.constructors)O.constructors[e].prototype=O.prototypes[e];return!0}},s={execution:function(){return"function"==typeof window[e.defaults.patterns.TEST_FUNCTION]&&(E.handle(window[e.defaults.patterns.TEST_FUNCTION],null,e.defaults.patterns.TEST_FUNCTION,this),!0)},modification:function(){function t(t,n){t[n]instanceof Array&&e.defaults.resources.MODULES instanceof Array&&t[n].forEach(function(t){if("string"==typeof t)switch(n){case"include":e.defaults.resources.MODULES.indexOf(t)===-1&&e.defaults.resources.MODULES.push(t);break;case"exclude":e.defaults.resources.MODULES.indexOf(t)!==-1&&e.defaults.resources.MODULES.splice(e.defaults.resources.MODULES.indexOf(t),1)}})}var n=window[e.defaults.patterns.TEST_FUNCTION];"function"==typeof n&&(t(n,"include"),t(n,"exclude"))}},i={init:e.init,oop:{objects:{copy:l.objects.copy,extend:l.objects.extend,forEach:l.objects.forEach,validate:l.objects.validate,isValueIn:l.objects.isValueIn},classes:{of:l.classes.of,create:l.classes.create},namespace:{create:l.namespace.create,get:l.namespace.get}},modules:{attach:f.attach.safely,append:f.attach.unexpected.safely},unique:y.id,events:{DOM:{add:o.DOM.add,remove:o.DOM.remove},core:{fire:o.core.fire,listen:o.core.listen,register:o.core.register,remove:o.core.remove}},overhead:{globaly:{set:p.globaly.set,get:p.globaly.get,del:p.globaly.remove},objecty:{set:p.objecty.set,get:p.objecty.get,del:p.objecty.remove},register:{open:p.register.open,add:p.register.add,done:p.register.done,isIn:p.register.isIn,isDone:p.register.isDone,isReady:p.register.isReady}},ajax:{send:r.create,methods:{POST:r.settings.methods.POST,GET:r.settings.methods.GET,PUT:r.settings.methods.PUT,DELETE:r.settings.methods.DELETE,OPTIONS:r.settings.methods.OPTIONS}},logs:{parseError:_.parseError,log:_.log,types:_.types},callers:{node:O.callers.node,nodes:O.callers.nodes,array:O.callers.array,object:O.callers.object,string:O.callers.string,boolean:O.callers.boolean,define:{node:O.prototypes.add.node,nodes:O.prototypes.add.nodes,array:O.prototypes.add.array,object:O.prototypes.add.object,string:O.prototypes.add.string,boolean:O.prototypes.add.boolean}},resources:{parse:{css:{stringify:g.css.stringify}},attach:{css:{connect:E.resources.css.connect,adoption:E.resources.css.adoption},js:{connect:E.resources.js.connect,adoption:E.resources.js.adoption,getCurrentSRC:E.resources.js.getCurrentSRC}}},system:{handle:E.handle,convertor:{UTF8:{encode:E.convertor.UTF8.encode,decode:E.convertor.UTF8.decode},BASE64:{encode:E.convertor.BASE64.encode,decode:E.convertor.BASE64.decode}},url:{parse:E.url.parse,restore:E.url.restoreFullURL}},localStorage:{add:E.localStorage.set,get:E.localStorage.get,del:E.localStorage.del,addJSON:E.localStorage.setJSON,getJSON:E.localStorage.getJSON,reset:E.localStorage.reset},hashes:{get:c.get,update:c.update.add},config:{get:e.get,set:e.set}},n.files.detect(),e.init(),o.core.listen("modules.registry","ready",f.attach.queue.proceed),O.build(),l.wrappers.objects(),a.wrappers.array(),{init:i.init,oop:{objects:{copy:i.oop.objects.copy,extend:i.oop.objects.extend,forEach:i.oop.objects.forEach,validate:i.oop.objects.validate,isValueIn:i.oop.objects.isValueIn},classes:{of:i.oop.classes.of,create:i.oop.classes.create},namespace:{create:i.oop.namespace.create,get:i.oop.namespace.get}},modules:{attach:i.modules.attach,append:i.modules.append},unique:i.unique,events:{DOM:{add:i.events.DOM.add,remove:i.events.DOM.remove},core:{fire:i.events.core.fire,listen:i.events.core.listen,register:i.events.core.register,remove:i.events.core.remove}},overhead:{globaly:{set:i.overhead.globaly.set,get:i.overhead.globaly.get,del:i.overhead.globaly.del},objecty:{set:i.overhead.objecty.set,get:i.overhead.objecty.get,del:i.overhead.objecty.del},register:{open:i.overhead.register.open,add:i.overhead.register.add,done:i.overhead.register.done,isIn:i.overhead.register.isIn,isDone:i.overhead.register.isDone,isReady:i.overhead.register.isReady}},ajax:{send:i.ajax.send,methods:i.ajax.methods},resources:{parse:{css:{stringify:i.resources.parse.css.stringify}},attach:{css:{connect:i.resources.attach.css.connect,adoption:i.resources.attach.css.adoption},js:{connect:i.resources.attach.js.connect,adoption:i.resources.attach.js.adoption,getCurrentSRC:i.resources.attach.js.getCurrentSRC}}},localStorage:{add:i.localStorage.add,get:i.localStorage.get,del:i.localStorage.del,addJSON:i.localStorage.addJSON,getJSON:i.localStorage.getJSON,reset:i.localStorage.reset},system:{handle:i.system.handle,convertor:{UTF8:{encode:i.system.convertor.UTF8.encode,decode:i.system.convertor.UTF8.decode},BASE64:{encode:i.system.convertor.BASE64.encode,decode:i.system.convertor.BASE64.decode}},url:{parse:i.system.url.parse,restore:i.system.url.restore}},logs:{parseError:i.logs.parseError,log:i.logs.log,types:i.logs.types},hashes:{get:i.hashes.get,update:i.hashes.update},callers:{node:i.callers.node,nodes:i.callers.nodes,array:i.callers.array,object:i.callers.object,string:i.callers.string,boolean:i.callers.boolean,define:{node:i.callers.define.node,nodes:i.callers.define.nodes,array:i.callers.define.array,object:i.callers.define.object,string:i.callers.define.string,boolean:i.callers.define.boolean}},config:{get:i.config.get,set:i.config.set},libraries:{},libraries_data:{},registry:{}}}(),window.flex=new e,flex.registry.events={system:{logs:{GROUP:"flex.system.logs.messages",CRITICAL:"critical",LOGICAL:"logical",WARNING:"warning",NOTIFICATION:"notification",LOGS:"log",KERNEL_LOGS:"kernel_logs"},cache:{GROUP:"flex.system.cache.events",ON_NEW_MODULE:"ON_NEW_MODULE",ON_UPDATED_MODULE:"ON_UPDATED_MODULE",ON_NEW_RESOURCE:"ON_NEW_RESOURCE",ON_UPDATED_RESOURCE:"ON_UPDATED_RESOURCE"}}},window._node=flex.callers.node,window._nodes=flex.callers.nodes,window._array=flex.callers.array,window._object=flex.callers.object,window._string=flex.callers.string,window._boolean=flex.callers.boolean,window._append=flex.modules.append}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,r=null,o=null,l=null,a=null,s=null,i=null;return a={objects:{STORAGE_PROPERTY:"flex.object.bind.storage",HANDLE_ID_PROPERTY:"flex.object.bind.handle.id"},attrs:{STORAGE_PROPERTY:"flex.attrs.bind.storage",NODE_ID_PROPERTY:"flex.attrs.bind.node.id",HANDLE_ID_PROPERTY:"flex.attrs.bind.handle.id"},props:{STORAGE_PROPERTY:"flex.props.bind.storage",NODE_ID_PROPERTY:"flex.props.bind.node.id",HANDLE_ID_PROPERTY:"flex.props.bind.handle.id"}},s={objects:{INCORRECT_ARGUMENTS:"defined incorrect arguments or not defined at all",PROPERTY_IS_CONST:"cannot kill bind with property, because property now is constant"},support:{DEFINE_PROPERTY:"flex.binds: Current browser does not support Object.defineProperty",MUTATION_SCANNING:"flex.attrs: Current browser does not support any avaliable way to scanning mutation of attributes"}},e={storage:{create:function(e){var t=function(e){this.parent=e,this.binds={}};return t.prototype={make:function(e,t){var n=this;return!this.binds[e]&&(this.binds[e]={current:t,previous:t,setter:function(t){n.binds[e].previous=n.binds[e].current,n.binds[e].current=t;for(var r in n.binds[e].handles)n.binds[e].handles[r].call(n.parent,n.binds[e].current,n.binds[e].previous,r)},getter:function(){return n.binds[e].current},handles:{}},!0)},add:function(e,t){var n=flex.unique();return t[a.objects.HANDLE_ID_PROPERTY]=n,this.binds[e].handles[n]=t,n},remove:function(e,t){return this.binds[e]&&this.binds[e].handles[t]&&(delete this.binds[e].handles[t],0===Object.keys(this.binds[e].handles).length)?delete this.binds[e]:null},kill:function(e){return this.binds[e]?delete this.binds[e]:null},isPropertyReady:function(e){return void 0!==this.binds[e]},destroy:function(){return 0===Object.keys(this.binds).length&&delete this.parent[a.objects.STORAGE_PROPERTY]},setter:function(e){return this.binds[e].setter},getter:function(e){return this.binds[e].getter}},new t(e)}},bind:function(t,n,r){var o=a.objects.STORAGE_PROPERTY,l=null;if(Object.defineProperty){if("object"==typeof t&&"string"==typeof n&&"function"==typeof r){if(l=t[n],t[o]||(t[o]=e.storage.create(t)),o=t[o],!o.isPropertyReady(n)){if(!delete t[n])return o.destroy(),!1;o.make(n,l),Object.defineProperty(t,n,{get:o.getter(n),set:o.setter(n),configurable:!0})}return o.add(n,r)}throw"object.bind::"+s.objects.INCORRECT_ARGUMENTS}},unbind:function(e,t,n){var r=a.objects.STORAGE_PROPERTY,o=null;if("object"==typeof e&&"string"==typeof t&&"string"==typeof n){if(e[r]&&(r=e[r],r.isPropertyReady(t)&&(o=e[t],r.remove(t,n),!r.isPropertyReady(t))))try{return delete e[t],e[t]=o,!0}catch(e){throw"object.unbind::"+s.objects.PROPERTY_IS_CONST}return null}throw"object.unbind::"+s.objects.INCORRECT_ARGUMENTS},kill:function(e,t){var n=a.objects.STORAGE_PROPERTY,r=null;if("object"==typeof e&&"string"==typeof t){if(e[n]){r=e[t],n=e[n];try{return!!n.kill(t)&&(delete e[t],e[t]=r,!0)}catch(e){throw"object.kill::"+s.objects.PROPERTY_IS_CONST}}return null}throw"object.kill::"+s.objects.INCORRECT_ARGUMENTS}},t={storage:{create:function(e){var t=function(e){this.node=e,this.binds={},this._destroy=null};return t.prototype={init:function(){this._destroy=r.attach(this.node,this.handle,this,{attributes:!0,childList:!1,subtree:!0,characterData:!0,attributeOldValue:!1,characterDataOldValue:!1})},handle:function(e,t){var n=this,r=null,o=t.target,l=void 0!==o[a.attrs.NODE_ID_PROPERTY]?o[a.attrs.NODE_ID_PROPERTY]:null;null!==l&&void 0!==this.binds[l]&&void 0!==this.binds[l][e]&&(r=o.getAttribute(e),r!==this.binds[l][e].current&&(this.binds[l][e].previous=this.binds[l][e].current,this.binds[l][e].current=r,_object(this.binds[l][e].handles).forEach(function(r,a){a.call(o,e,n.binds[l][e].current,n.binds[l][e].previous,t,r)})))},make:function(e,t){var n=this.setID(e);this.binds[n]=void 0===this.binds[n]?{}:this.binds[n],this.binds[n][t]=void 0===this.binds[n][t]?{handles:{},previous:null,current:e.getAttribute(t)}:this.binds[n][t]},add:function(e,t,n){var r=e[a.attrs.NODE_ID_PROPERTY],o=flex.unique();return n[a.attrs.HANDLE_ID_PROPERTY]=o,this.binds[r][t].handles[o]=n,o},remove:function(e,t,n){var r=null,o=e[a.attrs.NODE_ID_PROPERTY];return void 0!==this.binds[o]&&void 0!==this.binds[o][t]&&void 0!==this.binds[o][t].handles[n]&&(delete this.binds[o][t].handles[n],0===Object.keys(this.binds[o][t].handles).length)?(r=delete this.binds[o][t],0===Object.keys(this.binds[o]).length&&(r=delete this.binds[o],this.destroy()),r):r},kill:function(e,t){var n=null,r=e[a.attrs.NODE_ID_PROPERTY];return void 0!==this.binds[r]&&void 0!==this.binds[r][t]?(n=delete this.binds[r][t],0===Object.keys(this.binds[r]).length&&(n=delete this.binds[r],this.destroy()),n):n},setID:function(e){return void 0===e[a.attrs.NODE_ID_PROPERTY]&&(e[a.attrs.NODE_ID_PROPERTY]=flex.unique()),e[a.attrs.NODE_ID_PROPERTY]},destroy:function(){return 0===Object.keys(this.binds).length&&(this._destroy(),delete this.node[a.attrs.STORAGE_PROPERTY])}},new t(e)}},bind:function(e,n,o,l){var i=a.attrs.STORAGE_PROPERTY,l=void 0!==l?l:e;if(null!==r.attach){if(void 0!==e&&"string"==typeof n&&"function"==typeof o&&e.nodeName)return l[i]||(l[i]=t.storage.create(l),l[i].init()),i=l[i],i.make(e,n),i.add(e,n,o);throw"attrs.bind::"+s.objects.INCORRECT_ARGUMENTS}},unbind:function(e,t,n,r){var o=a.attrs.STORAGE_PROPERTY,r=void 0!==r?r:e;if("object"==typeof e&&"string"==typeof t&&"string"==typeof n)return r[o]?(o=r[o],o.remove(e,t,n)):null;throw"attrs.unbind::"+s.objects.INCORRECT_ARGUMENTS},kill:function(e,t,n){var r=a.attrs.STORAGE_PROPERTY,n=void 0!==n?n:e;if("object"==typeof e&&"string"==typeof t)return n[r]?(r=n[r],r.kill(e,t)):null;throw"attrs.unbind::"+s.objects.INCORRECT_ARGUMENTS}},n={storage:{create:function(e){var t=function(e){this.node=e,this.binds={},this._destroy=null};return t.prototype={init:function(){this._destroy=r.attach(this.node,this.handle,this,{attributes:!0,childList:!0,subtree:!0,characterData:!0,attributeOldValue:!1,characterDataOldValue:!1})},prop:function(e,t){var n=null;return t.split(".").forEach(function(t,r,o){void 0!==e[t]&&r<o.length-1?e=e[t]:void 0!==e[t]&&r===o.length-1&&(n={parent:e,name:t})}),n},handle:function(e,t){var n=t.target,r=void 0!==n[a.props.NODE_ID_PROPERTY]?n[a.props.NODE_ID_PROPERTY]:null;null!==r&&void 0!==this.binds[r]&&_object(this.binds[r]).forEach(function(e,n){var r=n.parent[e];r!==n.current&&(n.previous=n.current,n.current=r,_object(n.handles).forEach(function(r,o){o.call(n.parent,e,n.current,n.previous,t,r)}))})},make:function(e,t){var n=this.setID(e),t=this.prop(e,t);this.binds[n]=void 0===this.binds[n]?{}:this.binds[n],this.binds[n][t.name]=void 0===this.binds[n][t.name]?{handles:{},previous:null,current:t.parent[t.name],parent:t.parent}:this.binds[n][t.name]},add:function(e,t,n){var r=flex.unique(),o=void 0!==e[a.props.NODE_ID_PROPERTY]?e[a.props.NODE_ID_PROPERTY]:null,t=this.prop(e,t);return n[a.props.HANDLE_ID_PROPERTY]=r,this.binds[o][t.name].handles[r]=n,r},remove:function(e,t,n){var r=null,o=void 0!==e[a.props.NODE_ID_PROPERTY]?e[a.props.NODE_ID_PROPERTY]:null,t=this.prop(e,t);return null!==o&&void 0!==this.binds[o]&&void 0!==this.binds[o][t.name]&&this.binds[o][t.name].handles[n]&&(delete this.binds[o][t.name].handles[n],0===Object.keys(this.binds[o][t.name].handles).length&&(r=delete this.binds[o][t.name],0===Object.keys(this.binds[o]).length&&(r=delete this.binds[o],this.destroy()))),r},kill:function(e,t){var n=null,r=void 0!==e[a.props.NODE_ID_PROPERTY]?e[a.props.NODE_ID_PROPERTY]:null,t=this.prop(e,t);return null!==r&&void 0!==this.binds[r]&&void 0!==this.binds[r][t.name]&&(n=delete this.binds[r][t.name],0===Object.keys(this.binds[r]).length&&(n=delete this.binds[r],this.destroy())),n},setID:function(e){return void 0===e[a.props.NODE_ID_PROPERTY]&&(e[a.props.NODE_ID_PROPERTY]=flex.unique()),e[a.props.NODE_ID_PROPERTY]},destroy:function(){return 0===Object.keys(this.binds).length&&(this._destroy(),delete this.node[a.props.STORAGE_PROPERTY])}},new t(e)}},bind:function(e,t,o,l){function i(e,t){var n=!1;return t.split(".").forEach(function(t,r,o){void 0!==e[t]&&r<o.length-1?e=e[t]:void 0!==e[t]&&r===o.length-1&&(n=!0)}),n}var c=a.props.STORAGE_PROPERTY,l=void 0!==l?l:e;if(null!==r.attach){if(void 0!==e&&"string"==typeof t&&"function"==typeof o&&void 0!==e.nodeName&&i(e,t))return void 0===l[c]&&(l[c]=n.storage.create(l),l[c].init()),c=l[c],c.make(e,t),c.add(e,t,o);throw"props.bind::"+s.objects.INCORRECT_ARGUMENTS}},unbind:function(e,t,n,r){var o=a.props.STORAGE_PROPERTY,r=void 0!==r?r:e;if("object"==typeof e&&"string"==typeof t&&"string"==typeof n)return r[o]?(o=r[o],o.remove(e,t,n)):null;throw"props.unbind::"+s.objects.INCORRECT_ARGUMENTS},kill:function(e,t,n){var r=a.props.STORAGE_PROPERTY,n=void 0!==n?n:e;if("object"==typeof e&&"string"==typeof t)return n[r]?(r=n[r],r.kill(e,t)):null;throw"props.unbind::"+s.objects.INCORRECT_ARGUMENTS}},r={init:function(){r.attach=r.attach()},mutationObserver:function(e,t,n,r){var o=window.MutationObserver||window.WebKitMutationObserver,l=null;return l=new o(function(e){e.forEach(function(e){t.call(n,e.attributeName,e)})}),l.observe(e,r),function(){l.disconnect()}},DOMAttrModified:function(e,t,n){return flex.events.DOM.add(e,"DOMAttrModified",function(e){t.call(n,event.attrName,e)}),function(){}},onPropertyChange:function(e,t,n){return flex.events.DOM.add(e,"propertychange",function(e){t.call(n,event.attributeName,e)}),function(){}},attach:function(){function e(){var e=document.createElement("DIV"),t=!1;return flex.events.DOM.add(e,"DOMAttrModified",function(){t=!0}),e.setAttribute("id","test"),t}return window.MutationObserver||window.WebKitMutationObserver?r.mutationObserver:e()?r.DOMAttrModified:"onpropertychange"in document.body?r.onPropertyChange:null}},l={init:function(){flex.callers.define.object("binding.bind",function(t,n){return e.bind(this.target,t,n)}),flex.callers.define.object("binding.unbind",function(t,n){return e.unbind(this.target,t,n)}),flex.callers.define.object("binding.kill",function(t){return e.kill(this.target,t)}),flex.callers.define.node("bindingAttrs.bind",function(e,n,r){return t.bind(this.target,e,n,r)}),flex.callers.define.node("bindingAttrs.unbind",function(e,n,r){return t.unbind(this.target,e,n,r)}),flex.callers.define.node("bindingAttrs.kill",function(e,n){return t.kill(this.target,e,n)}),flex.callers.define.nodes("bindingAttrs.bind",function(e,n,r){var o=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){o.push(t.bind(l,e,n,r))}),o}),flex.callers.define.nodes("bindingAttrs.unbind",function(e,n,r){var o=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){o.push(t.unbind(l,e,n,r))}),o}),flex.callers.define.nodes("bindingAttrs.kill",function(e,n){var r=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(o){r.push(t.kill(o,e,n))}),r}),flex.callers.define.node("bindingProps.bind",function(e,t,r){return n.bind(this.target,e,t,r)}),flex.callers.define.node("bindingProps.unbind",function(e,t,r){return n.unbind(this.target,e,t,r)}),flex.callers.define.node("bindingProps.kill",function(e,t){return n.kill(this.target,e,t)}),flex.callers.define.nodes("bindingProps.bind",function(e,t,r){var o=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){o.push(n.bind(l,e,t,r))}),o}),flex.callers.define.nodes("bindingProps.unbind",function(e,t,r){var o=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(l){o.push(n.unbind(l,e,t,r))}),o}),flex.callers.define.nodes("bindingProps.kill",function(e,t){var r=[];return SelectorClass(),Array.prototype.forEach.call(this.target,function(o){r.push(n.kill(o,e,t))}),r})}},i={check:function(){if(!Object.defineProperty)throw s.support.DEFINE_PROPERTY;if(null===r.attach)throw s.support.MUTATION_SCANNING}},r.init(),l.init(),i.check(),o={},{}},flex.modules.attach({name:"binds",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,r=null;return t=function(){return null===e&&(e=function(){},e.prototype=function(){function e(e){function t(e){return e.element=void 0!==e.element?e.element:null,e.name="string"==typeof e.name?e.name:null,e.handle="function"==typeof e.handle?e.handle:null,e.id="string"==typeof e.id?e.id:flex.unique(),e.once="boolean"==typeof e.once&&e.once,e.touch="boolean"!=typeof e.touch||e.touch,e.safely="boolean"==typeof e.safely&&e.safely,a.has(e.name)===!1&&(e.touch=!1),e}var e=t(e),n=null;return null!==e.element&&null!==e.handle&&null!==e.name&&(n=s.get(e.element,!1),null!==n&&(n=l.buildCommonHandle(e.element,e.name,n,e.touch,e.safely),n instanceof Array))?(n.push(new c(e.id,e.handle,e.once,e.touch)),e.id):null}function t(e,t,n,r,o){var t=void 0!==t?t:l.fixEvent(),a=s.get(this,!0),i=null,c=flex.unique(),u=null,f=this,d=!1,h=t.type!==r?r:t.type,p=null;if(t&&e&&n&&null!==a&&(t=l.unificationEvent(t),a[h]&&(a=a[h],a.element_id===n))){i=a.handles;try{Array.prototype.forEach.call(i,function(e){if(e.interaction!==c){if(e.interaction=c,u=e.launch(f,t),d=d===!0||e.isRemoving()!==!1,u===!1)throw t.flex.stop(),flex.logs.log("Break event in DOM.fire; \n\r >event: "+t.type+"\n\r >handle_id"+e.id+"\n\r >element_id"+n,flex.logs.types.WARNING),"prevent"}else flex.logs.log("Unexpected behavior of handle event in DOM.fire. Attempt to call handle twice. \n\r >event: "+t.type+"\n\r >handle_id"+e.id+"\n\r >element_id"+n,flex.logs.types.LOGICAL)})}catch(e){"prevent"!==e&&(o?flex.logs.log("Unexpected error in DOM.fire; \n\r >event: "+t.type+"\n\r >element_id"+n,flex.logs.types.CRITICAL):p=e)}finally{d!==!1&&(a.handles=i.filter(function(e){return e.isWorking()!==!1||e.isRemoving()===!1}),0===a.handles.length&&(l.destroyCommonHandle(e,h),s.clear(e)))}if(null!==p)throw p;return!0}return!1}function n(e){function t(e){return void 0!==e[i.HANDLE_EVENT_ID_PROPERTY]?e[i.HANDLE_EVENT_ID_PROPERTY]:null}function n(e){return e.element=void 0!==e.element?e.element:null,e.name="string"==typeof e.name?e.name:null,e.handle="function"==typeof e.handle?e.handle:null,e.id="string"==typeof e.id?e.id:t(e.handle),e}var e=n(e),r=null,o=null;if(null!==e.element&&null!==e.name&&(null===e.id&&null!==e.handle&&void 0!==e.handle[i.HANDLE_EVENT_ID_PROPERTY]&&(e.id=e.handle[i.HANDLE_EVENT_ID_PROPERTY]),null!==e.id&&(r=s.get(e.element,!0),"object"==typeof r[e.name]))){r=r[e.name],o=r.handles;try{Array.prototype.forEach.call(o,function(t){if(t.id===e.id)throw t.toRemove(),"handle found"})}catch(t){"handle found"!==t&&flex.logs.log("Unexpected error in DOM.remove; \n\r >event: "+e.name+"\n\r >event_id"+e.id,flex.logs.types.CRITICAL)}finally{o=o.filter(function(e){return e.isWorking()!==!1||e.isRemoving()===!1}),0===o.length&&(l.destroyCommonHandle(e.element,e.name),s.clear(e.element))}}}function r(e,t,n){var r=null,n="boolean"==typeof n&&n;if(e&&t){if(r=s.get(e,!0),null!==r&&"object"==typeof r[t]){if(r=r[t],n!==!1)try{Array.prototype.forEach.call(r.handles,function(n){if(flex.logs.log("Event fired in DOM.clear.fire; \n\r>event: "+t+"\n\r>handle_id: "+n.id,flex.logs.types.NOTIFICATION),n.launch(e,null)===!1)throw"prevent"})}catch(e){"prevent"===e?flex.logs.log("Break event in DOM.clear.fire; \n\r >event: "+t,flex.logs.types.WARNING):flex.logs.log("Fatal error event in DOM.clear.fire; \n\r >event: "+t,flex.logs.types.WARNING)}return r.handles=[],l.destroyCommonHandle(e,t),s.clear(e),!0}return!1}return null}function o(e,t){function n(e,t){for(var n in t)e[n]=t[n];return e}var r=null,o=null,l=null,a={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},s={type:t,canBubble:!0,cancelable:!0,view:e.ownerDocument.defaultView,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,pointerX:0,pointerY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null},i=n(s,arguments[2]||{});for(var t in a)if(a[t].test(t)){o=t;break}if(!o)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");return document.createEvent?(r=document.createEvent(o),"HTMLEvents"==o?r.initEvent(t,i.bubbles,i.cancelable):r.initMouseEvent(i.type,i.canBubble,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),e.dispatchEvent(r)):(i.clientX=i.pointerX,i.clientY=i.pointerY,l=document.createEventObject(),r=n(l,i),e.fireEvent("on"+t,r)),e}var l=null,a=null,s=null,i={STORAGE_NAME:"FlexEventsStorage",HANDLE_EVENT_ID_PROPERTY:"FlexEventIDProrerty"},c=null,u=null;return c=function(e,t,n,r,o){this.id=e,this.handle=t,this.once=n,this.touch=r,this.safely=o,this.remove=!1,this.interaction=null,this.working=!1,this.device=null},c.prototype={launch:function(e,t){var n=null;if(this.remove===!1&&this.isDouble(t)===!1){try{return this.working=!0,this.remove=this.once,this.handle.call(e,t)}catch(e){if(this.safely)return this.error(t,e),null;n=e}finally{this.working=!1,this.once===!0&&this.remove===!1&&flex.logs.log("Unexpected behavior DOM.fire. Flag [once] is true, but [remove] is false; \n\r >event id"+this.id,flex.logs.types.WARNING)}if(null!==n)throw n}return null},isWorking:function(){return this.working},isRemoving:function(){return this.remove},toRemove:function(){this.remove=!0},error:function(e,t){flex.logs.log("event: "+e.type+"; ID: "+this.id+"; generated error: \r\n"+flex.logs.parseError(t),flex.logs.types.WARNING)},isDouble:function(e){var t="";return t=e.flex.singleTouch?"touch":"mouse",this.device=null===this.device?t:this.device,this.device!==t}},s={get:function(e,t){var t="boolean"!=typeof t||t,n=null;return e?(n=flex.overhead.objecty.get(e,i.STORAGE_NAME),null===n&&t===!1&&(n=flex.overhead.objecty.set(e,i.STORAGE_NAME,{})),n):null},clear:function(e){var t=s.get(e,!0);return null!==t&&(0===Object.keys(t).length&&(flex.overhead.objecty.del(e,i.STORAGE_NAME),!0))}},l={buildCommonHandle:function(e,n,r,o,l){var s=flex.unique();if("object"!=typeof r[n]){if(r[n]={globalHandle:function(r){return t.call(e,e,r,s,n,l)},element_id:s,handles:[]},flex.events.DOM.add(e,n,r[n].globalHandle)===!1)return null;o!==!1&&a.has(n)!==!1&&flex.events.DOM.add(e,a.getType(n),r[n].globalHandle)}return r[n].handles},destroyCommonHandle:function(e,t){var n=null;return e&&t&&(n=s.get(e,!0),"object"==typeof n[t])?(flex.events.DOM.remove(e,t,n[t].globalHandle),a.has(t)!==!1&&flex.events.DOM.remove(e,a.getType(t),n[t].globalHandle),n[t]=null,delete n[t],!0):null},fixEvent:function(){return!event&&window.event?window.event:null},unificationEvent:function(e){function t(e){return e.flex={},e}function n(e,t){if(void 0!==t.clientX)if(void 0===t.pageX&&(e.flex.pageX=null,e.flex.pageY=null),null===t.pageX&&null!==t.clientX){var n=document.documentElement,r=document.body;e.flex.pageX=t.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n.clientLeft||0),e.flex.pageY=t.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n.clientTop||0)}else e.flex.pageX=t.pageX,e.flex.pageY=t.pageY;else e.flex.pageX=null,e.flex.pageY=null;return e.flex.clientX=void 0!==t.clientX?t.clientX:null,e.flex.clientY=void 0!==t.clientY?t.clientY:null,e.flex.offsetX=void 0!==t.offsetX?t.offsetX:void 0!==t.layerX?t.layerX:null,e.flex.offsetY=void 0!==t.offsetY?t.offsetY:void 0!==t.layerY?t.layerY:null,e}function r(e){return void 0===e.preventDefault&&(e.preventDefault=function(){try{this.returnValue=!1}catch(e){}}),void 0===e.stopPropagation&&(e.stopPropagation=function(){try{this.cancelBubble=!0}catch(e){}}),e.flex.stop=function(){return e.preventDefault(),e.stopPropagation(),!1},e}function o(e){return void 0===e.target&&(void 0!==e.srcElement?e.target=e.srcElement:e.target=null),null!==e.target&&void 0===e.relatedTarget&&(void 0!==e.fromElement?e.fromElement===e.target?e.relatedTarget=e.toElement:e.relatedTarget=e.fromElement:(e.relatedTarget=null,e.fromElement=null)),e.flex.target=e.target,e}function l(e){return n(e,e)}function a(e){return void 0===e.which&&void 0!==e.button&&(e.flex.which=1&e.button?1:2&e.button?3:4&e.button?2:0,e.flex.button=e.button),e}function s(e){return"object"==typeof e.touches&&(1===e.touches.length&&(e=n(e,e.touches[0]),e.flex.target=e.touches[0].target,e.flex.singleTouch=!0),e.flex.touches=e.touches),e}return void 0===e.flex&&(e=t(e),e=r(e),e=o(e),e=l(e),e=a(e),e=s(e)),e}},a={events:{click:{touch:"touchstart"},dblclick:{touch:"touchstart"},mousedown:{touch:"touchstart"},mouseenter:{touch:"touchenter"},mouseleave:{touch:"touchleave"},mousemove:{touch:"touchmove"},mouseover:{touch:""},mouseout:{touch:""},mouseup:{touch:"touchend"}},has:function(e){for(var t in a.events)if(t===e||"on"+t===e)return!0;return!1},getType:function(e){for(var t in a.events)if(t===e||"on"+t===e)return a.events[t].touch;return null},getOriginalType:function(e){e=e.toLowerCase();for(var t in a.events)if(a.events[t].touch===e)return t;return null}},u={_add:e,_remove:n,add:function(t,n,r,o,l,a){return e({element:t,name:n,handle:r,id:o,touch:l,safely:a})},remove:function(e,t,r,o){return n({element:e,name:t,handle:r,id:o})},call:o,clear:r,unify:l.unificationEvent},{add:u.add,remove:u.remove,clear:u.clear,call:u.call,unify:u.unify,extendedAdd:u._add,extendedRemove:u._remove}}(),e=new e),e},n={init:function(){flex.callers.define.node("events.add",function(e,n,r,o){return t().add(this.target,e,n,r,o)}),flex.callers.define.node("events.remove",function(e,n,r){return t().remove(this.target,e,n,r)}),flex.callers.define.node("events.call",function(e){return t().call(this.target,e)}),flex.callers.define.nodes("events.add",function(e,n,r,o){Array.prototype.forEach.call(this.target,function(l){t().add(l,e,n,r,o)})}),flex.callers.define.nodes("events.remove",function(e,n,r){Array.prototype.forEach.call(this.target,function(o){t().remove(o,e,n,r)})}),flex.callers.define.nodes("events.call",function(e){Array.prototype.forEach.call(this.target,function(n){t().call(n,e)})})}},n.init(),r={DOMEvents:t},{DOMEvents:r.DOMEvents}},flex.modules.attach({name:"events",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,r=null,o=null,l=null,a=null,s=null,i=null,c=null,u=null,f=null;return f={storage:{GROUP:"flex.html",SCROLL:"scroll",CUSTOM_STYLES:"custom.styles"},classes:{scroll:{MINIMAL_WIDTH:15,MINIMAL_HEIGHT:15}}},e={bySelector:function(){var e=function(){};return e.prototype=function(){function e(e,t){return"string"==typeof e?(t||document).querySelector(e):null}function t(e,t){return"string"==typeof e?(t||document).querySelectorAll(e):null}function n(e,t){var n=null;return"string"==typeof e?(n=o.get(e),null===n&&(n=o.add((t||document).querySelector(e))),n):null}function r(e,t){var n=null;return"string"==typeof e?(n=o.get(e),null===n&&(n=o.add((t||document).querySelectorAll(e))),n):null}var o=null,l=null;return o={data:{},get:function(e){var t=o.data;return void 0!==t[e]?t[e]:null},add:function(e,t){var n=o.data;return n[e]=t,t},remove:function(e){var t=o.data;t[e]=null,delete t[e]},reset:function(){o.data={}}},l={first:e,all:t,cachedFirst:n,cachedAll:r,cacheReset:o.reset,cacheRemove:o.remove},{first:l.first,all:l.all,cachedFirst:l.cachedFirst,cachedAll:l.cachedAll,cacheReset:l.cacheReset,cacheRemove:l.cacheRemove}}(),new e},fromParent:function(){var t=function(){this.selector=e.bySelector()};return t.prototype={selector:null,select:function(e,t,n){var r=flex.unique(),o=null,l="data-"+r;return"string"==typeof e.nodeName&&(e.setAttribute(l,r),o=this.selector[n===!1?"all":"first"](e.nodeName+"["+l+'="'+r+'"] '+t),e.removeAttribute(l)),o},first:function(e,t){return this.select(e,t,!0)},all:function(e,t){return this.select(e,t,!1)}},Object.freeze(new t)}},t=function(){var e=function(){};return e.prototype={childByAttr:function(e,t,n){var r=null,t=t.toLowerCase(),o=this;return void 0!==e.childNodes&&"number"==typeof e.childNodes.length&&Array.prototype.forEach.call(e.childNodes,function(e){
if("string"==typeof e.nodeName&&(e.nodeName.toLowerCase()===t||"*"===t)&&"function"==typeof e.getAttribute)if(null!==n.value){if(e.getAttribute(n.name)===n.value)return e}else if(e.hasAttribute(n.name)===!0)return e;if(r=o.childByAttr(e,t,n),null!==r)return r}),null},childByType:function(e,t){var n=null,t=t.toLowerCase(),r=this;return void 0!==e.childNodes&&"number"==typeof e.childNodes.length&&(Array.prototype.forEach.call(e.childNodes,function(e){if("string"==typeof e.nodeName&&e.nodeName.toLowerCase()===t)return e}),Array.prototype.forEach.call(e.childNodes,function(e){if(n=r.childByType(e,t),null!==n)return n})),null},parentByAttr:function(e,t){return void 0!==e&&void 0!==t&&void 0!==e.parentNode&&null!==e.parentNode&&"function"==typeof e.parentNode.getAttribute?null!==t.value?e.parentNode.getAttribute(t.name)===t.value?e.parentNode:this.parentByAttr(e.parentNode,t):null!==e.parentNode.getAttribute(t.name)?e.parentNode:this.parentByAttr(e.parentNode,t):null}},new e},r=function(){var t=function(){};return t.prototype={nodeByClientRectSize:function(e){var t=0,n=0,r=null;return void 0!==e.getBoundingClientRect&&(r=e.getBoundingClientRect(),t=r.bottom-r.top,n=r.right-r.left),{height:t,width:n}},nodeByOffset:function(e){var t=0,n=0;return void 0!==e.offsetHeight&&(t=e.offsetHeight,n=e.offsetWidth),{height:t,width:n}},nodeWithMargin:function(t){var n,r,o,l,a,s,i,c,u=null,f=this.node(t);return"string"==typeof t&&(u=e.bySelector(),t=u.first(t),u=null),null!==t&&(n=parseInt(document.defaultView.getComputedStyle(t).marginTop,10),r=parseInt(document.defaultView.getComputedStyle(t).marginBottom,10),o=parseInt(document.defaultView.getComputedStyle(t).marginRight,10),l=parseInt(document.defaultView.getComputedStyle(t).marginLeft,10),a=parseInt(document.defaultView.getComputedStyle(t).borderTopWidth,10),s=parseInt(document.defaultView.getComputedStyle(t).borderBottomWidth,10),i=parseInt(document.defaultView.getComputedStyle(t).borderRightWidth,10),c=parseInt(document.defaultView.getComputedStyle(t).borderLeftWidth,10),null!==n&&NaN!==n||(n=0),null!==r&&NaN!==r||(r=0),null!==o&&NaN!==o||(o=0),null!==l&&NaN!==l||(l=0),null!==a&&NaN!==a||(a=0),null!==s&&NaN!==s||(s=0),null!==i&&NaN!==i||(i=0),null!==c&&NaN!==c||(c=0)),{height:f.height+n+r+a+s,width:f.width+o+l+i+c}},node:function(t){var n=null,r={height:0,width:0};return"string"==typeof t&&(n=e.bySelector(),t=n.first(t),n=null),null!==t&&(r=this.nodeByClientRectSize(t),0===r.height&&0===r.width&&(r=this.nodeByOffset(t))),r},window:function(){return self.innerHeight?{height:self.innerHeight,width:self.innerWidth}:document.documentElement&&document.documentElement.clientHeight?{height:document.documentElement.clientHeight,width:document.documentElement.clientWidth}:document.body?{height:document.body.clientHeight,width:document.body.clientWidth}:null},image:function(e){function t(e){var t=new Image,n=null;return t.src=e.src,n={width:t.width,height:t.height},t=null,n}return void 0!==e?"number"==typeof e.naturalWidth?{width:e.naturalWidth,height:e.naturalHeight}:t(e):null}},new t},o=function(){var e=function(){};return e.prototype={window:function(){var e=document.body,t=document.documentElement;return{top:function(){return Math.max(e.scrollTop||0,t.scrollTop||0,e.pageYOffset||0,t.pageYOffset||0,window.pageYOffset||0)},left:function(){return Math.max(e.scrollLeft||0,t.scrollLeft||0,e.pageXOffset||0,t.pageXOffset||0,window.pageXOffset||0)},height:function(){return Math.max(e.scrollHeight||0,e.offsetHeight||0,t.clientHeight||0,t.scrollHeight||0,t.offsetHeight||0)},width:function(){return Math.max(e.scrollWidth||0,e.offsetWidth||0,t.clientWidth||0,t.scrollWidth||0,t.offsetWidth||0)}}},get:function(e){return e!==document.body&&e!==document.documentElement?{top:function(){return Math.max(e.scrollTop||0,e.pageYOffset||0)},left:function(){return Math.max(e.scrollLeft||0,e.pageXOffset||0)},height:function(){return Math.max(e.scrollHeight||0,e.clientHeight||0,e.offsetHeight||0)},width:function(){return Math.max(e.scrollWidth||0,e.clientWidth||0,e.offsetWidth||0)}}:this.window()},scrollBarSize:function(){function e(){var e=document.createElement("DIV"),t=a(),n=null;return t.apply(e,{position:"absolute",top:"-1000px",left:"-1000px",width:"300px",height:"300px",overflow:"scroll",opacity:"0.01"}),document.body.appendChild(e),n={width:e.offsetWidth-e.clientWidth,height:e.offsetHeight-e.clientHeight},n.probablyMobile=0===n.width,n.width=0===n.width?f.classes.scroll.MINIMAL_WIDTH:n.width,n.height=0===n.height?f.classes.scroll.MINIMAL_HEIGHT:n.height,document.body.removeChild(e),n}var t=flex.overhead.globaly.get(f.storage.GROUP,f.storage.SCROLL,{});return t.value||(t.value=e()),t.value}},new e},l=function(){var e=function(){};return e.prototype={build:function(e){function t(e,t){var n=t[e.settingup.parent]||null;"object"==typeof e.settingup&&null!==t&&null!==n&&Array.prototype.forEach.call(e.settingup.childs,function(r){t[r]&&("object"==typeof e[r].settingup?n.appendChild(t[r][e[r].settingup.parent]):n.appendChild(t[r]))})}function n(e){var t=document.createElement(e.node);return null!==e.html&&(t.innerHTML=e.html),Array.prototype.forEach.call(e.attrs,function(e){flex.oop.objects.validate(e,[{name:"name",type:"string"},{name:"value",type:"string"}])===!0&&t.setAttribute(e.name,e.value)}),t}function r(e){return flex.oop.objects.validate(e,[{name:"node",type:"string"},{name:"attrs",type:"array",value:[]},{name:"html",type:"string",value:null}])}var o={};try{if(r(e)===!0)return n(e);for(var l in e)if(r(e[l])===!0)o[l]=n(e[l]);else if("object"==typeof e[l]&&"settingup"!==l&&(o[l]=this.build(e[l]),null===o[l]))return null;t(e,o)}catch(e){return null}return o}},new e},a=function(){var e=function(){};return e.prototype={apply:function(e,t){if(e&&"object"==typeof t&&e.style){for(var n in t)e.style[n]=t[n];return!0}return!1},redraw:function(e){return!(!e||void 0===e.style)&&(e.style.display="none",e.style.display="",!0)},getRuleFromSheet:function(e,t){var n=(document.styleSheets,[]);try{t=t.replace(/['"]/gi,"|"),Array.prototype.forEach.call(e.cssRules||e.rules,function(e,r){e.selectorText?e.selectorText.replace(/['"]/gi,"|")===t&&n.push({rule:e,style:e.style||null,index:r,cssText:e.cssText||""}):"string"==typeof e.cssText&&0===e.cssText.indexOf(t.toLowerCase())&&n.push({rule:e,style:e.style||null,index:r,cssText:e.cssText||""})})}catch(e){}finally{return n.length>0?n:null}},getRule:function(e){var t=(document.styleSheets,[]),n=this;try{e=e.replace(/['"]/gi,"|"),Array.prototype.forEach.call(document.styleSheets,function(r){var o=n.getRuleFromSheet(r,e);null!==o&&(t=t.concat(o))})}catch(e){}finally{return t.length>0?t:null}},setRule:function(e,t){var n=flex.overhead.globaly.get(f.storage.GROUP,f.storage.CUSTOM_STYLES);if("string"==typeof t){if(null===n&&(n=document.createElement("style"),n.type="text/css",document.head.appendChild(n),n=n.styleSheet||n.sheet,flex.overhead.globaly.set(f.storage.GROUP,f.storage.CUSTOM_STYLES,n)),n.insertRule)return n.insertRule(e+" {"+t+"}",n.cssRules.length),{rule:n.cssRules[n.cssRules.length-1],index:n.cssRules.length-1,sheet:n};if(n.addRule)return n.addRule(e+" {"+t+"}",-1),{rule:n.cssRules[n.cssRules.length-1],index:n.cssRules.length-1,sheet:n}}return null},updateRule:function(e,t,n){var r=t.selectorText;return this.deleteRule(e,t),this.setRule(r,n)},deleteRule:function(e,t,n){function r(e,t,n,r){var o=null;if(void 0!==t)if("string"==typeof t){if(o=r===!1&&null!==n?e.getRuleFromSheet(n,t):e.getRule(t),null!==o&&1===o.length)return o[0].index}else{if("number"==typeof t)return t;if("object"==typeof t&&null!==n)return e.getRuleIndex(n,t)}return-1}var e=e||flex.overhead.globaly.get(f.storage.GROUP,f.storage.CUSTOM_STYLES),n="boolean"!=typeof n||n,o=r(this,t,e,n);if(o!==-1&&null!==e){if(e.deleteRule)return e.deleteRule(o),!0;if(e.removeRule)return e.removeRule(o),!0}return null},getRuleIndex:function(e,t){var n=-1;try{Array.prototype.forEach.call(e.cssRules,function(e,r){if(e===t)throw n=r,"found"})}catch(e){if("found"===e)return n}return-1},addClass:function(e,t){void 0!==e.className&&e.className.search(t)===-1&&(e.className+=t)},removeClass:function(e,t){void 0!==e.className&&e.className.search(t)!==-1&&(e.className=e.className.replace(t,""))}},new e},s=function(){var e=function(){};return e.prototype=function(){var e=null,t=null,n=null;return s={old:function(e){for(var t=0,n=0;e;)void 0!==e.offsetTop&&void 0!==e.offsetLeft&&(t+=parseFloat(e.offsetTop),n+=parseFloat(e.offsetLeft)),e=e.offsetParent;return{top:t,left:n}},modern:function(e){var t=null,n=null,r=null,o=null,l=null,a=null,s=null;return t=e.getBoundingClientRect(),n=document.body,r=document.documentElement,o=window.pageYOffset||r.scrollTop||n.scrollTop,l=window.pageXOffset||r.scrollLeft||n.scrollLeft,a=r.clientTop||n.clientTop||0,s=r.clientLeft||n.clientLeft||0,{top:t.top+o-a,left:t.left+l-s}}},e=function(e){var t=null,n=null,r=null,o=null,l=null,a=null;try{r=e.getBoundingClientRect(),t=r.top,n=r.left}catch(r){o=s.old(e),l=window.pageYOffset||objDocumentElement.scrollTop||objBody.scrollTop,a=window.pageXOffset||objDocumentElement.scrollLeft||objBody.scrollLeft,t=o.top-l,n=o.left-a}finally{return{top:t,left:n}}},t=function(e){var t=null;try{t=s.modern(e)}catch(n){t=s.old(e)}finally{return t}},n={byPage:e,byWindow:t},{byPage:n.byPage,byWindow:n.byWindow}}(),new e},i=function(){var e=function(){};return e.prototype={em:function(e){return e=e||document.documentElement,e=e.parentNode?e:document.documentElement,parseFloat(getComputedStyle(e).fontSize)},rem:function(){this.em(document.documentElement)}},new e},c={validateNode:function(t){var n=null;return t&&("string"==typeof t&&(n=e.bySelector(),t=n.first(t)),null!==t&&void 0!==t.parentNode)?t:null},appendChilds:function(e,t){for(var n=t.length-1;n>=0;n-=1)e.appendChild(t[0])}},u={init:function(){function n(){null===d&&(d=r())}function l(){null===h&&(h=s())}function i(){null===p&&(p=a())}function c(){null===g&&(g=o())}function u(){null===E&&(E=t())}function f(){null===y&&(y=e.fromParent())}var d=null,h=null,p=null,g=null,E=null,y=null;flex.callers.define.node("html.size.get",function(){return n(),d.node(this.target)}),flex.callers.define.node("html.size.getWithMargin",function(){return n(),d.nodeWithMargin(this.target)}),flex.callers.define.node("html.size.getByClientRectSize",function(){return n(),d.nodeByClientRectSize(this.target)}),flex.callers.define.node("html.size.getByOffset",function(){return n(),d.nodeByOffset(this.target)}),flex.callers.define.node("html.position.byPage",function(){return l(),h.byPage(this.target)}),flex.callers.define.node("html.position.byWindow",function(){return l(),h.byWindow(this.target)}),flex.callers.define.node("html.styles.apply",function(e){return i(),p.apply(this.target,e)}),flex.callers.define.node("html.styles.redraw",function(){return i(),p.redraw(this.target)}),flex.callers.define.node("html.styles.addClass",function(e){return i(),p.addClass(this.target,e)}),flex.callers.define.node("html.styles.removeClass",function(e){return i(),p.removeClass(this.target,e)}),flex.callers.define.node("html.scroll.position",function(){return c(),g.get(this.target)}),flex.callers.define.node("html.find.childByAttr",function(e,t){return u(),E.childByAttr(this.target,e,t)}),flex.callers.define.node("html.find.childByType",function(e){return u(),E.childByType(this.target,e)}),flex.callers.define.node("html.find.parentByAttr",function(e){return u(),E.parentByAttr(this.target,e)}),flex.callers.define.node("html.find.node",function(e){return f(),y.first(this.target,e)}),flex.callers.define.node("html.find.nodes",function(e){return f(),y.all(this.target,e)}),flex.callers.define.nodes("html.size.get",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.node(t))}),e}),flex.callers.define.nodes("html.size.getWithMargin",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.nodeWithMargin(t))}),e}),flex.callers.define.nodes("html.size.getByClientRectSize",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.nodeByClientRectSize(t))}),e}),flex.callers.define.nodes("html.size.getByOffset",function(){var e=[];return n(),Array.prototype.forEach.call(this.target,function(t){e.push(d.nodeByOffset(t))}),e}),flex.callers.define.nodes("html.position.byPage",function(){var e=[];return l(),Array.prototype.forEach.call(this.target,function(t){e.push(h.byPage(t))}),e}),flex.callers.define.nodes("html.position.byWindow",function(){var e=[];return l(),Array.prototype.forEach.call(this.target,function(t){e.push(h.byWindow(t))}),e}),flex.callers.define.nodes("html.styles.apply",function(e){var t=[];return i(),Array.prototype.forEach.call(this.target,function(n){t.push(p.apply(n,e))}),t}),flex.callers.define.nodes("html.styles.redraw",function(){var e=[];return i(),Array.prototype.forEach.call(this.target,function(t){e.push(p.redraw(t))}),e}),flex.callers.define.nodes("html.styles.addClass",function(e){var t=[];return i(),Array.prototype.forEach.call(this.target,function(n){t.push(p.addClass(n,e))}),t}),flex.callers.define.nodes("html.styles.removeClass",function(e){var t=[];return i(),Array.prototype.forEach.call(this.target,function(n){t.push(p.removeClass(n,e))}),t}),flex.callers.define.nodes("html.scroll.position",function(){var e=[];return c(),Array.prototype.forEach.call(this.target,function(t){e.push(g.get(t))}),e}),flex.callers.define.nodes("html.find.childByAttr",function(e,t){var n=[];return u(),Array.prototype.forEach.call(this.target,function(r){n.push(E.childByAttr(r,e,t))}),n}),flex.callers.define.nodes("html.find.childByType",function(e){var t=[];return u(),Array.prototype.forEach.call(this.target,function(n){t.push(E.childByType(n,e))}),t}),flex.callers.define.nodes("html.find.parentByAttr",function(e){var t=[];return u(),Array.prototype.forEach.call(this.target,function(n){t.push(E.parentByAttr(n,e))}),t}),flex.callers.define.nodes("html.find.node",function(e){var t=[];return f(),Array.prototype.forEach.call(this.target,function(n){t.push(e.first(n,e))}),t}),flex.callers.define.nodes("html.find.nodes",function(e){var t=[];return f(),Array.prototype.forEach.call(this.target,function(n){t.push(e.all(n,e))}),t})}},u.init(),n={select:{bySelector:e.bySelector,fromParent:e.fromParent},find:t,size:r,scroll:o,builder:l,styles:a,position:s,units:i,helpers:c},{select:{bySelector:n.select.bySelector,fromParent:n.select.fromParent},find:n.find,size:n.size,scroll:n.scroll,builder:n.builder,styles:a,position:n.position,units:i,helpers:n.helpers}},flex.modules.attach({name:"html",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null;return t=function(e){function n(e){var t=void 0!==i[e]?e:null;if(null===t)for(var n in c)if(c[n].indexOf(e)!==-1){t=n;break}return t}function r(e){_object(i[e.type]).forEach(function(t,n){n.call(a,e)})}function o(e){void 0===a[e]&&Object.defineProperty(a,e,{configurable:!0,enumerable:!0,get:function(){return s[e]},set:function(t){s[e]=t,r({type:"set",index:e,item:t})}})}function l(e){void 0===a[e]&&delete a[e]}var a=this,s=[],i={set:{},add:{},remove:{}},c={set:["update"],add:["add","new","push","unshift"],remove:["remove","del","delete","shift","pop"]},u={WRONG_EVENT_NAME:"0000: WRONG_EVENT_NAME",HANDLE_ISNOT_FUNCTION:"0001: HANDLE_ISNOT_FUNCTION",SAME_ID_OF_HANDLE:"0002: SAME_ID_OF_HANDLE",HANDLE_OR_ID_SHOULD_BE:"0003: HANDLE_OR_ID_SHOULD_BE",INVALID_LENGTH:"0004: INVALID_LENGTH"};Object.defineProperty(a,"getOriginal",{configurable:!1,enumerable:!1,writable:!1,value:function(){return s}}),Object.defineProperty(a,"bind",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t,r){if(e=n(e),null===e)throw new Error(u.WRONG_EVENT_NAME);if("function"!=typeof t)throw new Error(u.HANDLE_ISNOT_FUNCTION);if(r="string"==typeof r?r:flex.unique(),void 0!==i[e][r])throw new Error(u.SAME_ID_OF_HANDLE);i[e][r]=t}}),Object.defineProperty(a,"unbind",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){if(e=n(e),null!==e){if("function"==typeof t){for(var r in i[e])if(i[e][r]===t)return delete i[e][r],!0;return!1}if("string"==typeof t)return void 0!==i[e][t]&&(delete i[e][t],!0);throw new Error(u.HANDLE_OR_ID_SHOULD_BE)}throw new Error(u.WRONG_EVENT_NAME)}}),Object.defineProperty(a,"pop",{configurable:!1,enumerable:!1,writable:!1,value:function(){if(s.length>-1){var e=s.pop();return l(s.length),r({type:"remove",index:s.length,item:e,count:1}),e}}}),Object.defineProperty(a,"push",{configurable:!1,enumerable:!1,writable:!1,value:function(){var e=Array.prototype.filter.call(arguments,function(){return!0}),t=s.length;return e.length>0&&(e.forEach(function(e){s.push(e),o(s.length-1)}),r({type:"add",index:t,item:e,count:e.length})),s.length}}),Object.defineProperty(a,"unshift",{configurable:!1,enumerable:!1,writable:!1,value:function(){var e=Array.prototype.filter.call(arguments,function(){return!0});return e.length>0&&(e.forEach(function(e,t){s.splice(t,0,e),o(t)}),r({type:"add",index:0,item:e,count:e.length})),s.length}}),Object.defineProperty(a,"shift",{configurable:!1,enumerable:!1,writable:!1,value:function(){var e=null;if(s.length>0)return e=s.shift(),l(s.length),r({type:"remove",index:0,item:e,count:1}),e}}),Object.defineProperty(a,"splice",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){var n=[],a=[];if(e=void 0!==e?e>s.length-1?s.length:e:0,e=e<0?s.length+e:e,t=void 0!==t?t:s.length-e,a=s.splice(e,t),a.length>0){r({type:"remove",index:e,item:a,count:a.length});for(var i=a.length-1;i>=0;i-=1)l(s.length+i)}return n=Array.prototype.slice.call(arguments,2,arguments.length),n.length>0&&(n.forEach(function(t,n){s.splice(e+n,0,t),o(s.length-1)}),r({type:"add",index:e,item:n,count:n.length})),a}}),Object.defineProperty(a,"fill",{configurable:!1,enumerable:!1,writable:!1,value:function(e,t,n){for(var o=Object(s),t=void 0===t?0:t,n=void 0===n?s.length:n,l=o.length>>>0,a=t>>0,i=a<0?Math.max(l+a,0):Math.min(a,l),c=void 0===n?l:n>>0,u=c<0?Math.max(l+c,0):Math.min(c,l);i<u;)o[i]=e,r({type:"set",index:i,item:e}),i++;return o}}),Object.defineProperty(a,"length",{configurable:!1,enumerable:!1,get:function(){return s.length},set:function(e){var t=Number(e);if(!(t%1===0&&t>=0))throw new RangeError(u.INVALID_LENGTH);return t<s.length?a.splice(t):t>s.length&&a.push.apply(a,new Array(t-s.length)),e}}),Object.defineProperty(a,"concat",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e=[].concat(s),n=0,r=arguments.length;n<r;n++)arguments[n]instanceof Array?e=e.concat(arguments[n]):arguments[n]instanceof t?e=e.concat(arguments[n].getOriginal()):e.push(arguments[n]);return new t(e)}}),Object.getOwnPropertyNames(Array.prototype).forEach(function(e){void 0===a[e]&&Object.defineProperty(a,e,{configurable:!1,enumerable:!1,writable:!1,value:Array.prototype[e]})}),e instanceof Array&&a.push.apply(a,e)},e={ExArray:t},{ExArray:e.ExArray}},flex.modules.attach({name:"types.array",protofunction:e})}}(),function(){"use strict";if(void 0!==flex){var e=function(){};e.prototype=function(){var e=null,t=null,n=null,r=null,o=null,l=null,a=null,s=null,i=null,c=null,u=null,f=null,d=null,h=null,p=null,g=null,E=null,y=null,O=flex.libraries.types.array.create().ExArray;return e={values:{USE_STORAGE_CSS:!0,USE_STORAGE_JS:!0,USE_STORAGE_HTML:!0,USE_LOCALSTORAGE:!0,PATTERN_NODE:"pattern",PATTERN_SRC:"data-pattern",HOOK_PREFIX:"h_",HOOKS_SET:"data-hooks",HOOKS_SRC:"data-hooks-src",ACCESSORS:!0,CACHE_PATTERNS:!1,onLayoutBuildFinish:null},validator:{USE_STORAGE_CSS:function(e){return"boolean"==typeof e},USE_STORAGE_JS:function(e){return"boolean"==typeof e},USE_STORAGE_HTML:function(e){return"boolean"==typeof e},USE_LOCALSTORAGE:function(e){return"boolean"==typeof e},PATTERN_SRC:function(e){return"string"==typeof e},PATTERN_NODE:function(e){return"string"==typeof e&&(e.length>0&&0===e.replace(/\w/gi,"").length)},PATTERN_SRC:function(e){return"string"==typeof e},HOOK_PREFIX:function(e){return"string"==typeof e},HOOKS_SET:function(e){return"string"==typeof e},HOOKS_SRC:function(e){return"string"==typeof e},ACCESSORS:function(e){return"boolean"==typeof e},CACHE_PATTERNS:function(e){return"boolean"==typeof e},onLayoutBuildFinish:function(e){return"function"==typeof e}},setup:function(t){null!==t&&"object"==typeof t&&_object(t).forEach(function(t,n){void 0!==e.values[t]&&void 0!==e.validator[t]&&(e.values[t]=e.validator[t](n)?n:e.values[t])})},get:function(){return e.values},debug:function(){e.values.USE_STORAGE_CSS=!1,e.values.USE_STORAGE_JS=!1,e.values.USE_STORAGE_HTML=!1,e.values.USE_LOCALSTORAGE=!1,e.values.CACHE_PATTERNS=!1,flex.config.set({logs:{SHOW:["CRITICAL","LOGICAL","WARNING","NOTIFICATION","LOGS","KERNEL_LOGS"]}})}},t={measuring:{MEASURE:!0},classes:{SOURCE:function(){},PATTERN:function(){},CALLER:function(){},URL:function(){}},regs:{BODY:/<\s*body[^>]*>(\n|\r|\s|.)*?<\s*\/body\s*>/gi,BODY_TAG:/<\s*body[^>]*>|<\s*\/\s*body\s*>/gi,BODY_CLEAR:/^[\n\r\s]*|[\n\r\s]*$/gi,FIRST_TAG:/^\s*<\s*\w{1,}/gi,TAG_BORDERS:/<|>/gi,CSS:/<link\s+.*?\/>|<link\s+.*?\>/gi,CSS_HREF:/href\s*\=\s*"(.*?)"|href\s*\=\s*'(.*?)'/gi,CSS_REL:/rel\s*=\s*"stylesheet"|rel\s*=\s*'stylesheet'/gi,CSS_TYPE:/type\s*=\s*"text\/css"|type\s*=\s*'text\/css'/gi,JS:/<script\s+.*?>/gi,JS_SRC:/src\s*\=\s*"(.*?)"|src\s*\=\s*'(.*?)'/gi,JS_TYPE:/type\s*=\s*"text\/javascript"|type\s*=\s*'text\/javascript'/gi,STRING:/"(.*?)"|'(.*?)'/gi,STRING_BORDERS:/"|'/gi,DOM:/\{\{\$[\w\.\,]*?\}\}/gi,DOM_OPEN_STR:"{{$",DOM_CLOSE_STR:"}}",HOOK:/\{\{[\w\d_\.]*?\}\}/gi,MODEL:/\{\{\:\:[\w\d_\.]*?\}\}/gi,MODEL_BORDERS:/\{\{\:\:|\}\}/gi,HOOK_OPEN:"\\{\\{",HOOK_CLOSE:"\\}\\}",HOOK_BORDERS:/\{\{|\}\}/gi,CONDITIONS:/<!--[\w_]*=.{1,}?-->/gi,CONDITION_CONTENT:"<!--[open]-->.*?<!--[close]-->",CONDITION_CONTENT_ANY:"<!--[open]=.{1,}?-->.*?<!--[close]-->",STRING_CON:/".*?"/gi,STRING_CON_STRICT:'".*?"',STRING_BORDER_CON:/"/gi,CON_CLOSE_STR:"<!--[name]-->",OPEN_TAG:/<[\s]*[\w]{1,}/gi,COMMENT_BORDERS:/<!--|-->/gi,FIRST_WORD:/^\w+/gi,TAGS:/<\s*\w[^>\/]*.*?>/gi,ATTRS:/([\w-]{1,}\s*=\s*".{1,}?")|([\w-]{1,}\s*=\s*'.{1,}?')/gi,DOM_BORDERS:/\{\{\$|\}\}/gi,MODEL_OPEN_STR:"{{::",MODEL_CLOSE_STR:"}}",HOOK_OPEN_STR:"{{",HOOK_CLOSE_STR:"}}",ALL:/\{\{.*?\}\}/gi,INSIDE_TAG:/>(.*?)</gi,EVENT_ATTR:/[\w]{1,}(\s{1,})?=(\s{1,})?["']\{\{\@[\w\d_\.]*?\}\}["']/gi,EVENT_BORDERS:/\{\{\@|\}\}/gi,LINES:/\n|\r|\n\r/gi,COLLECTION_HOOK_TAG:/<[^>]*?\{\{\[[\w\d_\.]*?\]\}\}/i,COLLECTION_HOOK_NAME:/{\{\[[\w\d_\.]*?\]\}\}/i,COLLECTION_BORDERS:/{\{\[|\]\}\}/gi},storage:{VIRTUAL_STORAGE_GROUP:"FLEX_UI_PATTERNS_GROUP",VIRTUAL_STORAGE_ID:"FLEX_UI_PATTERNS_STORAGE",CSS_ATTACHED_JOURNAL:"FLEX_UI_PATTERNS_CSS_JOURNAL",JS_ATTACHED_JOURNAL:"JS_ATTACHED_JOURNAL",PRELOAD_TRACKER:"FLEX_UI_PATTERNS_PRELOAD_TRACKER",CONTROLLERS_LINKS:"FLEX_PATTERNS_CONTROLLERS_LINKS",CONTROLLERS_STORAGE:"FLEX_PATTERNS_CONTROLLERS_STORAGE",CONDITIONS_STORAGE:"FLEX_PATTERNS_CONDITIONS_STORAGE",HOOKS_STORAGE:"FLEX_PATTERNS_HOOKS_STORAGE",MAPS_STORAGE:"FLEX_PATTERNS_MAPS_STORAGE",PATTERN_SOURCES:"FLEX_PATTERNS_PATTERN_SOURCES",PATTERN_SOURCES_HTML:"FLEX_PATTERNS_PATTERN_SOURCES_HTML",GLOBAL_EVENTS:"FLEX_PATTERNS_GLOBAL_EVENTS",PATTERN_CACHE:"FLEX_PATTERNS_CACHE_STORAGE"},compatibility:{PARENT_TO_CHILD:{table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td",colgroup:"col"},CHILD_TO_PARENT:{tr:"tbody",th:"tbody",td:"tr",col:"colgroup",tbody:"table",thead:"table",tfoot:"table"},BASE:"div"},css:{classes:{MODEL_NODE:"data-flex-model-node"},attrs:{MODEL:"data-flex-model-data",DOM:"data-flex-pattern-dom",CONDITION:"data-flex-pattern-condition",PARENT:"data-flex-pattern-parrent"},selectors:{HOOK_WRAPPERS:".flex_patterns_hook_wrapper"}},events:{ONREADY:"onReady",ONUPDATE:"onUpdate",ONCHANGE:"onChange",SETINSTNCE:"setInstance"},other:{SUBLEVEL_BEGIN:"_",SUBLEVEL_END:"_",BIND_PREFIX:"$$",DOM_PREFIX:"$",ACCESSOR_PREFIX:"__",HOOK_COM_BEGIN:"^^^",HOOK_COM_END:"###",PARENT_MARK_HTML:"##parent##",ANCHOR:"ANCHOR::",EVENTS_HANDLE_ID:"flex_patterns_listener_handle_id",CACHE_PATTERNS_PREFIX:"PATTERNS_CACHE:",HOOK_ACCESSOR_FUNC_NAME:"setHookValue"}},f={SIGNATURE:"[flex.ui.patterns]",source:{TEMPLATE_WAS_LOADED:"0001:TEMPLATE_WAS_LOADED",FAIL_TO_LOAD_TEMPLATE:"0002:FAIL_TO_LOAD_TEMPLATE",FAIL_TO_PARSE_TEMPLATE:"0003:FAIL_TO_PARSE_TEMPLATE",FAIL_TO_LOAD_JS_RESOURCE:"0004:FAIL_TO_LOAD_JS_RESOURCE",ONLY_ONE_MODEL_REF_CAN_BE_IN_ATTR:"0005: ONLY_ONE_MODEL_REF_CAN_BE_IN_ATTR",BAD_FORMAT_OF_STYLE_IN_ATTRIBUTE:"0006: BAD_FORMAT_OF_STYLE_IN_ATTRIBUTE",ONLY_ONE_MODEL_REF_CAN_BE_IN_STYLE_PROP:"0007: ONLY_ONE_MODEL_REF_CAN_BE_IN_STYLE_PROP",FAIL_TO_LOAD_PATTERN_IN_COMPONENT:"0008: FAIL_TO_LOAD_PATTERN_IN_COMPONENT",COLLECTION_HOOK_IS_WRONG:"0009: COLLECTION_HOOK_IS_WRONG"},pattern:{CANNOT_FIND_SOURCE_OF_TEMPLATE:"1000:CANNOT_FIND_SOURCE_OF_TEMPLATE",CANNOT_DETECT_HOOK_VALUE:"1001:CANNOT_DETECT_HOOK_VALUE",CANNOT_DETECT_HOOK_ANCHOR:"1002:CANNOT_DETECT_HOOK_ANCHOR",TEXT_HOOK_VALUE_CANBE_ONLY_TEXT:"1003:TEXT_HOOK_VALUE_CANBE_ONLY_TEXT",CANNOT_DETECT_HTML:"1004:CANNOT_DETECT_HTML",CANNOT_DETECT_BEGIN_OR_END_HOOK_ANC:"1005:CANNOT_DETECT_BEGIN_OR_END_HOOK_ANC"},caller:{CANNOT_INIT_PATTERN:"3000:CANNOT_INIT_PATTERN"},controller:{CONTROLLER_DEFINED_MORE_THAN_ONCE:"4000:CONTROLLER_DEFINED_MORE_THAN_ONCE"},layout:{PATTERN_SRC_DEFINED_TWICE_OR_MORE:"5000:PATTERN_SRC_DEFINED_TWICE_OR_MORE",PATTERN_SRC_OR_NAME_IS_TOO_SHORT:"5001:PATTERN_SRC_OR_NAME_IS_TOO_SHORT",HOOK_SRC_DEFINED_TWICE_OR_MORE:"5002:HOOK_SRC_DEFINED_TWICE_OR_MORE",HOOK_SRC_OR_NAME_IS_TOO_SHORT:"5003:HOOK_SRC_OR_NAME_IS_TOO_SHORT",HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS:"5004:HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS"},url:{URL_SHOULD_BE_DEFINED_AS_STRING:"6000:URL_SHOULD_BE_DEFINED_AS_STRING"}},n={proto:function(r){var o=this,l=null,a=null,s=null,i=null,p=null,g=null,E=null,y=null,O=null,_=null;return l=function(n,l){var a=null,i=null,c=null;return null===r.html?(c=u.get(o.url),null!==c&&e.get().USE_STORAGE_HTML===!0?s(c,n,l):(a=d.measure(),i=flex.ajax.send(o.url,flex.ajax.methods.GET,null,{success:function(e,t){d.measure(a,"loading sources for ("+o.url+")"),s(e.original,n,l)},fail:function(e,t){throw d.measure(a,"loading sources for ("+o.url+")"),flex.logs.log(O()+f.source.FAIL_TO_LOAD_TEMPLATE,flex.logs.types.CRITICAL),y(l),f.source.FAIL_TO_LOAD_TEMPLATE}}),i.send())):s(r.html.search(t.regs.BODY)?r.html="<body>"+r.html+"</body>":r.html,n,l),!0},a={URLs:function(e){var t=flex.system.url.restore(o.url);return null!==t&&(e=e.map(function(e){var n=flex.system.url.parse(e,t);return null!==n&&n.url}),e=e.filter(function(e){return e!==!1})),e},html:function(e,n,o){var l=t.regs,a=e.match(l.BODY);return null!==a&&1===a.length?(r.html=a[0].replace(l.BODY_TAG,"").replace(l.BODY_CLEAR,""),r.original=e,E.getSRCs()?E.load(n):(g.procced(),n()),!0):(r.html=null,o(),!1)},css:function(){var e=t.regs,n=null!==r.original?r.original.match(e.CSS):null,o=[];null!==n&&Array.prototype.forEach.call(n,function(t){function n(t){var n=t.search(e.CSS_REL),r=t.search(e.CSS_TYPE);return n>0&&r>0}var r=t.match(e.CSS_HREF),l=null;n(t)!==!1&&null!==r&&1===r.length&&(l=r[0].match(e.STRING),null!==l&&1===l.length&&o.push(l[0].replace(e.STRING_BORDERS,"")))}),r.css=a.URLs(o)},js:function(){var e=t.regs,n=null!==r.original?r.original.match(e.JS):null,o=[];null!==n&&Array.prototype.forEach.call(n,function(t){function n(t){var n=t.search(e.JS_TYPE);return n>0}var r=t.match(e.JS_SRC),l=null;n(t)!==!1&&null!==r&&1===r.length&&(l=r[0].match(e.STRING),null!==l&&1===l.length&&o.push(l[0].replace(e.STRING_BORDERS,"")))}),r.js=a.URLs(o)}},s=function(e,t,n){function l(e){i.css.load(function(){i.js.load(function(){e||u.add(o.url,{original:r.original,html:r.html,js:r.js,css:r.css,map:r.map,flags:r.flags}),y(t)},function(){y(n)})})}"string"==typeof e?a.html(e,function(){a.js(),a.css(),l(!1)},function(){flex.logs.log(O()+f.source.FAIL_TO_PARSE_TEMPLATE,flex.logs.types.NOTIFICATION),y(n)}):"object"==typeof e&&(r.original=e.original,r.html=e.html,r.js=e.js,r.css=e.css,r.map=e.map,r.flags=e.flags,l(!0))},i={css:{load:function(n){var l=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CSS_ATTACHED_JOURNAL,{}),a=flex.unique();null!==r.css&&r.css.length>0?(flex.overhead.register.open(a,r.css,n),Array.prototype.forEach.call(r.css,function(t){var n=null,r=null;l[t]?flex.overhead.register.done(a,t):(l[t]=!0,n=u.get(t),null===n||e.get().USE_STORAGE_CSS===!1?(r=d.measure(),flex.resources.attach.css.connect(t,function(e){var t=flex.resources.parse.css.stringify(e);null!==t&&u.add(e,t),null!==a&&flex.overhead.register.done(a,e),d.measure(r,"loading resources for ("+o.url+"):: "+e)})):(flex.resources.attach.css.adoption(n,null,t),flex.overhead.register.done(a,t),u.add(t,n)))})):y(n)}},js:{load:function(l,a){var s=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.JS_ATTACHED_JOURNAL,{}),i=flex.unique();null!==r.js&&r.js.length>0?(flex.overhead.register.open(i,r.js,l),Array.prototype.forEach.call(r.js,function(t){var r=null,l=null,h=function(){flex.overhead.register.done(i,t);var e=flex.ajax.send(t,flex.ajax.methods.GET,null,{success:function(e,n){u.add(t,e.original)}});e.send(),d.measure(l,"loading resources for ("+o.url+"):: "+t)},p=function(){throw flex.logs.log(O()+f.source.FAIL_TO_LOAD_JS_RESOURCE,flex.logs.types.CRITICAL),d.measure(l,"loading resources for ("+o.url+"):: "+t),y(a),f.source.FAIL_TO_LOAD_JS_RESOURCE};void 0===s[t]?(c.references.assign(t,o.url),s[t]=!0,r=u.get(t),null===r||e.get().USE_STORAGE_JS===!1?(l=d.measure(),n.resource.isIn(t)?n.resource.isDone(t)?flex.overhead.register.done(i,t):n.resource.add(t,function(){flex.overhead.register.done(i,t)}):(n.resource.add(t,h),flex.resources.attach.js.connect(t,function(){n.resource.done(t)},p))):(c.current.set(t),flex.resources.attach.js.adoption(r,function(){flex.overhead.register.done(i,t),c.current.reset(t)}),u.add(t,r))):n.resource.isDone(t)?flex.overhead.register.done(i,t):n.resource.add(t,function(){flex.overhead.register.done(i,t)})})):y(l)}}},y=function(e){"function"==typeof e&&e.call(r.__instance,o.url,o.original_url,r.__instance)},E={getSRCs:function(){function t(n,o){Array.prototype.forEach.call(n,function(n){var l=n.getAttribute(e.get().PATTERN_SRC),a=null;null!==l&&""!==l&&(!~r.srcs.indexOf(l)&&r.srcs.push(l),a=n.nodeName.toLowerCase(),a===e.get().PATTERN_NODE?(o.src=l,o.hooks={},void 0!==n.children&&t(n.children,o.hooks)):(o[a]={src:l,hooks:{}},void 0!==n.children&&t(n.children,o[a].hooks)))})}var n=document.createElement("DIV");return n.innerHTML=r.html,r.srcs=[],r.map.component={},t(n.children,r.map.component),0===r.srcs.length&&(r.map.component=null),0===r.srcs.length&&(r.srcs=null),null!==r.srcs},load:function(e){n.init(r.srcs,e,E.onFail)},onFail:function(){var e=function(){this.urls=r.srcs,this.code=f.source.FAIL_TO_LOAD_PATTERN_IN_COMPONENT,this.message=O()+f.source.FAIL_TO_LOAD_PATTERN_IN_COMPONENT+":: URLs = "+JSON.stringify(r.srcs)},t=new e;throw flex.logs.log(t.message,flex.logs.types.CRITICAL),t}},g={map:{getting:function(e,t,n,o){var l=r.html.match(e),a={};l instanceof Array&&l.forEach(function(e){e=e.replace(t,""),e=e.split(","),e instanceof Array&&e.forEach(function(e){a[e]=!o||(void 0===a[e]?1:a[e]+=1)})}),r.map[n]=a},model:function(){g.map.getting(t.regs.MODEL,t.regs.MODEL_BORDERS,"model",!1)},dom:function(){g.map.getting(t.regs.DOM,t.regs.DOM_BORDERS,"dom",!0)}},binding:{model:function(){function e(n){var r={};return _object(n).forEach(function(n,o){var l=t.other.BIND_PREFIX+n;"object"==typeof o?r[n]=e(o):o===!0&&(Object.defineProperty(r,n,{get:function(){return this[l].val},set:function(e){var t=this[l].val;this[l].val=e,this[l].handle(e,t)},configurable:!0,enumerable:!0}),r[l]={val:"",handles:{},bind:function(e){var t=null;return"function"==typeof e&&(t=flex.unique(),this.handles[t]=e),t},unbind:function(e){return void 0!==this.handles[e]&&(delete this.handles[e],!0)},handle:function(e,t){_object(this.handles).forEach(function(n,r){r(e,t)})}})}),r}var n=null===r.binding.model?null!==r.map.model?e(r.map.model):null:r.binding.model;
return r.binding.model=n,n}},attrs:{parse:function(e){var t=e.split("=");return{name:t[0].replace(/\s/gi,""),value:t[1].replace(/^\s*|\s*$/gi,"").replace(/(^"|"$)|(^'|'$)/gi,"")}},parseStyle:function(e){var t=e.split(";"),n=[];return t.forEach(function(t){var r=flex.unique(),t=t.replace(/::/gi,r),o=t.split(":");""!==t&&(2===o.length?n.push({name:o[0].replace(/\s/,""),value:o[1].replace(/^\s*|\s*$/,"").replace(new RegExp(r,"gi"),"::")}):flex.logs.log(O()+f.source.BAD_FORMAT_OF_STYLE_IN_ATTRIBUTE+". Style value in attr: ("+e+")",flex.logs.types.WARNING))}),n}},prepare:function(){r.html=r.html.replace(t.regs.LINES,"")},fix:function(){var e=r.html.match(t.regs.ALL);e instanceof Array&&e.forEach(function(e){r.html=r.html.replace(e,e.replace(/\s|\t|\r|\n/gi,""))})},collections:{find:function(){var e=null,l=null,a=null;do if(e=r.html.search(t.regs.COLLECTION_HOOK_TAG),e=~e?h.getFirstTagWithContect(r.html.substring(e,r.html.length)):e,"string"==typeof e)l=e.match(t.regs.COLLECTION_HOOK_NAME)[0],a=l.replace(t.regs.COLLECTION_BORDERS,""),r.html=r.html.replace(e,t.regs.HOOK_OPEN_STR+a+t.regs.HOOK_CLOSE_STR),e=e.replace(l,""),r.map.collections[a]={html:e,hook:a,parent:o.url,id:o.url+"["+a+"]"},n.storage.html.add(r.map.collections[a].id,e);else if(null===e)throw flex.logs.log(O()+f.source.COLLECTION_HOOK_IS_WRONG,flex.logs.types.CRITICAL),f.source.COLLECTION_HOOK_IS_WRONG;while(e!==-1)}},tags:{get:function(){var e=null;return void 0===o.tags&&(e=r.html.match(t.regs.TAGS),e=e instanceof Array?e:[],o.tags=[],e.forEach(function(e){o.tags.push({org:e,mod:e})})),o.tags},accept:function(){o.tags instanceof Array&&o.tags.forEach(function(e){r.html=r.html.replace(e.org,e.mod)})}},hooks:{inAttrs:function(){var e=g.tags.get(),n=t.regs;e.forEach(function(e,o){var l=null;h.testReg(n.HOOK,e.mod)&&(l=e.mod.match(n.HOOK),l instanceof Array&&l.forEach(function(o){var l=o.replace(n.HOOK_BORDERS,"");e.mod=e.mod.replace(o,n.HOOK_OPEN_STR+t.other.PARENT_MARK_HTML+l+n.HOOK_CLOSE_STR),r.map.hooks.indexOf(l)===-1&&r.map.hooks.push(l)}))})},inNodes:function(){var e=t.regs,n=r.html.match(e.INSIDE_TAG);n instanceof Array&&n.forEach(function(n){var o=r.html.match(e.HOOK),l=n;o instanceof Array&&(o.forEach(function(n){var o=n.replace(e.HOOK_BORDERS,""),a="<!--"+t.other.HOOK_COM_BEGIN+t.other.PARENT_MARK_HTML+o+"-->",s="<!--"+t.other.HOOK_COM_END+t.other.PARENT_MARK_HTML+o+"-->";l=l.replace(n,a+e.HOOK_OPEN_STR+t.other.PARENT_MARK_HTML+o+e.HOOK_CLOSE_STR+s),r.map.hooks.indexOf(o)===-1&&r.map.hooks.push(o)}),r.html=r.html.replace(n,l))})},find:function(){var e=t.regs,n=r.html.match(e.HOOK);n instanceof Array&&n.forEach(function(n){var o=n.replace(e.HOOK_BORDERS,"");r.html=r.html.replace(n,e.HOOK_OPEN_STR+t.other.PARENT_MARK_HTML+o+e.HOOK_CLOSE_STR)})}},dom:{find:function(){var e=g.tags.get(),n=t.regs;e.forEach(function(e,r){var o=e.mod.match(n.DOM),l=[];o instanceof Array&&(o.forEach(function(e){var t=e.replace(n.DOM_BORDERS,"").split(",");l=l.concat(t.filter(function(e){return""!==e}))}),function(){var e=[];l=l.filter(function(t){return e.indexOf(t)===-1&&(e.push(t),!0)})}(),l=l.map(function(e){return t.other.PARENT_MARK_HTML+e}),void 0===e.tag&&(e.tag=e.mod.match(n.OPEN_TAG)[0]),e.mod=e.mod.replace(n.DOM,""),e.mod=e.mod.replace(e.tag,e.tag+" "+t.css.attrs.DOM+'="'+l.join(",")+'" '))})}},model:{inAttrs:function(){var e=g.tags.get(),n=t.regs;e.forEach(function(e,o){var l={},a=null;h.testReg(n.MODEL,e.mod)&&(a=e.mod.match(n.ATTRS),a instanceof Array&&a.forEach(function(r){var o=null,a=null,s=null;h.testReg(n.MODEL,r)&&(o=g.attrs.parse(r),"style"===o.name?(s=g.attrs.parseStyle(o.value),s.forEach(function(r){a=r.value.match(n.MODEL),a instanceof Array&&(a.length>1&&flex.logs.log(O()+f.source.ONLY_ONE_MODEL_REF_CAN_BE_IN_STYLE_PROP+". HTML fragment: ("+e.mod+"), Style prop: ("+r.value+")",flex.logs.types.WARNING),a=a[0],l["style."+r.name]=t.other.PARENT_MARK_HTML+a.replace(n.MODEL_BORDERS,""))})):(a=o.value.match(n.MODEL),a instanceof Array&&(a.length>1&&flex.logs.log(O()+f.source.ONLY_ONE_MODEL_REF_CAN_BE_IN_ATTR+". HTML fragment: ("+e.mod+"), Attr: ("+o.name+")",flex.logs.types.WARNING),a=a[0],l[o.name]=t.other.PARENT_MARK_HTML+a.replace(n.MODEL_BORDERS,""))),e.mod=e.mod.replace(r,""))}),Object.keys(l).length>0&&(void 0===e.tag&&(e.tag=e.mod.match(n.OPEN_TAG)[0]),e.mod=e.mod.replace(e.tag,e.tag+" "+t.css.attrs.MODEL+"='"+JSON.stringify(l)+"' "),r.flags.has_model=!0))})},inNodes:function(){var e=t.regs,n=r.html.match(e.INSIDE_TAG);n instanceof Array&&n.forEach(function(n){var o=null,l=n;h.testReg(e.MODEL,n)&&(o=l.match(e.MODEL),o.forEach(function(n){var r=n.replace(e.MODEL_BORDERS,"");r=e.MODEL_OPEN_STR+t.other.PARENT_MARK_HTML+r+e.MODEL_CLOSE_STR,l=l.replace(n,'<span class="'+t.css.classes.MODEL_NODE+'" style="display:none;">'+r+"</span>")}),r.html=r.html.replace(n,l),o.length>0&&(r.flags.has_model=!0))})}},conditions:{find:function(){var e=r.html.match(t.regs.CONDITIONS),n=[],o=r.html,l=null,a=null;e instanceof Array&&(r.map.conditions={},e=e.map(function(e){var o=e.replace(t.regs.COMMENT_BORDERS,""),l=o.split("=")[0];return n.indexOf(l)===-1&&n.push(l),r.map.conditions[o]=void 0===r.map.conditions[o]?1:r.map.conditions[o]+1,{value:o,name:l,content:"",corrected:""}}),e.forEach(function(e){var n=o.match(new RegExp(t.regs.CONDITION_CONTENT.replace("[open]",e.value).replace("[close]",e.name),"gi"));n instanceof Array&&(e.content=n,e.corrected=n,n.forEach(function(n,r){var l=n.match(t.regs.OPEN_TAG);l instanceof Array&&(l=function(e){var t={};return e.filter(function(e){return void 0===t[e]&&(t[e]=!0,!0)})}(l),l.forEach(function(n){e.corrected[r]=e.corrected[r].replace(new RegExp(n,"gi"),n+" "+t.css.attrs.CONDITION+'="'+t.other.PARENT_MARK_HTML+e.value+'"')}),o=o.replace(n,e.corrected[r]))}))}),l=o.match(new RegExp("("+t.css.attrs.CONDITION+"="+t.regs.STRING_CON_STRICT+"\\s?){1,}","gi")),l instanceof Array&&(a=new RegExp(t.css.attrs.CONDITION+"="+t.regs.STRING_CON_STRICT,"gi"),l.forEach(function(e){var n=e.match(a),r=n.join(" "),l=r.match(t.regs.STRING_CON),s="";l instanceof Array&&l.length>1&&(l.reverse().forEach(function(e,n){s+=e.replace(t.regs.STRING_BORDER_CON,"")+(n<l.length-1?",":"")}),o=o.replace(r,t.css.attrs.CONDITION+'="'+s+'"'))})),e.forEach(function(e){var n=new RegExp("<\\!--"+e.name,"gi");o=o.replace(n,"<!--"+t.other.PARENT_MARK_HTML+e.name)}),e.length>0&&(r.flags.has_conditions=!0),r.html=o)}},events:{find:function(){var e=g.tags.get(),n=t.regs,l=[],a=h.getHash(o.url).replace("-","0"),s=0;e.forEach(function(e,t){var o=e.mod.match(n.EVENT_ATTR),i=[];o instanceof Array&&(o.forEach(function(e){var t=e.replace(n.EVENT_BORDERS,"").replace(/["']/gi,"").split("=");2===t.length&&i.push({event:t[0].replace(/^on/i,""),handle:t[1],id:a+s++,attr:e})}),function(){var e=[];i=i.filter(function(t){return e.indexOf(t.event)===-1&&(e.push(t.event),!0)})}(),i.forEach(function(t){e.mod=e.mod.replace(t.attr,n.DOM_OPEN_STR+t.id+n.DOM_CLOSE_STR)}),r.html=r.html.replace(e.org,e.mod),e.org=e.mod,l=l.concat(i))}),r.map.events=l}},procced:function(){g.prepare(),g.fix(),g.collections.find(),g.hooks.inAttrs(),g.hooks.inNodes(),g.events.find(),g.map.model(),g.map.dom(),g.conditions.find(),g.model.inNodes(),g.model.inAttrs(),g.dom.find(),g.tags.accept()}},p={get:function(e){var n=r.html,e="string"==typeof e&&e,o="__no_parent__";return e!==!1?void 0===r.cache.html[e]?(n=n.replace(new RegExp(t.other.PARENT_MARK_HTML,"gi"),e+"."),r.cache.html[e]=n):n=r.cache.html[e]:void 0===r.cache.html[o]?(n=n.replace(new RegExp(t.other.PARENT_MARK_HTML,"gi"),""),r.cache.html[o]=n):n=r.cache.html[o],n}},O=function(){return f.SIGNATURE+":: pattern ("+o.url+")"},_={load:l,html:p.get,map:function(){return r.map},flags:function(){return r.flags},collections:function(){return r.map.collections}},{load:_.load,html:_.html,map:_.map,binding:{model:g.binding.model},flags:_.flags,collections:_.collections}},instance:function(e){return flex.oop.objects.validate(e,[{name:"url",type:"string"},{name:"html",type:"string",value:null},{name:"css",type:"array",value:null},{name:"js",type:"array",value:null}])!==!1?(null===e.html&&(e.html=n.storage.html.get(e.url)),_object({parent:t.classes.SOURCE,constr:function(){this.url=flex.system.url.restore(e.url),this.original_url=e.url},privates:{original:null,html:e.html,css:e.css,js:e.js,map:{model:null,dom:null,hooks:[],conditions:null,events:null,component:null,collections:{}},binding:{model:null},cache:{html:{},regs:{}},flags:{has_model:!1,has_conditions:!1}},prototype:n.proto}).createInstanceClass()):null},storage:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_SOURCES,{});void 0===r[e]&&(r[e]=n)},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_SOURCES,{});return void 0!==n[e]?n[e]:null},html:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_SOURCES_HTML,{});void 0===r[e]&&(r[e]=n)},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_SOURCES_HTML,{});return void 0!==n[e]?n[e]:null}}},resource:{add:function(e,t){void 0===n.resource.data&&(n.resource.data={}),void 0===n.resource.data[e]&&(n.resource.data[e]={handles:[],status:!1}),n.resource.data[e].handles.push(t)},done:function(e){void 0===n.resource.data&&(n.resource.data={}),void 0!==n.resource.data[e]&&(n.resource.data[e].status=!0),_object(n.resource.data).forEach(function(e,t){t.status&&(t.handles.forEach(function(e){e()}),t.handles=[])})},isDone:function(e){return void 0===n.resource.data&&(n.resource.data={}),void 0!==n.resource.data[e]&&n.resource.data[e].status},isIn:function(e){return void 0===n.resource.data&&(n.resource.data={}),void 0!==n.resource.data[e]}},init:function(e,r,o){var l=e instanceof Array?e:[e],a=(flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PRELOAD_TRACKER,{}),flex.unique()),s=[],i=!1;flex.overhead.register.open(a,l,function(){"function"!=typeof r||i?flex.system.handle(o):r(s)}),l.forEach(function(e){var t=n.storage.get(e);null!==t?(s.push(t),flex.overhead.register.done(a,e)):(t=n.instance({url:e}),t.load(function(e,t,r){s.push(r),n.storage.add(t,r),flex.overhead.register.done(a,t)},function(e,t,n){i=!0,flex.overhead.register.done(a,t)}))})}},r={proto:function(o){var s=this,i=null,u=null,d=null,g=null,E=null,_=null,v=null,m=null,R=null,A=null,N=null,T=null,b={maps:{MODEL:"model",DOM:"dom"}};return g={get:function(e){function r(o,a){function s(e,n){_object(e).forEach(function(e,o){o instanceof t.classes.CALLER?n[t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END]=r(o.url,o.hooks):"object"==typeof o&&null!==o&&(n[e]={},s(o,n[e]))})}var i=void 0===l[o]?n.storage.get(o).map()[e]:l[o],c=[];return l[o]=i,null!==a?a.forEach(function(e){var t=_object(i).copy();s(e,t),c.push(t)}):c.push(_object(i).copy()),c}var l={};return r(s.url,o.hooks)},refs:function(){function e(e,t,r,o){var l=t.split(".");l.forEach(function(a,s){var i=null;s<l.length-1?(void 0===e[a]&&(e[a]={url:"",hooks:{}}),e=e[a].hooks):(i=n.storage.get(r),e[a]={url:r,hooks:{},events:null!==i?i.map().events:null,controller:v.convert(o.controller,r),path:t})})}function r(n,o){h.isArray(n)?n.forEach(function(e){r(e,o)}):n instanceof t.classes.CALLER?(void 0===a[o]&&(a[o]=!0,e(l,o,n.url,n)),r(n.hooks,o)):"object"==typeof n&&_object(n).forEach(function(e,t){r(t,(""!==o?o+".":"")+e)})}var l=o.caller.map,a={};0===Object.keys(l).length&&(l=y.storage.get(s.url),null===l&&(l={})),0===Object.keys(l).length&&r(o.hooks,""),o.map.refs={url:s.url,hooks:l,events:s.source.map().events,controller:o.controller,path:""}}},u={nodes:function(){var e=_nodes("."+t.css.classes.MODEL_NODE,!1,o.wrapper).target,n={},r={};return null!==e&&e.length>0&&Array.prototype.forEach.call(e,function(e){var o=e.innerHTML,l=void 0!==r[o]?r[o]:o.replace(t.regs.MODEL_BORDERS,""),a=document.createTextNode("");r[o]=l,n[l]=void 0===n[l]?[]:n[l],e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e),n[l].push(a)}),n},attrs:function(){var e=_nodes("*["+t.css.attrs.MODEL+"]",!1,o.wrapper).target,n={},r={};return null!==e&&e.length>0&&Array.prototype.forEach.call(e,function(e){var o=e.getAttribute(t.css.attrs.MODEL),l=void 0!==r[o]?r[o]:JSON.parse(o);r[o]=l,_object(l).forEach(function(t,r){n[r]=void 0===n[r]?[]:n[r],n[r].push({node:e,attr:t})}),e.removeAttribute(t.css.attrs.MODEL)}),n},bind:function(){function e(e){var t=o.map.refs,n=e.split("."),r=!0;return n.forEach(function(e){null!==t&&void 0!==t.hooks[e]?t=t.hooks[e]:r=!1}),r}function r(s,c,u){function f(n,o,l){_object(n).forEach(function(n,a){var s=n;a instanceof t.classes.CALLER?(s=t.other.SUBLEVEL_BEGIN+s+t.other.SUBLEVEL_END,o[s]=r(a.url,a.hooks,l+(""===l?"":".")+s)):"object"==typeof a&&null!==a?(o[s]={},f(a,o[s],l+(""===l?"":".")+s)):null!==a&&void 0!==a||e((""!==l?l+".":"")+n)&&(s=t.other.SUBLEVEL_BEGIN+s+t.other.SUBLEVEL_END,o[s]=new O)})}var d=void 0===l[s]?n.storage.get(s).binding.model():l[s],p=new O,g=1===o.wrapper.children.length?o.wrapper.children[0]:null;return l[s]=d,null!==c?c.forEach(function(e){var n=Object.create(d);flex.oop.objects.copy(d,n),_object(n).forEach(function(r,o){var l=u+(""===u?"":".")+r,s=null,c=null;void 0!==a[l]&&a[l].length>0&&(!function(e){n[t.other.BIND_PREFIX+r].bind(function(t,n){e.nodeValue=t})}(a[l][0]),a[l].splice(0,1)),void 0!==i[l]&&i[l].length>0&&(s=i[l][0].attr,function(e){h.binds.isPossible(e,s)&&h.binds.assing(e,s,function(e,t,o){var l=t();n[r]!==l&&(n[r]=l)}),n[t.other.BIND_PREFIX+r].bind(function(t,n){var r=s.split("."),o=e;1===r.length?e.getAttribute(s)!==t&&e.setAttribute(s,t):1===r.length&&void 0!==e[s]?e[s]!==t&&(e[s]=t):r.forEach(function(e,n){n!==r.length-1?o=null!==o&&void 0!==o[e]?o[e]:null:null!==o&&void 0!==o[e]&&o[e]!==t&&(o[e]=t)})}),null!==g&&(s.indexOf(".")===-1&&void 0===e[s]?_node(e).bindingAttrs().bind(s,function(e,t,o,l,a){n[r]!==t&&(n[r]=t)},g):_node(e).bindingProps().bind(s,function(e,t,o,l,a){n[r]!==t&&(n[r]=t)},g))}(i[l][0].node),i[l].splice(0,1)),void 0===e[r]||e[r]instanceof t.classes.CALLER||"object"==typeof e[r]||("function"==typeof e[r]?c=e[r]():"string"==typeof e[r]?c=e[r]:"function"==typeof e[r].toString&&(c=e[r].toString()),n[r]=c)}),f(e,n,u),p.push(n)}):p.push(_object(d).copy()),p}var l={},a=u.nodes(),i=u.attrs();o.map.model=r(s.url,o.hooks,"")},combine:function(){function e(n,l,s){function i(n,l,s){_object(n).forEach(function(n,c){c instanceof a.nodeList.NODE_LIST?(l[t.other.DOM_PREFIX+n]=c,void 0===o.cache.dom[n]&&(o.cache.dom[n]=[]),o.cache.dom[n].push({nodeList:c,path:s})):h.isArray(c)?(l[n]=void 0!==l[n]?l[n]:[],e(c,l[n],(""!==s?s+".":"")+n.replace(r,""))):"object"==typeof c&&(l[n]=void 0!==l[n]?l[n]:{},i(c,l[n],(""!==s?s+".":"")+n.replace(r,"")))})}n.forEach(function(e,t){void 0===l[t]&&l.push({}),i(n[t],l[t],s)})}var n=d.bind(),r=new RegExp("^"+t.other.SUBLEVEL_BEGIN+"|"+t.other.SUBLEVEL_END+"$","gi");h.isArray(n)&&(o.map.model=h.isArray(o.map.model)?o.map.model:new O,e(n,o.map.model,""))},accessors:function(){function e(n,o,l){function a(n,o,l){h.isArray(o)&&1===o.length&&(o=o[0]),_object(n).forEach(function(n,s){void 0!==s[t.other.HOOK_ACCESSOR_FUNC_NAME]&&(o[t.other.ACCESSOR_PREFIX+n.replace(r,"")]=s[t.other.HOOK_ACCESSOR_FUNC_NAME].bind({model:o,hook:n})),"object"==typeof s&&null!==s?(Object.keys(s).length>0&&void 0===s[t.other.HOOK_ACCESSOR_FUNC_NAME]||Object.keys(s).length>1&&void 0!==s[t.other.HOOK_ACCESSOR_FUNC_NAME])&&(o[n]=void 0!==o[n]?o[n]:{},a(s,o[n],(""!==l?l+".":"")+n.replace(r,""))):h.isArray(s)&&(o[n]=void 0!==o[n]?o[n]:[],e(s,o[n],(""!==l?l+".":"")+n.replace(r,"")))})}n.forEach(function(e,t){void 0===o[t]&&o.push({}),a(e,o[t],l)})}var n=h.isArray(o.map.accessors)?o.map.accessors:[o.map.accessors],r=new RegExp("^"+t.other.SUBLEVEL_BEGIN+"|"+t.other.SUBLEVEL_END+"$","gi");o.map.model=h.isArray(o.map.model)?o.map.model:new O,e(n,o.map.model,"",{model:null,prop:null}),o.map.accessors=null},finalize:function(){function e(e){var t=e.split("."),n=o.map.refs;return null!==n&&t.forEach(function(e){void 0!==n.hooks&&void 0!==n.hooks[e]&&(n=n.hooks[e])}),n}function n(e){var t=e.split("."),n=o.map.refs,r=null;return null!==n&&t.forEach(function(e){void 0!==n.hooks&&void 0!==n.hooks[e]&&r!==!1?(n=n.hooks[e],r=n.url):r=!1}),null!==r&&r}function r(n,r,o){function l(e){var n=e.split("."),r="";return n.forEach(function(e){r+=(""!==r?".":"")+t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END}),r}var s=void 0===a[r]?l(r):a[r],i=E.anchors.get(s),c=null;a[r]=s,null!==i?(c=u.collection(o,i,n,e(r),d.indexes),n.bind("add",c.add),n.bind("remove",c.remove)):flex.logs.log(A()+f.pattern.CANNOT_DETECT_HOOK_ANCHOR,flex.logs.types.WARNING)}function l(e,o,a){function s(e,o,a){_object(e).forEach(function(e,i){var c=null,u=null;i instanceof t.classes.CALLER?(c=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END,void 0===o[c]&&(o[c]=new O),r(o[c],(""!==a?a+".":"")+e,i.url),l(i.hooks,o[c],(""!==a?a+".":"")+e)):"object"==typeof i?(void 0===o[e]&&(o[e]={}),s(i,o[e],(""!==a?a+".":"")+e)):null===i?(u=n((""!==a?a+".":"")+e),u!==!1?(c=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END,void 0===o[c]&&(o[c]=new O),r(o[c],(""!==a?a+".":"")+e,u)):void 0===o[e]&&(o[e]=i)):void 0===o[e]&&(o[e]=i)})}e.forEach(function(e,t){void 0===o[t]&&o.push({}),s(e,o[t],a)})}var a={};return h.isArray(o.hooks)&&(o.map.model=h.isArray(o.map.model)?o.map.model:new O,l(o.hooks,o.map.model,"")),o.map.model},collection:function(e,t,n,r,o){var s=function(e,t){var s=this,i=null,c=null,u=null,f=null,d=null,p=null,g=o,E=null;return this.url=e,this.anchor=t,this.parent=n,this.refs=r,this.start=null,c=function(){var e=s.anchor.parentNode,t=null;if(null===s.start){try{Array.prototype.forEach.call(e.childNodes,function(e){if(e===s.anchor)throw"found";e instanceof Element&&(t=e)})}catch(e){}null!==t?s.start=Array.prototype.indexOf.call(e.children,t)+1:s.start=0}return s.start},u=function(e,t,n){var r=s.anchor.parentNode,o=null,l=c(),a=l+(s.parent.length-2);if(s.parent.length-1===t+(n-1))if(r.children.length-1>a){o=r.children[a+1];for(var i=e.length-1;i>=0;i-=1)r.insertBefore(e[0],o)}else for(var i=e.length-1;i>=0;i-=1)r.appendChild(e[0]);else if(void 0!==r.children[l+t]){o=r.children[l+t];for(var i=e.length-1;i>=0;i-=1)r.insertBefore(e[0],o)}},f=function(e,t){var n=null!==s.anchor.parentNode?s.anchor.parentNode.children:null,r=null,o=c();if(null!==n.length&&void 0!==n[o+e])for(var l=t-1;l>=0;l-=1)r=n[o+e+l],r.parentNode.removeChild(r)},p=function e(t,n){var n=null===n?null:void 0!==n.hooks?n.hooks:null;return null!==n&&t.forEach(function(r,o){_object(r).forEach(function(r,a){void 0!==n[r]&&(t[o][r]=l.instance({url:n[r].url,hooks:e(h.isArray(a)?a:[a],n[r])}))})}),t},i=function(e){var t=h.isArray(e.item)?e.item:[e.item],n=l.instance({url:s.url,hooks:p(t,s.refs)});n=n.build(),t.forEach(function(t,r){s.parent[e.index+r]=1===n.model[r].length?n.model[r][0]:n.model[r]}),u(n.nodes,e.index,e.count),E.add(n.model),g()},d=function(e){f(e.index,e.count),E.remove(h.isArray(e.item)?e.item:[e.item]),g()},E={add:function(e){e.forEach(function(e){"object"==typeof e&&_object(e).forEach(function(e,t){t instanceof a.nodeList.NODE_LIST&&(void 0===s.parent[e]&&(s.parent[e]=a.nodeList.create()),s.parent[e].add(t))})})},remove:function(e){e.forEach(function(e){"object"==typeof e&&_object(e).forEach(function(e,t){t instanceof a.nodeList.NODE_LIST&&void 0!==s.parent[e]&&(void 0===s.parent[e]&&(s.parent[e]=a.nodeList.create()),s.parent[e].exclude(t))})})}},{add:i,remove:d}};return new s(e,t)}},d={nodes:function(){var e=_nodes("*["+t.css.attrs.DOM+"]",!1,o.wrapper).target,n={},r={};return null!==e&&e.length>0&&Array.prototype.forEach.call(e,function(e){var o=e.getAttribute(t.css.attrs.DOM),l=void 0!==r[o]?r[o]:o.split(",");r[o]=l,l.forEach(function(t){n[t]=void 0===n[t]?[]:n[t],n[t].push(e)}),e.removeAttribute(t.css.attrs.DOM)}),n},bind:function(){function e(n,r){var o=null;return n instanceof Array?(o=[],n.forEach(function(t){o.push(e(t,r))})):"object"==typeof n?(o={},_object(n).forEach(function(t,n){o[t]=e(n,r+(""===r?"":".")+t)})):"number"==typeof n&&void 0!==t[r]&&t[r].length>=n&&(o=a.nodeList.create(t[r].slice(0,n)),t[r].splice(0,n)),o}var t=d.nodes(),n=g.get(b.maps.DOM);return e(n,"")},indexes:function(){function e(t,n,r){h.isArray(t)?t.forEach(function(t,o){e(t,n.concat([o]),r)}):"object"==typeof t&&_object(t).forEach(function(t,o){o instanceof a.nodeList.NODE_LIST?(o.setIndexes(n),null!==r&&(void 0===r[t]&&(r[t]=a.nodeList.create()),r[t].add(o))):h.isArray(o)&&e(o,n,o)})}h.isArray(o.map.model)&&e(o.map.model,[],null)}},i={cache:{load:function(e,n){var l=o.cache.html,n="object"==typeof n&&n,a={};if(h.isArray(o.hooks))return o.hooks.forEach(function(n){_object(n).forEach(function(n,r){var o=null,l=null,s=null;r instanceof t.classes.CALLER&&(o=t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END,l=(e===!1?"":e+".")+o,s=l+r.url,a[s]=void 0!==a[s]?a[s]:{url:r.url,hooks:[],path:l},h.isArray(r.hooks)?a[s].hooks=a[s].hooks.concat(r.hooks.getOriginal()):a[s].hooks.push(r.hooks))})}),_object(a).forEach(function(e,t){var o=r.instance({id:flex.unique(),url:t.url,hooks:t.hooks});o=o.html(t.path,n),l[e]={hooks:t.hooks,html:o.html,fragments:o.fragments,parent:t.path,cursor:0}}),l}},getHTML:function(e,n,r,l){var a=!1,s=null,i=null,c=(e===!1?"":e+".")+t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END;return r instanceof t.classes.CALLER&&(i=c+r.url,void 0!==o.cache.html[i]&&(s=o.cache.html[i],a={html:"<!--"+t.other.ANCHOR+c+"-->"+s.fragments.slice(s.cursor,s.cursor+r.hooks.length).join(""),fragments:null,original:s.original},s.cursor+=r.hooks.length)),a},build:function(e,n){var e="string"==typeof e&&e,n="object"==typeof n&&n,r="",l=null,a=t.regs,c=m.reset().regs,u=[],f=T.getCache(),d=null;return null===f?(l=s.source.html(e),d=s.source.map().hooks,h.isArray(o.hooks)&&(i.cache.load(e,n),o.hooks.forEach(function(t,o){var s=l;d instanceof Array&&Object.keys(t).length!==d.length&&d.forEach(function(e){void 0===t[e]&&(t[e]="")}),_object(t).forEach(function(t,n){var r=(e?e+".":"")+t,l=i.getHTML(e,t,n,o);c[r]=void 0===c[r]?new RegExp(a.HOOK_OPEN+r.replace(/\./gi,"\\.")+a.HOOK_CLOSE,"gi"):c[r],s=l!==!1?s.replace(c[r],l.html):s,s=l!==!1?s:E.insert(r,n,s)}),s=_.html(s,_.getByPath(e?e:"",n),t,e),r+=s,u.push(s)})),o.html=""!==r?r:l,T.setCache({html:o.html,fragments:0===u.length?[l]:u}),0===u.length?[l]:u):(o.html=f.html,f.fragments)},wrap:function(){o.wrapper=h.getPattern(o.html),o.wrapper.innerHTML=o.html},map:function(){function e(r,o,l,a){var s="",i=null;r instanceof t.classes.CALLER?(s=t.other.SUBLEVEL_BEGIN+l+t.other.SUBLEVEL_END,void 0===a[s]&&(i=n.storage.get(r.url),o=(""===o?"":o+".")+s,a.inc=void 0===a.inc?[]:a.inc,a[s]={url:r.url,html:i.html(o)},a.inc.push(s),e(r.hooks,o,l,a[s]))):h.isArray(r)?r.forEach(function(t){e(t,o,l,a)}):"object"==typeof r&&_object(r).forEach(function(t,n){e(n,o,t,a)})}o.map.html={url:s.url,html:s.source.html("")},e(o.hooks,"","",o.map.html)}},E={cache:{},getValue:function(e,n){var r="";return n instanceof t.classes.CALLER?r=E.convert(n.hooks):"function"==typeof n?r=E.getValue(e,n()):"string"==typeof n?r=n:"object"==typeof n?(r={},_object(n).forEach(function(e,t){r[e]=E.getValue(e,t)})):"function"==typeof n.toString?r=n.toString():(flex.logs.log(A()+f.pattern.CANNOT_DETECT_HOOK_VALUE+". Hook name: ("+e+")",flex.logs.types.WARNING),r=""),r},convert:function(e){var t=[];return h.isArray(e)&&e.forEach(function(e){var n={};_object(e).forEach(function(e,t){n[e]=E.getValue(e,t)}),t.push(n)}),t},insert:function(e,n,r){function l(e,n,r){var r=void 0!==r?r:{};return _object(n).forEach(function(n,o){o instanceof t.classes.CALLER||"object"!=typeof o?r[e+"."+n]=o:l(e+"."+n,o,r)}),r}var a=o.cache.regs;return"object"==typeof n?(_object(l(e,n)).forEach(function(e,t){r=E.insert(e,t,r)}),r):(a[e]=void 0===a[e]?new RegExp(t.regs.HOOK_OPEN+e+t.regs.HOOK_CLOSE,"gi"):a[e],r.replace(a[e],E.getValue(e,n)))},anchors:{html:function(){function e(e){var n=e.split("."),r="";return n.forEach(function(e,o){r+=o===n.length-1?(""!==r?".":"")+t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END:(""!==r?".":"")+e}),r}var n=o.html.match(t.regs.HOOK),r=t.regs,l={},a={};n instanceof Array&&n.forEach(function(n){var s=n.replace(t.regs.HOOK_BORDERS,""),i=void 0!==l[s]?l[s]:new RegExp(r.HOOK_OPEN+s.replace(/\./gi,"\\.")+r.HOOK_CLOSE,"gi");l[s]=i,s=void 0===a[s]?e(s):a[s],a[s]=s,o.html=o.html.replace(i,"<!--"+t.other.ANCHOR+s+"-->")})},convert:function(){function n(e,r,l){function a(e){var t=document.createTextNode("");return e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),t}function s(e,n,r){return function(l,a){function s(e,t){var n=1e4,o=[],l=e;do l!==e&&l!==t&&o.push(l),l=l.nextSibling,n-=1;while(n>=0&&null!==l&&l!==t);return n<0&&flex.logs.log(A()+f.pattern.CANNOT_DETECT_BEGIN_OR_END_HOOK_ANC+". Hook name: ("+r+")",flex.logs.types.WARNING),o}function i(e){var t=e;return"function"==typeof e?t=i(e()):"string"==typeof e?t=e:"object"!=typeof e&&"function"==typeof e.toString&&(t=e.toString()),null===t?"":t}function c(e,n,r,l){var a=void 0!==e[n]?e[n]:e[t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END];void 0!==e[t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END]&&delete e[t.other.SUBLEVEL_BEGIN+n+t.other.SUBLEVEL_END],void 0!==e[n]&&delete e[n],e[(l?t.other.SUBLEVEL_BEGIN:"")+n+(l?t.other.SUBLEVEL_END:"")]=r,null!==o.controller&&"object"==typeof o.controller&&"function"==typeof o.controller[t.events.ONCHANGE]&&o.controller[t.events.ONCHANGE]((l?t.other.SUBLEVEL_BEGIN:"")+n+(l?t.other.SUBLEVEL_END:""),r,a)}var u=s(e,n),d=i(l),p=null,g=null,a="boolean"!=typeof a||a,E=this;u instanceof Array&&u.length>0&&(u.forEach(function(e){e.parentNode.removeChild(e)}),"string"!=typeof d||a?"string"==typeof d&&a?(n.parentNode.insertBefore(document.createTextNode(d),n),c(E.model,E.hook,d,!1)):d instanceof t.classes.CALLER?d.render({replace:!1,before:n,callback:function(e){return c(E.model,E.hook,e.model,!0),e}}):(flex.logs.log(A()+f.pattern.TEXT_HOOK_VALUE_CANBE_ONLY_TEXT+". Hook name: ("+r+")",flex.logs.types.WARNING),n.parentNode.insertBefore(document.createTextNode(Object.prototype.toString.call(d)),n),c(E.model,E.hook,Object.prototype.toString.call(d),!1)):(g=h.getFirstTag(d),null!==g?(p=h.getParentFor(g),null!==p?(p.innerHTML=d,Array.prototype.forEach.call(p.childNodes,function(e){n.parentNode.insertBefore(e,n)})):flex.logs.log(A()+f.pattern.CANNOT_DETECT_HTML+". Hook name: ("+r+")",flex.logs.types.WARNING)):n.parentNode.insertBefore(document.createTextNode(d),n),c(E.model,E.hook,d,!1)))}}h.isArray(e)?(void 0!==e[t.other.HOOK_COM_BEGIN]&&void 0!==e[t.other.HOOK_COM_END]&&(e[t.other.HOOK_ACCESSOR_FUNC_NAME]=s(a(e[t.other.HOOK_COM_BEGIN]),a(e[t.other.HOOK_COM_END]),l),delete e[t.other.HOOK_COM_BEGIN],delete e[t.other.HOOK_COM_END]),e.forEach(function(e){n(e,r,l)})):"object"==typeof e&&null!==e&&(void 0!==e[t.other.HOOK_COM_BEGIN]&&void 0!==e[t.other.HOOK_COM_END]?(e[t.other.HOOK_ACCESSOR_FUNC_NAME]=s(a(e[t.other.HOOK_COM_BEGIN]),a(e[t.other.HOOK_COM_END]),l),delete e[t.other.HOOK_COM_BEGIN],delete e[t.other.HOOK_COM_END],_object(e).forEach(function(e,r){e!==t.other.HOOK_COM_BEGIN&&e!==t.other.HOOK_COM_END&&n(r,e,l+(""===l?"":".")+e)})):_object(e).forEach(function(e,t){n(t,e,l+(""===l?"":".")+e)}))}for(var r={__root:0},l=[{}],a={},s=[],i=document.createTreeWalker(o.wrapper,NodeFilter.SHOW_COMMENT,{acceptNode:function(n){function o(e){var n=e.split("."),o=l[r.__root],a="",s=null,i=null;return n.forEach(function(e,c){i=o,a+=(""===a?"":".")+e,null===s&&void 0!==o[e]&&c===n.length-1&&(l.push({}),r.__root+=1,o=l[r.__root]),void 0===o[e]?(o[e]={},o=o[e]):o[e]instanceof Array?c===n.length-1?(o[e].push({}),r[a]+=1,o=o[e][r[a]]):o=o[e][r[a]]:c===n.length-1?s.trg[s.step]instanceof Array?(s.trg[s.step].push({}),r[s.cur]+=1,o=s.trg[s.step][r[s.cur]],o[e]={},o=o[e]):(s.trg[s.step]=[s.trg[s.step],{}],void 0!==s.trg[s.step][0][t.other.HOOK_COM_BEGIN]&&(s.trg[s.step][t.other.HOOK_COM_BEGIN]=s.trg[s.step][0][t.other.HOOK_COM_BEGIN],s.trg[s.step][0][u]=s.trg[s.step],delete s.trg[s.step][0][t.other.HOOK_COM_BEGIN]),o=s.trg[s.step][1],o[e]={},o=o[e],r[s.cur]=1):o=o[e],s={cur:a,trg:i,step:e}}),o}var i=null,c=null,u="__REF_TO_PARENT_ARR",f=null;return e.get().ACCESSORS?(~n.nodeValue.indexOf(t.other.HOOK_COM_BEGIN)&&(c=n.nodeValue.replace(t.other.HOOK_COM_BEGIN,""),i=o(c),i[t.other.HOOK_COM_BEGIN]=n,a[c]=i),~n.nodeValue.indexOf(t.other.HOOK_COM_END)&&(c=n.nodeValue.replace(t.other.HOOK_COM_END,""),void 0!==a[c][u]&&(f=a[c][u],delete a[c][u],a[c]=f),a[c][t.other.HOOK_COM_END]=n)):(~n.nodeValue.indexOf(t.other.HOOK_COM_BEGIN)||~n.nodeValue.indexOf(t.other.HOOK_COM_END))&&s.push(n),~n.nodeValue.indexOf(t.other.ANCHOR)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1),c=[],u={};i.nextNode();)c.push(i.currentNode);s.forEach(function(e){e.parentNode.removeChild(e)}),c.forEach(function(e){var n=document.createTextNode(""),r=e.nodeValue.replace(t.other.ANCHOR,"");void 0===u[r]&&(u[r]=[]),u[r].push(n),e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)}),e.get().ACCESSORS&&n(l,"",""),o.map.anchors=u,o.map.accessors=l},get:function(e){var t=null;return null!==o.map.anchors&&o.map.anchors[e]instanceof Array&&o.map.anchors[e].length>0&&(t=o.map.anchors[e][0],o.map.anchors[e].splice(0,1)),t}}},_={find:function(){function e(r,o){h.isArray(o)?o.forEach(function(t){e(r,t)}):"object"==typeof o&&_object(o).forEach(function(o,l){var a=null,s=null;l instanceof t.classes.CALLER?void 0===n[l.url]&&(a=t.other.SUBLEVEL_BEGIN+o+t.other.SUBLEVEL_END,s=_object(l.conditions).copy(),s=0===Object.keys(s).length?p.storage.get(l.url):s,r[a]=null!==s?s:{},e(r[a],l.hooks)):"object"==typeof l&&(r[o]={},e(r[o],l))})}var n={};return 0===Object.keys(o.conditions).length&&(o.conditions=p.storage.get(s.url),o.conditions=null===o.conditions?{}:o.conditions),e(o.conditions,o.hooks),o.conditions},html:function(e,r,l,a){var i=null,c=a!==!1?a+".":"",u=null,f=null,d="";return o.cache.html_conds=void 0===o.cache.html_conds?{regs:{},matches:{},removed:{}}:o.cache.html_conds,u=o.cache.html_conds,r!==!1&&(i=n.storage.get(s.url),null!==i&&i.flags().has_conditions&&!i.flags().has_model?(f=i.map().conditions,_object(r).forEach(function(n,r){var o=null,a=null,s=null;r instanceof Function&&(o=r(l),a=c+n+"="+o,s=null,u.regs[a]=void 0!==u.regs[a]?u.regs[a]:new RegExp(t.regs.CONDITION_CONTENT.replace("[open]",a.replace(".","\\.")).replace("[close]",(c+n).replace(".","\\.")),"gi"),s=e.match(u.regs[a]),s instanceof Array&&s.length>0&&s.forEach(function(t){e=e.replace(t,t.replace("<!--"+a+"-->","").replace("<!--"+c+n+"-->",""))}),u.regs[n]=void 0!==u.regs[n]?u.regs[n]:new RegExp(t.regs.CONDITION_CONTENT_ANY.replace("[open]",(c+n).replace(".","\\.")).replace("[close]",(c+n).replace(".","\\.")),"gi"),e=e.replace(u.regs[n],""),d+=""===d?c+n:"|"+c+n)}),u.regs[d]=void 0!==u.regs[d]?u.regs[d]:new RegExp(t.css.attrs.CONDITION+'=".*?('+d+').*?"',"gi"),e=e.replace(u.regs[d],"")):_object(r).forEach(function(t,n){var r=c+t,o="OPEN-"+r,l="CLOSE-"+r;u.removed[o]=void 0!==u.removed[o]?u.removed[o]:new RegExp("<\\!--"+r.replace(".","\\.")+"=.{1,}?-->","gi"),u.removed[l]=void 0!==u.removed[l]?u.removed[l]:new RegExp("<\\!--"+r.replace(".","\\.")+"-->","gi"),e=e.replace(u.removed[o],""),e=e.replace(u.removed[l],"")})),e},getByPath:function(e,t){var n=e.split("."),r=void 0!==t&&t!==!1?t:o.conditions,l=o.cache.conditions;return""!==e&&void 0===l[e]&&(n.forEach(function(e){r=null!==r&&void 0!==r[e]&&"object"==typeof r?r[e]:null}),l[e]=null!==r?Object.keys(r).length>0?r:null:r),""!==e?l[e]:r},apply:function(){function e(){i||(Array.prototype.forEach.call(r,function(e,t){var n=document.createTextNode("");e.parentNode.insertBefore(n,e),e.__anchor=n}),i=!0)}function n(r,o,i,c){function u(e,t,n,r){var o=function(e,t,n,r){this.hooks=e,this.model=t,this.funcs=n,this.conds=r};return o.prototype={getter:function(){var e=this,t={};return _object(this.hooks).forEach(function(n,r){t[n]=void 0!==e.model[n]?e.model[n]:r}),t},results:function(e,t){var r={},o=this.getter();return void 0!==e&&(o[e]=t),_object(n).forEach(function(e,t){r[e]=t(o)}),r},update:function(e,t){
var n=this.results(e,t);_object(this.conds).forEach(function(e,t){var r=!0;t.conds.forEach(function(e){r=r?n[e.con]===e.val:r}),r?t.nodes.forEach(function(e){void 0!==e.__anchor&&e.__anchor.parentNode.insertBefore(e,e.__anchor)}):t.nodes.forEach(function(e){null!==e.parentNode&&e.parentNode.removeChild(e)})})}},new o(e,t,n,r)}function f(e){_object(i).forEach(function(n,r){"object"!=typeof r&&void 0!==i[t.other.BIND_PREFIX+n]&&i[t.other.BIND_PREFIX+n].bind(function(t,r){e.update(n,t)})})}var d={},p={},g=[];h.isArray(r)?r.forEach(function(e,t){n(e,o,null!==i&&void 0!==i[t]?i[t]:null,r.length)}):"object"==typeof r&&(_object(a).forEach(function(e,t){var n=null;t.path===o&&(n=void 0===s[e]?l[e].length/c:s[e],s[e]=n,l[e].length>=n&&(d[e]={conds:t.conditions,nodes:l[e].slice(0,n)},l[e].splice(0,n)))}),Object.keys(d).length>0&&(p=_.getByPath(o),null!==p&&(g=u(r,i,p,d),null!==i&&Object.keys(i).length>0?(e(),f(g),g.update()):g.update())),_object(r).forEach(function(e,l){var a=null;l instanceof t.classes.CALLER?(a=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END,n(l.hooks,(""===o?"":o+".")+a,null!==i&&void 0!==i[a]?i[a]:null,-1)):h.isArray(l)&&r.forEach(function(e,t){n(e,o,null!==i&&void 0!==i[t]?i[t]:null,-1)})}))}var r=_nodes("*["+t.css.attrs.CONDITION+"]",!1,o.wrapper).target,l=null,a={},s={},i=!1;r instanceof NodeList&&(Array.prototype.forEach.call(r,function(e,n){var r=e.getAttribute(t.css.attrs.CONDITION);a[r]=void 0===a[r]?[]:a[r],a[r].push(e),e.removeAttribute(t.css.attrs.CONDITION)}),l=a,a={},_object(l).forEach(function(e,t){var n=e.split(","),r=n[0].split("=")[0];a[e]={path:r.indexOf(".")===-1?"":r.replace(/\.[\w\d_]{1,}$/gi,""),conditions:n.map(function(e){return e=e.split("="),{con:e[0].indexOf(".")===-1?e[0]:e[0].replace(/.*[^\w\d]/gi,""),val:e[1]}})}}),n(o.hooks,"",o.map.model,h.isArray(o.hooks)?o.hooks.length:1))}},v={convert:function(e,n){return e=null!==e?e:c.storage.get(n),e instanceof Function&&(void 0!==e.prototype[t.events.ONREADY]||void 0!==e.prototype[t.events.ONUPDATE]||void 0!==e.prototype[t.events.SETINSTNCE])?new e(o.__instance):e},init:function(){o.controller=v.convert(o.caller.controller,s.url),o.listener=null===o.listener?new a.listener.create(o.__instance):o.listener},events:function(){function e(t,r){var o=null;"object"==typeof t&&null!==t&&(r.push({path:t.path,controller:t.controller}),t.events instanceof Array&&t.events.length>0&&(o=r.map(function(e){return e.path}),o=o.reverse(),t.events.forEach(function(e){r.forEach(function(t,r){var l=o[r]+(""!==o[r]?".":"")+e.handle,a=null;null!==t.controller&&"object"==typeof t.controller&&(a=_object(t.controller).getByPath(l),void 0!==n[e.id]&&(a instanceof Function?n[e.id].forEach(function(n){~o.indexOf(n.path)&&(a=a.bind(t.controller),n.nodeList.on(e.event,a))}):a instanceof Array&&a.length===n[e.id].length&&n[e.id].forEach(function(n,r){~o.indexOf(n.path)&&a[r]instanceof Function&&(a[r]=a[r].bind(t.controller),n.nodeList.on(e.event,a[r]))})))})})),void 0!==t.hooks&&"object"==typeof t.hooks&&null!==t.hooks&&_object(t.hooks).forEach(function(t,n){e(n,r.filter(function(){return!0}))}))}var t=o.map.refs,n=o.cache.dom;e(t,[])},apply:function(e){function n(r,o,l,a){r instanceof t.classes.CALLER?(l=null!==r.controller?r.controller:c.storage.get(r.url),n(r.hooks,o,l,null!==r.exchange?r.exchange:a)):h.isArray(r)?r.forEach(function(e,r){(e instanceof t.classes.CALLER||"object"==typeof e||h.isArray(e))&&n(e,null!==o&&void 0!==o[r]?o[r]:null,l,a)}):"object"!=typeof r||h.isArray(r)||(null!==l&&v.handle(l,o,a,e),_object(r).forEach(function(e,r){var l=e;r instanceof t.classes.CALLER&&(l=t.other.SUBLEVEL_BEGIN+e+t.other.SUBLEVEL_END),(r instanceof t.classes.CALLER||"object"==typeof r||h.isArray(r))&&n(r,null!==o&&void 0!==o[l]?o[l]:null,null,a)}))}n(o.hooks,o.map.model,o.controller,null===o.caller.exchange?null:o.caller.exchange)},handle:function(e,n,r,l){function a(e,t){var t=void 0!==t?t:o.__instance;e.call(t,{model:n,listener:o.listener,exchange:r,instance:o.__instance})}var l="boolean"==typeof l&&l;e instanceof Function?a(e):"object"==typeof e&&null!==e&&(l?e[t.events.ONUPDATE]instanceof Function&&a(e[t.events.ONUPDATE],e):e[t.events.ONREADY]instanceof Function&&a(e[t.events.ONREADY],e),e[t.events.SETINSTNCE]instanceof Function?a(e[t.events.SETINSTNCE],e):(e.model=n,e.listener=o.listener,e.exchange=r,e.instance=o.__instance))}},m={reset:function(){return o.cache={regs:{},conditions:{},html:{},dom:{}},o.cache}},T={getString:function(){function e(n){var r=null;return h.isArray(n)?n.map(function(t){return e(t)}):n instanceof t.classes.CALLER?{url:n.url,hooks:e(n.hooks)}:"object"==typeof n?(r={},_object(n).forEach(function(t,n){r[t]=e(n)}),r):n}var n={url:s.url,hooks:e(o.hooks)};return JSON.stringify(n)},setHash:function(){o.hash=e.get().CACHE_PATTERNS?t.other.CACHE_PATTERNS_PREFIX+h.getHash(T.getString()):null},getCache:function(){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.PATTERN_CACHE,{}),r=null;return e.get().CACHE_PATTERNS&&void 0!==o.hash&&null!==o.hash?null===n||void 0===n[o.hash]?(r=flex.localStorage.getJSON(o.hash),null!==r?(n[o.hash]=r,_object(n[o.hash]).copy()):null):void 0!==n[o.hash]?_object(n[o.hash]).copy():void 0:null},setCache:function(t){e.get().CACHE_PATTERNS&&void 0!==o.hash&&null!==o.hash&&flex.localStorage.addJSON(o.hash,t)}},R={make:function(e){var e="boolean"==typeof e&&e;i.build(!1,o.conditions),E.anchors.html(),i.wrap(),E.anchors.convert(),u.bind(),u.combine(),u.accessors(),u.finalize(),d.indexes(),_.apply(),v.apply(e),v.events(),i.map()},build:function(e){return m.reset(),T.setHash(),_.find(),v.init(),g.refs(),R.make(!1),v.handle(o.caller.onReady,o.map.model,o.caller.exchange),v.handle(e,o.map.model,o.caller.exchange),{nodes:o.wrapper.children,model:o.map.model}},update:function(e){function n(e,r,o){var a=[];return h.isArray(e)&&h.isArray(r)?e.length!==r.length&&(r=null):r=null,e.forEach(function(e,s){var i={};"object"==typeof e&&(_object(e).forEach(function(e,a){void 0!==o.hooks[e]?i[e]=l.instance({url:o.hooks[e].url,hooks:n(a instanceof Array?a:[a],null!==r&&r[s][e]instanceof t.classes.CALLER?r[s][e].hooks:null,o.hooks[e])}):i[e]=a}),null!==r&&_object(r[s]).forEach(function(e,t){void 0===i[e]&&(i[e]=t)}),a.push(i))}),a}var e=h.isArray(e)?e:[e],r=null;null!==o.map.refs&&(r=n(e,o.hooks,o.map.refs),o.hooks=r,o.caller.unmount(),R.make(!0),v.handle(o.caller.onUpdate,o.map.model,o.caller.exchange),o.caller.mount(o.wrapper.children))},html:function(e,t){var n=i.build(e,t);return{html:o.html,fragments:n}}},A=function(){return f.SIGNATURE+":: pattern ("+s.url+")"},N={build:R.build,html:R.html,update:R.update},{build:N.build,html:N.html,update:N.update}},instance:function(e){return flex.oop.objects.validate(e,[{name:"url",type:"string"},{name:"conditions",type:"object",value:{}},{name:"caller",type:"object",value:null},{name:"hooks",type:["object","array"],value:null}])!==!1?_object({parent:t.classes.PATTERN,constr:function(){if(this.id=flex.unique(),this.url=flex.system.url.restore(e.url),this.source=n.storage.get(e.url),null===this.source)throw flex.logs.log(f.pattern.CANNOT_FIND_SOURCE_OF_TEMPLATE+": "+this.url,flex.logs.types.CRITICAL),new Error(f.pattern.CANNOT_FIND_SOURCE_OF_TEMPLATE+": "+this.url)},privates:{caller:e.caller,hooks:e.hooks,conditions:e.conditions,html:null,wrapper:null,map:{model:null,html:null,hooks:null,refs:null,anchors:null},listener:null,model:null,cache:{html:null,regs:null}},prototype:r.proto}).createInstanceClass():null}},l={proto:function(e){var o=this,a=null,i=null,u=null,d=null,p=null,g=null,_=null;return u={inHooks:function(n){var n=void 0===n?e.hooks:n;n=h.isArray(n)?n:null!==n?new O([n]):null,null!==n&&n.forEach(function(n){_object(n).forEach(function(n,r){r instanceof t.classes.CALLER&&(e.patterns.indexOf(r.url)===-1&&e.patterns.push(r.url),u.inHooks(r.hooks))})}),e.patterns.indexOf(o.url)===-1&&e.patterns.push(o.url)},inMap:function(t){var t=void 0===t?e.map:t;null!==t&&"object"==typeof t&&_object(t).forEach(function(t,n){var r=null;null!==n&&"object"==typeof n&&(r=void 0!==n.url?flex.system.url.restore(n.url):null,void 0!==n.url&&!~e.patterns.indexOf(r)&&e.patterns.push(r),void 0!==n.hooks&&u.inMap(n.hooks))})}},d=function(t){var t=void 0===t?e.pattern.nodes:t,n=[];e.mounted=Array.prototype.filter.call(t,function(){return!0}),null!==e.node?Array.prototype.forEach.call(e.node,function(r){for(var o=0,l=t.length;o<l;o+=1)e.replace?r.parentNode.insertBefore(t[l!==t.length?0:o],r):r.appendChild(t[l!==t.length?0:o]);e.replace&&r.parentNode.removeChild(r),!~n.indexOf(r.parentNode)&&n.push(r.parentNode)}):null!==e.before?Array.prototype.forEach.call(e.before,function(e){for(var r=0,o=t.length;r<o;r+=1)null!==e.parentNode&&e.parentNode.insertBefore(t[o!==t.length?0:r],e);!~n.indexOf(e.parentNode)&&n.push(e.parentNode)}):null!==e.after&&Array.prototype.forEach.call(e.after,function(e){var r=void 0!==e.nextSibling?e.nextSibling:null;if(null!==r)for(var o=0,l=t.length;o<l;o+=1)r.parentNode.insertBefore(t[l!==t.length?0:o],r);else for(var o=0,l=t.length;o<l;o+=1)e.parentNode&&e.parentNode.appendChild(t[l!==t.length?0:o]);!~n.indexOf(e.parentNode)&&n.push(e.parentNode)}),void 0===d.ui_created&&(d.ui_created=!0,null!==flex.oop.namespace.get("flex.libraries.ui.window.move")&&flex.libraries.ui.window.move.create(),null!==flex.oop.namespace.get("flex.libraries.ui.window.focus")&&flex.libraries.ui.window.focus.create(),null!==flex.oop.namespace.get("flex.libraries.ui.window.resize")&&flex.libraries.ui.window.resize.create(),null!==flex.oop.namespace.get("flex.libraries.ui.window.maximize")&&flex.libraries.ui.window.maximize.create()),s.init(!0,o.url),flex.events.core.fire(flex.registry.events.ui.patterns.GROUP,flex.registry.events.ui.patterns.MOUNTED,n)},p=function(){var t=null;e.mounted instanceof Array&&e.mounted.length>0&&(t=void 0!==e.mounted[0].parentNode&&null!==e.mounted[0].parentNode?e.mounted[0].parentNode:null,null!==t&&e.mounted.forEach(function(e){t.removeChild(e)}))},a=function(s){function i(t){function n(e,t){function r(e,t){var r={};return _object(t).forEach(function(t,o){void 0!==e.hooks[t]?r[t]=l.instance({url:e.hooks[t].src,hooks:n(e.hooks[t],o)}):r[t]=o}),r}return h.isArray(t)?t.map(function(t){return r(e,t)}):r(e,t)}var r=null,a=(_object(t).copy(),{id:e.id,node:e.node,before:e.before,after:e.after,replace:e.replace,conditions:e.conditions,controller:null===e.controller?c.storage.get(o.url):e.controller,onReady:e.onReady,exchange:e.exchange,remove_missing_hooks:e.remove_missing_hooks,map:e.map});return null!==e.hooks&&(a.url=t.src,a.hooks=n(t,e.hooks),r=l.instance(a),r.render()),r}function p(){function n(e,r){h.isArray(e)&&e.forEach(function(e){_object(e).forEach(function(o,a){void 0===r[o]||a instanceof t.classes.CALLER?void 0!==r[o]&&void 0!==r[o].hooks&&a instanceof t.classes.CALLER&&n(a.hooks,r[o].hooks):(e[o]=l.instance({url:r[o].url,hooks:a}),void 0!==r[o].hooks&&n(e[o].hooks,r[o].hooks))})})}var r=0===Object.keys(e.map).length?y.storage.get(o.url):e.map;null!==r&&null!==e.hooks&&n(e.hooks,r)}function _(t){var r=0===Object.keys(e.map).length?y.storage.get(o.url):e.map,l=e.patterns.length;u.inMap(r),l!==e.patterns.length?n.init(e.patterns,t,A):t()}function v(n){function r(e){function n(e){_object(e).forEach(function(l,a){a instanceof t.classes.URL?(flex.overhead.register.add(o,l+a.url),a.load(function(t){e[l]=t,flex.overhead.register.done(o,l+a.url)})):a instanceof t.classes.CALLER?r(a.hooks):"object"==typeof a&&null!==a?n(a):h.isArray(a)&&r(e)})}h.isArray(e)&&e.forEach(function(r,l){r instanceof t.classes.URL?(flex.overhead.register.add(o,r.url),r.load(function(t){h.isArray(t)?(e.splice(0,e.length),t.forEach(function(t){e.push(t)})):e[l]=t,flex.overhead.register.done(o,r.url)})):n(r)})}var o="PATTERNS.URLS.REGISTER";null!==e.hooks?(flex.overhead.register.open(o,[],n),r(e.hooks),flex.overhead.register.isReady(o)&&n()):n()}function m(n){function r(e,n,o){h.isArray(e)?e.forEach(function(e){r(e,n,o)}):"object"==typeof e&&null!==e&&(void 0===e[n.hook]||null===e[n.hook]||e[n.hook]instanceof t.classes.CALLER||n.parent!==o?_object(e).forEach(function(e,l){e!==n.hook&&("object"==typeof l&&null!==l||l instanceof t.classes.CALLER)&&r(l instanceof t.classes.CALLER?l.hooks:l,n,l instanceof t.classes.CALLER?l.url:o)}):(e[n.hook]=l.instance({url:n.id,hooks:e[n.hook]}),a=!0))}var a=!1;return n.forEach(function(t){var n=t.collections();Object.keys(n).length>0&&_object(n).forEach(function(t,n){r(e.hooks,n,o.url)})}),a}function R(t){_(function(){v(function(){return h.isArray(e.hooks)?e.hooks.forEach(function(t,n){e.hooks[n]=E.apply(t,o.url)}):(e.hooks=E.apply({},o.url),Object.keys(e.hooks).length>0&&(e.hooks=new O([e.hooks])),!h.isArray(e.hooks)&&(e.hooks=null)),1!==t.length||null===t[0].map().component?(p(),m(t)?a():(e.pattern=r.instance({id:e.id,url:o.url,hooks:e.hooks,caller:e.__instance}).build(s.callback),d(),!0)):void i(t[0].map().component)})})}function A(){throw flex.logs.log(g()+f.caller.CANNOT_INIT_PATTERN,flex.logs.types.CRITICAL),e.onReady(null,f.caller.CANNOT_INIT_PATTERN,o.url),f.caller.CANNOT_INIT_PATTERN}s=void 0===s?{}:s,flex.oop.objects.validate(s,[{name:"node",type:["node","string","array","NodeList"],value:e.node},{name:"before",type:["node","string","array","NodeList"],value:e.before},{name:"after",type:["node","string","array","NodeList"],value:e.after},{name:"replace",type:"boolean",value:e.replace},{name:"callback",type:"function",value:null}])!==!1&&(e.node=null!==s.node?"string"==typeof s.node?_nodes(s.node).target:s.node instanceof Array?s.node:s.node instanceof NodeList?s.node:[s.node]:null,e.before=null!==s.before?"string"==typeof s.before?_nodes(s.before).target:s.before instanceof Array?s.before:s.before instanceof NodeList?s.before:[s.before]:null,e.after=null!==s.after?"string"==typeof s.after?_nodes(s.after).target:s.after instanceof Array?s.after:s.after instanceof NodeList?s.after:[s.after]:null,e.replace=s.replace,v(function(){u.inHooks(),u.inMap(),n.init(e.patterns,R,A)}))},i=function(){return r.instance({id:e.id,url:o.url,hooks:e.hooks,caller:e.__instance}).build()},g=function(){return f.SIGNATURE+":: caller ("+o.url+")"},_={render:a,build:i,mount:d,unmount:p},{render:_.render,build:_.build,mount:_.mount,unmount:_.unmount,hooks:e.hooks,map:e.map,conditions:e.conditions,controller:e.controller,exchange:e.exchange,onReady:e.onReady}},instance:function(e){return flex.oop.objects.validate(e,[{name:"url",type:"string"},{name:"node",type:["node","string","array","NodeList"],value:null},{name:"before",type:["node","string","array","NodeList"],value:null},{name:"after",type:["node","string","array","NodeList"],value:null},{name:"id",type:"string",value:flex.unique()},{name:"replace",type:"boolean",value:!1},{name:"hooks",type:["object","array",t.classes.URL],value:null},{name:"conditions",type:"object",value:{}},{name:"controller",type:["function","object"],value:null},{name:t.events.ONREADY,type:"function",value:function(){}},{name:"map",type:"object",value:{}},{name:"exchange",type:"object",value:null},{name:"remove_missing_hooks",type:"boolean",value:!0},{name:"component",type:"string",value:null}])!==!1?_object({parent:t.classes.CALLER,constr:function(){this.id=e.id,this.url=flex.system.url.restore(e.url)},privates:{id:e.id,node:null!==e.node?"string"==typeof e.node?_nodes(e.node).target:e.node instanceof Array?e.node:e.node instanceof NodeList?e.node:[e.node]:null,before:null!==e.before?"string"==typeof e.before?_nodes(e.before).target:e.before instanceof Array?e.before:e.before instanceof NodeList?e.before:[e.before]:null,after:null!==e.after?"string"==typeof e.after?_nodes(e.after).target:e.after instanceof Array?e.after:e.after instanceof NodeList?e.after:[e.after]:null,hooks:null!==e.hooks?new O(e.hooks instanceof Array?e.hooks:[e.hooks]):null,replace:e.replace,conditions:e.conditions,controller:e.controller,onReady:e.onReady,exchange:e.exchange,remove_missing_hooks:e.remove_missing_hooks,map:e.map,component:e.component,pattern:null,mounted:null,patterns:[]},prototype:l.proto}).createInstanceClass():null}},a={nodeList:{NODE_LIST:function(e){function t(e){return e.collection_id=flex.unique(),e.indexes=null,e}e instanceof NodeList||e instanceof Array?this.collections=[t(e)]:h.isNode(e)?this.collections=[t([e])]:this.collections=[]},init:function(){a.nodeList.NODE_LIST.prototype={add:function(e){function t(e){return e.collection_id=flex.unique(),e.indexes=null,e}e instanceof NodeList||e instanceof Array?this.collections.push(t(e)):e instanceof a.nodeList.NODE_LIST?this.collections=this.collections.concat(e.collections):h.isNode(e)&&this.collections.push(t([e]))},setIndexes:function(e){this.collections.forEach(function(t){t.indexes=e})},exclude:function(e){var t=[],n=[],r=this;e instanceof a.nodeList.NODE_LIST&&(t=e.collections.map(function(e){return e.collection_id}),r.collections.forEach(function(e,r){~t.indexOf(e.collection_id)&&n.unshift(r)}),n.forEach(function(e){r.collections.splice(e,1)}))},css:function(e){var t=this;"object"==typeof e&&null!==e&&_object(e).forEach(function(e,n){t.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){void 0!==t.style[e]&&(t.style[e]=n)})})})},addClass:function(e){this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){var n=t.className.replace(/\s{2,}/gi,"").split(" ");n.indexOf(e)===-1&&(n.push(e),t.className=n.join(" "))})})},removeClass:function(e){this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){var n=t.className.replace(/\s{2,}/gi,"").split(" "),r=n.indexOf(e);r!==-1&&(n.splice(r,1),t.className=n.join(" "))})})},show:function(){this.collections.forEach(function(e){Array.prototype.forEach.call(e,function(e){e.style.display=void 0!==e.__display?e.__display:"block"})})},hide:function(){this.collections.forEach(function(e){Array.prototype.forEach.call(e,function(e){e.__display=e.style.display,e.style.display="none"})})},remove:function(){this.collections.forEach(function(e){Array.prototype.forEach.call(e,function(e){void 0!==e.parentNode&&null!==e.parentNode&&e.parentNode.removeChild(e)})}),this.collections=[]},append:function(e){"function"==typeof e.appendChild&&this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){e.appendChild(t)})})},insertBefore:function(e){void 0!==e.parentNode&&null!==e.parentNode&&"function"==typeof e.parentNode.insertBefore&&h.isNode(e)&&this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){e.parentNode.insertBefore(t,e)})})},attr:function(e,t){var n=[];return this.collections.forEach(function(r){Array.prototype.forEach.call(r,function(r){void 0!==t?(r.setAttribute(e,t),n.push(!0)):n.push(r.getAttribute(e))})}),1===n.length?n[0]:n},removeAttr:function(e){var t=[];return this.collections.forEach(function(n){Array.prototype.forEach.call(n,function(n){t.push(n.removeAttribute(e))})}),1===t.length?t[0]:t},on:function(e,t){if("function"!=typeof t)throw Error("Defined [handle] is not a function");this.collections.forEach(function(n){Array.prototype.forEach.call(n,function(r){flex.events.DOM.add(r,e,function(e){t(e,n.indexes)})})})},getAsArray:function(){var e=[];return this.collections.forEach(function(t){Array.prototype.forEach.call(t,function(t){e.push(t)})}),e}}},create:function(e){return new a.nodeList.NODE_LIST(e)},addMethod:function(e,t){"string"==typeof e&&"function"==typeof t&&(void 0!==a.nodeList.NODE_LIST.prototype[e]&&flex.logs.log("Method ["+e+"] of NODE_LIST list class was overwritten.",flex.logs.types.NOTIFICATION),a.nodeList.NODE_LIST.prototype[e]=t)}},listener:{LISTENER:function(e){var e=e,n={},r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.GLOBAL_EVENTS,{}),o=null,l=null,a=null;o=function(e,o,l,a){var l=~["string","number"].indexOf(typeof l)?l:flex.unique(),a="boolean"==typeof a&&a;return!!(o instanceof Function&&~["string","number"].indexOf(typeof e))&&(void 0!==n[e]?n[e]:{},a&&(n[e][l]=o),!a&&(r[e][l]=o),o[t.other.EVENTS_HANDLE_ID]=l,l)},l=function(e,o,l){var l=~["string","number"].indexOf(typeof l)?l:null,e=~["string","number"].indexOf(typeof e)?e:null,o=o instanceof Function?o:null;return null!==e&&(null===l&&null!==o&&(l=void 0!==o[t.other.EVENTS_HANDLE_ID]?o[t.other.EVENTS_HANDLE_ID]:null),null!==l)&&(void 0!==n[e][l]&&delete n[e][l],void 0!==r[e][l]&&delete r[e][l],0===Object.keys(n[e]).length&&delete n[e],0===Object.keys(r[e]).length&&delete r[e],!0)},a=function(t,o,l){var t=~["string","number"].indexOf(typeof t)?t:null,l="boolean"==typeof l&&l,a=l?r:n;return null!==t&&void 0!==a[t]&&(_object(a[t]).forEach(function(t){t.call(e,o)}),!0)},this.bind=function e(t,n,r){return e(t,n,r,!1)},this.bindGlobal=function(e,t,n){return o(e,t,n,!0)},this.unbind=function e(t,n,r){return e(t,n,r)},this.trigger=function e(t,n){return e(t,n,!1)},this.triggerGlobal=function(e,t){return a(e,t,!0)}},create:function(){return new a.listener.LISTENER(o)}},map:{MAP:function(e){if(void 0===e||void 0===e.nodeType)throw Error("Context [context] should be a node.");this.context=e},init:function(){a.map.MAP.prototype={select:function(e){var t=_nodes(e,!1,this.context);return null!==t.target&&t.target.length>0?t.target.length>1?t.target:t.target[0]:null}}},create:function(e){return new a.map.MAP(e)}},url:{create:function(e,n){return _object({parent:t.classes.URL,constr:function(){if(this.url="string"==typeof e?e:null,this.parameters="object"==typeof n?n:{},this.callback=null,this.parameters.parser=void 0!==this.parameters.parser?this.parameters.parser:null,this.parameters.method=void 0!==this.parameters.method?this.parameters.method:flex.ajax.methods.GET,this.parameters.parameters=void 0!==this.parameters.parameters?this.parameters.parameters:void 0,this.parameters.settings=void 0!==this.parameters.settings?this.parameters.settings:void 0,this.parameters.callbacks=void 0!==this.parameters.callbacks?this.parameters.callbacks:{},this.parameters.callbacks.success=void 0!==this.parameters.callbacks.success?this.parameters.callbacks.success:null,this.parameters.callbacks._success=this.parameters.callbacks.success,this.parameters.callbacks=void 0!==this.parameters.callbacks?this.parameters.callbacks:{},this.parameters.callbacks.fail=void 0!==this.parameters.callbacks.fail?this.parameters.callbacks.fail:null,this.parameters.callbacks._fail=this.parameters.callbacks.fail,null===this.url)throw f.url.URL_SHOULD_BE_DEFINED_AS_STRING},privates:{},prototype:function(){var e=this,t=null,n=null,r=null,o=null;return t=function(t,n){t="function"==typeof e.parameters.parser?e.parameters.parser(void 0!==t.parsed?t.parsed:t.original):void 0!==t.parsed?t.parsed:t.original,"function"==typeof e.parameters.callbacks._success&&e.parameters.callbacks._success(t,n),"function"==typeof e.callback&&e.callback(t,n)},n=function(t,n){"function"==typeof e.parameters.callbacks._fail&&e.parameters.callbacks._fail(n),"function"==typeof e.callback&&e.callback(t,n)},r=function(r){e.parameters.callbacks.success=t,e.parameters.callbacks.fail=n,e.callback=r;var o=flex.ajax.send(e.url,void 0!==e.parameters.method?e.parameters.method:void 0,void 0!==e.parameters.parameters?e.parameters.parameters:void 0,void 0!==e.parameters.callbacks?e.parameters.callbacks:void 0,void 0!==e.parameters.settings?e.parameters.settings:void 0);o.send()},o=function(e){r(e)},{load:r}}}).createInstanceClass()}}},s={journal:{data:[],add:function(e){s.journal.data.push(flex.system.url.restore(e))},done:function(t){var n=s.journal.data.indexOf(t);n!==-1&&s.journal.data.splice(n,1),0===s.journal.data.length&&"function"==typeof e.get().onLayoutBuildFinish&&void 0===e.get().onLayoutBuildFinish.started&&(e.get().onLayoutBuildFinish.started=!0,e.get().onLayoutBuildFinish())}},getScheme:function(){var t=null,n=null;return void 0===s.getScheme.scheme&&(s.getScheme.scheme={}),n=s.getScheme.scheme,0===Object.keys(n).length&&(t=_nodes('link[rel="'+e.get().PATTERN_NODE+'"]').target,null!==t&&t instanceof NodeList&&t.length>0&&Array.prototype.forEach.call(t,function(t){var r=null,o=null,l=null;t.hasAttribute("name")&&t.hasAttribute("src")&&(r=t.getAttribute("name").toLowerCase(),o=t.getAttribute("src"),l=t.hasAttribute(e.get().HOOKS_SET)?t.getAttribute(e.get().HOOKS_SET):"",r.length>0&&o.length>0&&void 0===n[r]?n[r]={name:r,src:o,hooks_set:l}:void 0!==n[r]?flex.logs.log(f.layout.PATTERN_SRC_DEFINED_TWICE_OR_MORE,flex.logs.types.WARNING):flex.logs.log(f.layout.PATTERN_SRC_OR_NAME_IS_TOO_SHORT,flex.logs.types.WARNING))})),n},getHooksMap:function(){var e=null,t=null;return void 0===s.getHooksMap.map&&(s.getHooksMap.map={}),t=s.getHooksMap.map,0===Object.keys(t).length&&(e=_nodes('link[rel="hook"]').target,null!==e&&e instanceof NodeList&&e.length>0&&Array.prototype.forEach.call(e,function(e){var n=null,r=null;e.hasAttribute("name")&&e.hasAttribute("src")&&(n=e.getAttribute("name").toLowerCase(),r=e.getAttribute("src"),n.length>0&&r.length>0&&void 0===t[n]?t[n]={name:n,src:r}:void 0!==t[n]?flex.logs.log(f.layout.HOOK_SRC_DEFINED_TWICE_OR_MORE,flex.logs.types.WARNING):flex.logs.log(f.layout.HOOK_SRC_OR_NAME_IS_TOO_SHORT,flex.logs.types.WARNING))})),t},initByScheme:function(n){var r=s.getScheme(),o=[];Object.keys(r).length>0&&(_object(r).forEach(function(e,t){var n=_nodes(e).target;null!==n&&n instanceof NodeList&&n.length>0&&Array.prototype.forEach.call(n,function(e,n){void 0!==e.__in_work||s.helpers.isNested(e)||(e.__in_work=!0,s.journal.add(t.src),o.push({node:e,scheme:t}))})}),o.forEach(function(r){r.node.setAttribute(e.get().PATTERN_SRC,r.scheme.src),!r.node.hasAttribute(e.get().HOOKS_SET)&&r.node.setAttribute(e.get().HOOKS_SET,r.scheme.hooks_set),r.node.hasAttribute(t.events.ONREADY)&&n||s.caller(r.node)}))},initByHTML:function(n){var r=_nodes(e.get().PATTERN_NODE).target,n="boolean"==typeof n&&n,o=[];null!==r&&r instanceof NodeList&&r.length>0&&(Array.prototype.forEach.call(r,function(t){void 0===t.__in_work&&!s.helpers.isNested(t)&&t.hasAttribute(e.get().PATTERN_SRC)&&(t.__in_work=!0,s.journal.add(t.getAttribute(e.get().PATTERN_SRC)),o.push(t))}),o.forEach(function(e){s.helpers.isNested(e)||e.hasAttribute(t.events.ONREADY)&&n||s.caller(e)}))},init:function(e,t){s.initByScheme(e),s.initByHTML(e),void 0!==t&&s.journal.done(t)},caller:function(n,r,o,i){function c(e,t){var n=-1;try{e.forEach(function(e,r){if(void 0===e[t])throw n=r,"found"})}catch(e){}return n}function u(e,t){var n=e.getAttribute(t),r=null;return"string"==typeof n&&""!==n?(r=n.split("."),n=window,r.forEach(function(e){n=null!==n&&void 0!==n[e]?n[e]:null}),n):null}function d(t,n,r){var o=-1;return void 0!==t.children&&t.children.length>0&&Array.prototype.forEach.call(t.children,function(t){var l=t.nodeName.toLowerCase(),a=0===l.indexOf(e.get().HOOK_PREFIX)||r.indexOf(l)!==-1;if(o=o===-1?a:o?a?o:null:a?null:o,null===o)throw flex.logs.log(f.layout.HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS+" ("+n+")",flex.logs.types.CRITICAL),new Error(f.layout.HOOK_CANNOT_BE_DEFINED_WITH_OTHER_TAGS+" ("+n+")")}),o===-1&&(o=!1),o}function h(t){return 0===t.indexOf(e.get().HOOK_PREFIX)?t.replace(e.get().HOOK_PREFIX,""):t}function p(t){var n=t.hasAttribute(e.get().HOOKS_SET)?t.getAttribute(e.get().HOOKS_SET):[];return"string"==typeof n&&(n=n.split(","),n=n.map(function(e){return e.replace(/\s/gi,"")})),n}function g(e,t){var n=0,t=void 0===t?h(e.nodeName.toLowerCase()):t;void 0===E.hooks[t]||E.hooks instanceof Array||(E.hooks=[E.hooks]),E.hooks instanceof Array?(n=c(E.hooks,t),n===-1&&(E.hooks.push({}),n=E.hooks.length-1),d(e,E.url,i)?E.hooks[n][t]=s.caller(e,!0,o+(""===o?"":".")+t,i):E.hooks[n][t]=e.innerHTML):d(e,E.url,i)?E.hooks[t]=s.caller(e,!0,o+(""===o?"":".")+t,i):E.hooks[t]=e.innerHTML}var E=null,r=void 0!==r&&r,o=void 0!==o?o:n.nodeName.toLowerCase(),y=s.getHooksMap(),O=!(i instanceof Array),i=i instanceof Array?i.concat(p(n)):p(n),_=n.hasAttribute(e.get().HOOKS_SRC)?n.getAttribute(e.get().HOOKS_SRC):null;return null!==_&&""!==_?E={url:n.hasAttribute(e.get().PATTERN_SRC)?n.getAttribute(e.get().PATTERN_SRC):void 0!==y[o]?y[o].src:null,hooks:a.url.create(_)}:(O=!!O&&(1===i.length&&i[0]),E={url:n.hasAttribute(e.get().PATTERN_SRC)?n.getAttribute(e.get().PATTERN_SRC):void 0!==y[o]?y[o].src:null,hooks:{}},O===!1||d(n,E.url,i)?Array.prototype.forEach.call(n.children,function(e){g(e)}):g(n,O),"object"==typeof E.hooks&&0===Object.keys(E.hooks).length&&delete E.hooks),r||null===E.url?null!==E.url?E=l.instance(E):E.hooks:(E.node=n,E.replace=!0,E.onReady=u(n,t.events.ONREADY),E=l.instance(E).render())},attach:function(){"complete"!==document.readyState?flex.events.DOM.add(window,"load",function(){s.init(!0)}):s.init(!0)},helpers:{isNested:function(t){var n=null,r=s.getScheme();return void 0!==t.parentNode&&null!==t.parentNode&&(n=t.parentNode.nodeName.toLowerCase(),n===e.get().PATTERN_NODE.toLowerCase()||(void 0!==r[n]||"body"!==n&&s.helpers.isNested(t.parentNode)))}}},c={references:{assign:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_LINKS,{});void 0===r[e]&&(r[e]=n)},getPatternURL:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_LINKS,{});return void 0!==n[e]?n[e]:null}},storage:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_STORAGE,{});void 0===r[e]?r[e]=n:flex.logs.log("["+e+"]"+f.controller.CONTROLLER_DEFINED_MORE_THAN_ONCE,flex.logs.types.WARNING)},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONTROLLERS_STORAGE,{});return void 0!==n[e]?n[e]:null}},current:{data:null,set:function(e){c.current.data=e},get:function(){return c.current.data},reset:function(){c.current.data=null}},attach:function(e){var t=null,n=null;~["function","object"].indexOf(typeof e)&&(t=null!==c.current.get()?c.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=c.references.getPatternURL(t),c.storage.add(n,e)))}},u={virtual:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.VIRTUAL_STORAGE_ID,{});if(null!==r&&void 0===r[e])return r[e]=n,!0},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.VIRTUAL_STORAGE_ID,{});return null!==n&&void 0!==n[e]?n[e]:null}},local:{add:function(t,n){return e.get().USE_LOCALSTORAGE===!0&&flex.localStorage.addJSON(t,{html:n,hash:flex.hashes.get(t)})},get:function(n){function r(){void 0===u.local.resetPatternsCache&&(flex.localStorage.reset(t.other.CACHE_PATTERNS_PREFIX),u.local.resetPatternsCache=!0)}var o=null;if(e.get().USE_LOCALSTORAGE===!0){if(flex.hashes.update(n),o=flex.localStorage.getJSON(n),null!==o){if(o.hash===flex.hashes.get(n))return o.html;r()}}else r();return null}},add:function(e,t){u.local.add(e,t),u.virtual.add(e,t)},get:function(e){var t=u.virtual.get(e);return null===t&&(t=u.local.get(e)),t}},d={measure:function(){var e={};return function(n,r){if(t.measuring.MEASURE){var n=void 0===n?flex.unique():n;return void 0===e[n]?e[n]=performance.now():(flex.logs.log(f.SIGNATURE+"Operation ["+r+"] was taken "+(performance.now()-e[n]).toFixed(4)+"ms.",flex.logs.types.NOTIFICATION),delete e[n]),n}}}()},p={storage:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONDITIONS_STORAGE,{});r[e]=n},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.CONDITIONS_STORAGE,{});return void 0!==n[e]?n[e]:null}},attach:function(e){var t=null,n=null;"object"==typeof e&&null!==e&&(t=null!==c.current.get()?c.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=c.references.getPatternURL(t),p.storage.add(n,e)))}},E={storage:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.HOOKS_STORAGE,{});r[e]=n},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.HOOKS_STORAGE,{});return void 0!==n[e]?n[e]:null}},attach:function(e){var t=null,n=null;"object"==typeof e&&null!==e&&(t=null!==c.current.get()?c.current.get():flex.resources.attach.js.getCurrentSRC(),
null!==t&&(n=c.references.getPatternURL(t),E.storage.add(n,e)))},apply:function(e,t){function n(e,t){_object(e).forEach(function(e,r){void 0===t[e]?t[e]=r:null!==t[e]&&"object"==typeof t[e]&&n(r,t[e])})}var r=E.storage.get(t);return null!==r&&"object"==typeof r&&n(r,e),e}},y={storage:{add:function(e,n){var r=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.MAPS_STORAGE,{});r[e]=n},get:function(e){var n=flex.overhead.globaly.get(t.storage.VIRTUAL_STORAGE_GROUP,t.storage.MAPS_STORAGE,{});return void 0!==n[e]?n[e]:null}},attach:function(e){var t=null,n=null;"object"==typeof e&&null!==e&&(t=null!==c.current.get()?c.current.get():flex.resources.attach.js.getCurrentSRC(),null!==t&&(n=c.references.getPatternURL(t),y.storage.add(n,e)))}},h={testReg:function(e,t){return e.lastIndex=0,e.test(t)},binds:{data:{value:[{nodes:["input","textarea"],event:"change",getter:function(){return this.value},setter:function(e){this.value=e}}]},assing:function(e,t,n){var r=e.nodeName.toLowerCase(),o=null;return void 0!==h.binds.data[t]&&(h.binds.data[t].forEach(function(e){e.nodes.indexOf(r)!==-1&&(o=e)}),null!==o&&!function(e,t,n,r,o){_node(t).events().add(e,function(e){o.call(t,e,n,r)})}(o.event,e,o.getter.bind(e),o.setter.bind(e),n)),!1},isPossible:function(e,t){var n=e.nodeName.toLowerCase();if(void 0!==h.binds.data[t])try{h.binds.data[t].forEach(function(e){if(e.nodes.indexOf(n)!==-1)throw"found"})}catch(e){return"found"===e}return!1}},isNode:function(e){return void 0!==e&&void 0!==e.nodeName&&void 0!==e.parentNode&&void 0!==e.nodeType},isArray:function(e){return e instanceof Array||e instanceof O},getTextNode:function(e,t,n){var r=null,n=void 0!==n?n:null;if(void 0!==e.childNodes)if(null!==n&&void 0!==e.childNodes[n]&&e.childNodes[n].nodeValue===t)r=e.childNodes[n];else try{Array.prototype.forEach.call(e.childNodes,function(e){if(3===e.nodeType&&e.nodeValue===t)throw r=e,"found"})}catch(e){}return r},getPattern:function(e){var t=h.getFirstTag(e);return null!==t?h.getParentFor(t):null},getHash:function(e){var t,n,r,o=0;if(0===e.length)return o;for(t=0,r=e.length;t<r;t++)n=e.charCodeAt(t),o=(o<<5)-o+n,o|=0;return o.toString()},getFirstTag:function(e){var n=e.match(t.regs.FIRST_TAG);return null!==n&&1===n.length?n[0].replace(t.regs.TAG_BORDERS,"").replace(/\s/gi,"").match(t.regs.FIRST_WORD)[0].toLowerCase():null},getParentFor:function(e){return"string"==typeof e?void 0!==t.compatibility.CHILD_TO_PARENT[e]?document.createElement(t.compatibility.CHILD_TO_PARENT[e]):document.createElement(t.compatibility.BASE):null},getFirstTagWithContect:function(e){function t(e){var t={value:c.match(e),mark:flex.unique()};t.value=t.value[0],c=c.replace(e,t.mark),i.replaced.push(t)}var n=e.match(/<\s*\w{1,}/gi),r=null,o=null,l=null,a=null,s=null,i={start:{mark:null,value:null},replaced:[]},c=e;if(n instanceof Array&&n.length>0){i.start.mark=flex.unique(),i.start.value=n[0],c=c.replace(i.start.value,i.start.mark),n=n[0].replace(/<\s*/gi,""),r=new RegExp("<\\s*/\\s*"+n+"\\s*>","i"),o=new RegExp("<s*"+n+".*?>","i");do{if(a=c.search(r),s=c.search(o),!(s!==-1&&s<a)){l=~a?c.substring(0,a)+c.match(r)[0]:null;break}t(o),t(r)}while(s!==-1&&s<a);null!==l&&(l=l.replace(i.start.mark,i.start.value),i.replaced.forEach(function(e){l=l.replace(e.mark,e.value)}))}return l}},g={init:function(){flex.callers.define.node("ui.patterns.append",function(e){return"object"==typeof e&&this.target&&(e.node=this.target),l.instance(e)}),flex.callers.define.nodes("ui.patterns.append",function(){var e=[];return Array.prototype.forEach.call(this.target,function(t){"object"==typeof parameters&&this.target&&(parameters.node=this.target),e.push(l.instance(parameters))}),e})}},a.nodeList.init(),a.map.init(),function(){void 0===flex.registry.events.ui&&(flex.registry.events.ui={}),void 0===flex.registry.events.ui.patterns&&(flex.registry.events.ui.patterns={GROUP:"flex.registry.events.ui.patterns",MOUNTED:"MOUNTED"})}(),i={preload:n.init,get:l.instance,controller:{attach:c.attach},conditions:{attach:p.attach},hooks:{attach:E.attach},map:{attach:y.attach},classes:{NODE_LIST:{addMethod:a.nodeList.addMethod}},setup:e.setup,debug:e.debug,layout:s.init,url:a.url.create},g.init(),window._controller=i.controller.attach,window._conditions=i.conditions.attach,window._hooks=i.hooks.attach,window._map=i.map.attach,s.attach(),{preload:i.preload,get:i.get,classes:{NODE_LIST:{addMethod:i.classes.NODE_LIST.addMethod}},setup:i.setup,debug:i.debug,layout:i.layout,url:i.url}},flex.modules.attach({name:"ui.patterns",protofunction:e,reference:["flex.events","flex.html","flex.binds","flex.types.array"],onAfterAttach:function(){flex.libraries.events.create(),flex.libraries.html.create(),flex.libraries.binds.create(),flex.libraries.types.array.create(),window._patterns=flex.libraries.ui.patterns.create()}})}}(),flex.init({resources:{MODULES:["flex.ui.patterns"],USE_STORAGED:!0},settings:{CHECK_PATHS_IN_CSS:!0},logs:{SHOW:["CRITICAL"]}});
//# sourceMappingURL=maps/patterns.min.js.map
